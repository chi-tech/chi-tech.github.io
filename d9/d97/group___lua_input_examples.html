<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Chi-Tech: Lua Input Examples</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Logo2_Small.bmp"/></td>
  <td id="projectalign">
   <div id="projectname">Chi-Tech
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d9/d97/group___lua_input_examples.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Lua Input Examples</div></div>
</div><!--header-->
<div class="contents">


<h3><a id="tests_BigTests_c5g7_Test1_materials_materials_lua" name="tests_BigTests_c5g7_Test1_materials_materials_lua"></a>tests/BigTests/c5g7/Test1/materials/materials.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Create cross sections</div>
<div class="line">xs = {}</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">for</span> m=0,6 <span class="keywordflow">do</span></div>
<div class="line">    xs[tostring(m)] = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga82468060b3343581b90ceb06aa1e52c3">chiPhysicsTransportXSCreate</a>()</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs[&quot;0&quot;],CHI_XSFILE,&quot;materials/XS_water.cxs&quot;)</div>
<div class="line">--<a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs[&quot;1&quot;],CHI_XSFILE,&quot;materials/XS_UO2.cxs&quot;)</div>
<div class="line">--<a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs[&quot;2&quot;],CHI_XSFILE,&quot;materials/XS_4_3pMOX.cxs&quot;)</div>
<div class="line">--<a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs[&quot;3&quot;],CHI_XSFILE,&quot;materials/XS_7pMOX.cxs&quot;)</div>
<div class="line">--<a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs[&quot;4&quot;],CHI_XSFILE,&quot;materials/XS_8_7pMOX.cxs&quot;)</div>
<div class="line">--<a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs[&quot;5&quot;],CHI_XSFILE,&quot;materials/XS_guide_tube.cxs&quot;)</div>
<div class="line">--<a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs[&quot;6&quot;],CHI_XSFILE,&quot;materials/XS_fission_chamber.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">-- GMesh mesh</div>
<div class="line"><a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs[&quot;0&quot;],CHI_XSFILE,&quot;materials/XS_water.cxs&quot;)</div>
<div class="line"><a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs[&quot;1&quot;],CHI_XSFILE,&quot;materials/XS_UO2.cxs&quot;)</div>
<div class="line"><a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs[&quot;2&quot;],CHI_XSFILE,&quot;materials/XS_7pMOX.cxs&quot;)</div>
<div class="line"><a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs[&quot;3&quot;],CHI_XSFILE,&quot;materials/XS_guide_tube.cxs&quot;)</div>
<div class="line"><a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs[&quot;4&quot;],CHI_XSFILE,&quot;materials/XS_4_3pMOX.cxs&quot;)</div>
<div class="line"><a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs[&quot;5&quot;],CHI_XSFILE,&quot;materials/XS_8_7pMOX.cxs&quot;)</div>
<div class="line"><a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs[&quot;6&quot;],CHI_XSFILE,&quot;materials/XS_fission_chamber.cxs&quot;)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">water_xs = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#gaaf87347d2ab88ea5e88058038754bddf">chiPhysicsTransportXSGet</a>(xs[&quot;0&quot;])</div>
<div class="line"> </div>
<div class="line">-- for k,v in pairs(water_xs) do</div>
<div class="line">--     print(k,v)</div>
<div class="line">-- end</div>
<div class="line"> </div>
<div class="line">num_groups = water_xs[&quot;num_groups&quot;]</div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,&quot;Num groups: &quot;..tostring(num_groups))</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Create materials</span></div>
<div class="line">materials = {}</div>
<div class="line"><span class="keywordflow">for</span> m=0,6 <span class="keywordflow">do</span></div>
<div class="line">    key = tostring(m)</div>
<div class="line">    materials[key] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Material_&quot;</span>..key)</div>
<div class="line">    <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(key,TRANSPORT_XSECTIONS)</div>
<div class="line">    <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(key,TRANSPORT_XSECTIONS, EXISTING,xs[key])</div>
<div class="line">end</div>
<div class="ttc" id="agroup___lua_logging_html_ga8139e633fb74f8d739bcfd6badd80376"><div class="ttname"><a href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chi_lua::chiLog</a></div><div class="ttdeci">void chiLog(int LogType, char LogMsg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00191">lua_functions.c:191</a></div></div>
<div class="ttc" id="agroup___lua_physics_materials_html_gaa19753665bde67f4e125fd204848c342"><div class="ttname"><a href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chi_lua::chiPhysicsAddMaterial</a></div><div class="ttdeci">MaterialHandle chiPhysicsAddMaterial(char Name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00385">lua_functions.c:385</a></div></div>
<div class="ttc" id="agroup___lua_physics_materials_html_gad2a1538276adff6c1d723a7a26131f08"><div class="ttname"><a href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chi_lua::chiPhysicsMaterialAddProperty</a></div><div class="ttdeci">void chiPhysicsMaterialAddProperty(int MaterialHandle, int PropertyIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00733">lua_functions.c:733</a></div></div>
<div class="ttc" id="agroup___lua_physics_materials_html_gafc1f3164b69c49a99040dab87b827ed7"><div class="ttname"><a href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chi_lua::chiPhysicsMaterialSetProperty</a></div><div class="ttdeci">void chiPhysicsMaterialSetProperty(int MaterialHandle, int PropertyIndex, int OperationIndex, varying Information)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00900">lua_functions.c:900</a></div></div>
<div class="ttc" id="agroup___lua_transport_x_ss_html_ga5b6ee9dc31bfa7617f4f8e49edcc278c"><div class="ttname"><a href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chi_lua::chiPhysicsTransportXSSet</a></div><div class="ttdeci">void chiPhysicsTransportXSSet(int XS_handle, int OperationIndex, varying Information)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l01007">lua_functions.c:1007</a></div></div>
<div class="ttc" id="agroup___lua_transport_x_ss_html_ga82468060b3343581b90ceb06aa1e52c3"><div class="ttname"><a href="../../de/dd8/group___lua_transport_x_ss.html#ga82468060b3343581b90ceb06aa1e52c3">chi_lua::chiPhysicsTransportXSCreate</a></div><div class="ttdeci">Returns chiPhysicsTransportXSCreate()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00944">lua_functions.c:944</a></div></div>
<div class="ttc" id="agroup___lua_transport_x_ss_html_gaaf87347d2ab88ea5e88058038754bddf"><div class="ttname"><a href="../../de/dd8/group___lua_transport_x_ss.html#gaaf87347d2ab88ea5e88058038754bddf">chi_lua::chiPhysicsTransportXSGet</a></div><div class="ttdeci">void chiPhysicsTransportXSGet(int XS_handle)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l01026">lua_functions.c:1026</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_BigTests_c5g7_Test1_mesh_gmesh_coarse_lua" name="tests_BigTests_c5g7_Test1_mesh_gmesh_coarse_lua"></a>tests/BigTests/c5g7/Test1/mesh/gmesh_coarse.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">umesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga3feeabcd6b9ab6d60d66b6a3426e81da">chiUnpartitionedMeshFromMshFormat</a>(&quot;mesh/2D_c5g7_coarse.msh&quot;,true)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Create meshers</span></div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED,umesh);</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga84f96adcccf43678b5b94285a2291e66">chiVolumeMesherSetKBAPartitioningPxPyPz</a>(2,2,1)</div>
<div class="line">--<a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga2048d69a09e224f5daf0ff4e6c4404e4">chiVolumeMesherSetKBACutsX</a>({27.72})</div>
<div class="line">--<a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gae5015130ffe27744255aa29b3e704eb7">chiVolumeMesherSetKBACutsY</a>({27.72})</div>
<div class="line">--<a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">PARTITION_TYPE</a>,KBA_STYLE_XYZ)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Execute meshing</div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="ttc" id="agroup___lua_mesh_handler_html_ga3be36a5ecf5469ad0980dd5aa4097a2a"><div class="ttname"><a href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chi_lua::chiMeshHandlerCreate</a></div><div class="ttdeci">Handle chiMeshHandlerCreate()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l02459">lua_functions.c:2459</a></div></div>
<div class="ttc" id="agroup___lua_surface_mesher_html_ga093aea22f7d29fe5ab8d6977dd22395c"><div class="ttname"><a href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chi_lua::chiSurfaceMesherCreate</a></div><div class="ttdeci">void chiSurfaceMesherCreate(int SurfaceMesherType)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l03021">lua_functions.c:3021</a></div></div>
<div class="ttc" id="agroup___lua_surface_mesher_html_gafa49ea05b8a7ca38d50ea324b39fb219"><div class="ttname"><a href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chi_lua::chiSurfaceMesherExecute</a></div><div class="ttdeci">void chiSurfaceMesherExecute()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l02968">lua_functions.c:2968</a></div></div>
<div class="ttc" id="agroup___lua_unpartitioned_mesh_html_ga3feeabcd6b9ab6d60d66b6a3426e81da"><div class="ttname"><a href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga3feeabcd6b9ab6d60d66b6a3426e81da">chi_lua::chiUnpartitionedMeshFromMshFormat</a></div><div class="ttdeci">Handle chiUnpartitionedMeshFromMshFormat(char file_name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l01438">lua_functions.c:1438</a></div></div>
<div class="ttc" id="agroup___lua_volume_mesher_html_ga2048d69a09e224f5daf0ff4e6c4404e4"><div class="ttname"><a href="../../d4/d3a/group___lua_volume_mesher.html#ga2048d69a09e224f5daf0ff4e6c4404e4">chi_lua::chiVolumeMesherSetKBACutsX</a></div><div class="ttdeci">void chiVolumeMesherSetKBACutsX()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l02120">lua_functions.c:2120</a></div></div>
<div class="ttc" id="agroup___lua_volume_mesher_html_ga67050e80fa0bffde80b9df0ae75d222b"><div class="ttname"><a href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chi_lua::chiVolumeMesherSetProperty</a></div><div class="ttdeci">void chiVolumeMesherSetProperty(int PropertyIndex, varying PropertyValue)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l02073">lua_functions.c:2073</a></div></div>
<div class="ttc" id="agroup___lua_volume_mesher_html_ga84f96adcccf43678b5b94285a2291e66"><div class="ttname"><a href="../../d4/d3a/group___lua_volume_mesher.html#ga84f96adcccf43678b5b94285a2291e66">chi_lua::chiVolumeMesherSetKBAPartitioningPxPyPz</a></div><div class="ttdeci">void chiVolumeMesherSetKBAPartitioningPxPyPz(int Px, int Py, int Pz)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l02100">lua_functions.c:2100</a></div></div>
<div class="ttc" id="agroup___lua_volume_mesher_html_ga97061ff17454d77b1f4359690c624299"><div class="ttname"><a href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chi_lua::chiVolumeMesherCreate</a></div><div class="ttdeci">void chiVolumeMesherCreate(int Type, varying OtherArgs)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l01813">lua_functions.c:1813</a></div></div>
<div class="ttc" id="agroup___lua_volume_mesher_html_gad031f7f22f9a1b4d7ea535f04c56ae1f"><div class="ttname"><a href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chi_lua::chiVolumeMesherExecute</a></div><div class="ttdeci">void chiVolumeMesherExecute()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l01913">lua_functions.c:1913</a></div></div>
<div class="ttc" id="agroup___lua_volume_mesher_html_gae5015130ffe27744255aa29b3e704eb7"><div class="ttname"><a href="../../d4/d3a/group___lua_volume_mesher.html#gae5015130ffe27744255aa29b3e704eb7">chi_lua::chiVolumeMesherSetKBACutsY</a></div><div class="ttdeci">void chiVolumeMesherSetKBACutsY()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l02140">lua_functions.c:2140</a></div></div>
<div class="ttc" id="anamespacechi__mesh_html_a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b"><div class="ttname"><a href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">chi_mesh::PARTITION_TYPE</a></div><div class="ttdeci">@ PARTITION_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcb/chi__volumemesher_8h_source.html#l00029">chi_volumemesher.h:29</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_BigTests_c5g7_Test1_mesh_gmesh_refined_lua" name="tests_BigTests_c5g7_Test1_mesh_gmesh_refined_lua"></a>tests/BigTests/c5g7/Test1/mesh/gmesh_refined.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">umesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga3feeabcd6b9ab6d60d66b6a3426e81da">chiUnpartitionedMeshFromMshFormat</a>(&quot;mesh/2D_c5g7_refined.msh&quot;,true)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Create meshers</span></div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED,umesh);</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga84f96adcccf43678b5b94285a2291e66">chiVolumeMesherSetKBAPartitioningPxPyPz</a>(2,2,1)</div>
<div class="line">--<a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga2048d69a09e224f5daf0ff4e6c4404e4">chiVolumeMesherSetKBACutsX</a>({27.72})</div>
<div class="line">--<a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gae5015130ffe27744255aa29b3e704eb7">chiVolumeMesherSetKBACutsY</a>({27.72})</div>
<div class="line">--<a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">PARTITION_TYPE</a>,KBA_STYLE_XYZ)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Execute meshing</div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
</div><!-- fragment --> </div>

<h3><a id="tests_BigTests_c5g7_Test1_mesh_mesh_lua" name="tests_BigTests_c5g7_Test1_mesh_mesh_lua"></a>tests/BigTests/c5g7/Test1/mesh/mesh.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">umesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga0f476b765a307ec7a477c237134298c2">chiUnpartitionedMeshFromWavefrontOBJ</a>(&quot;mesh/STARCCMTemplate2.obj&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED,umesh)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>()</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>()</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line">matids = {</div>
<div class="line">{1, 1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2},</div>
<div class="line">{1, 1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  2,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  2},</div>
<div class="line">{1, 1,  1,  1,  1,  5,  1,  1,  5,  1,  1,  5,  1,  1,  1,  1,  1,  2,  3,  3,  3,  3,  5,  3,  3,  5,  3,  3,  5,  3,  3,  3,  3,  2},</div>
<div class="line">{1, 1,  1,  5,  1,  1,  1,  1,  1,  1,  1,  1,  1,  5,  1,  1,  1,  2,  3,  3,  5,  3,  4,  4,  4,  4,  4,  4,  4,  3,  5,  3,  3,  2},</div>
<div class="line">{1, 1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  2,  3,  3,  3,  4,  4,  4,  4,  4,  4,  4,  4,  4,  3,  3,  3,  2},</div>
<div class="line">{1, 1,  5,  1,  1,  5,  1,  1,  5,  1,  1,  5,  1,  1,  5,  1,  1,  2,  3,  5,  4,  4,  5,  4,  4,  5,  4,  4,  5,  4,  4,  5,  3,  2},</div>
<div class="line">{1, 1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  2,  3,  3,  4,  4,  4,  4,  4,  4,  4,  4,  4,  4,  4,  3,  3,  2},</div>
<div class="line">{1, 1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  2,  3,  3,  4,  4,  4,  4,  4,  4,  4,  4,  4,  4,  4,  3,  3,  2},</div>
<div class="line">{1, 1,  5,  1,  1,  5,  1,  1,  6,  1,  1,  5,  1,  1,  5,  1,  1,  2,  3,  5,  4,  4,  5,  4,  4,  6,  4,  4,  5,  4,  4,  5,  3,  2},</div>
<div class="line">{1, 1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  2,  3,  3,  4,  4,  4,  4,  4,  4,  4,  4,  4,  4,  4,  3,  3,  2},</div>
<div class="line">{1, 1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  2,  3,  3,  4,  4,  4,  4,  4,  4,  4,  4,  4,  4,  4,  3,  3,  2},</div>
<div class="line">{1, 1,  5,  1,  1,  5,  1,  1,  5,  1,  1,  5,  1,  1,  5,  1,  1,  2,  3,  5,  4,  4,  5,  4,  4,  5,  4,  4,  5,  4,  4,  5,  3,  2},</div>
<div class="line">{1, 1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  2,  3,  3,  3,  4,  4,  4,  4,  4,  4,  4,  4,  4,  3,  3,  3,  2},</div>
<div class="line">{1, 1,  1,  5,  1,  1,  1,  1,  1,  1,  1,  1,  1,  5,  1,  1,  1,  2,  3,  3,  5,  3,  4,  4,  4,  4,  4,  4,  4,  3,  5,  3,  3,  2},</div>
<div class="line">{1, 1,  1,  1,  1,  5,  1,  1,  5,  1,  1,  5,  1,  1,  1,  1,  1,  2,  3,  3,  3,  3,  5,  3,  3,  5,  3,  3,  5,  3,  3,  3,  3,  2},</div>
<div class="line">{1, 1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  2,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  2},</div>
<div class="line">{1, 1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2},</div>
<div class="line">{2, 2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1},</div>
<div class="line">{2, 3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  2,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1},</div>
<div class="line">{2, 3,  3,  3,  3,  5,  3,  3,  5,  3,  3,  5,  3,  3,  3,  3,  2,  1,  1,  1,  1,  1,  5,  1,  1,  5,  1,  1,  5,  1,  1,  1,  1,  1},</div>
<div class="line">{2, 3,  3,  5,  3,  4,  4,  4,  4,  4,  4,  4,  3,  5,  3,  3,  2,  1,  1,  1,  5,  1,  1,  1,  1,  1,  1,  1,  1,  1,  5,  1,  1,  1},</div>
<div class="line">{2, 3,  3,  3,  4,  4,  4,  4,  4,  4,  4,  4,  4,  3,  3,  3,  2,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1},</div>
<div class="line">{2, 3,  5,  4,  4,  5,  4,  4,  5,  4,  4,  5,  4,  4,  5,  3,  2,  1,  1,  5,  1,  1,  5,  1,  1,  5,  1,  1,  5,  1,  1,  5,  1,  1},</div>
<div class="line">{2, 3,  3,  4,  4,  4,  4,  4,  4,  4,  4,  4,  4,  4,  3,  3,  2,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1},</div>
<div class="line">{2, 3,  3,  4,  4,  4,  4,  4,  4,  4,  4,  4,  4,  4,  3,  3,  2,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1},</div>
<div class="line">{2, 3,  5,  4,  4,  5,  4,  4,  6,  4,  4,  5,  4,  4,  5,  3,  2,  1,  1,  5,  1,  1,  5,  1,  1,  6,  1,  1,  5,  1,  1,  5,  1,  1},</div>
<div class="line">{2, 3,  3,  4,  4,  4,  4,  4,  4,  4,  4,  4,  4,  4,  3,  3,  2,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1},</div>
<div class="line">{2, 3,  3,  4,  4,  4,  4,  4,  4,  4,  4,  4,  4,  4,  3,  3,  2,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1},</div>
<div class="line">{2, 3,  5,  4,  4,  5,  4,  4,  5,  4,  4,  5,  4,  4,  5,  3,  2,  1,  1,  5,  1,  1,  5,  1,  1,  5,  1,  1,  5,  1,  1,  5,  1,  1},</div>
<div class="line">{2, 3,  3,  3,  4,  4,  4,  4,  4,  4,  4,  4,  4,  3,  3,  3,  2,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1},</div>
<div class="line">{2, 3,  3,  5,  3,  4,  4,  4,  4,  4,  4,  4,  3,  5,  3,  3,  2,  1,  1,  1,  5,  1,  1,  1,  1,  1,  1,  1,  1,  1,  5,  1,  1,  1},</div>
<div class="line">{2, 3,  3,  3,  3,  5,  3,  3,  5,  3,  3,  5,  3,  3,  3,  3,  2,  1,  1,  1,  1,  1,  5,  1,  1,  5,  1,  1,  5,  1,  1,  1,  1,  1},</div>
<div class="line">{2, 3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  2,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1},</div>
<div class="line">{2, 2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1}}</div>
<div class="line"> </div>
<div class="line">lvs = {}</div>
<div class="line">ds = 1.26</div>
<div class="line"><span class="keywordflow">for</span> i=1,34 <span class="keywordflow">do</span></div>
<div class="line">    lvs[i]={}</div>
<div class="line">    <span class="keywordflow">for</span> j=1,34 <span class="keywordflow">do</span></div>
<div class="line">        x0_ =  ds/2 + (i-1)*ds</div>
<div class="line">        y0_ = -ds/2 - (j-1)*ds</div>
<div class="line">        lvs[i][j] = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#a74944438a086975793d26ae48d5882d4">RCC</a>,x0_,y0_,-1, 0,0,2, 0.54702084)</div>
<div class="line">        <a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>, lvs[i][j],matids[i][j])</div>
<div class="line">        -- print(x0_,y0_,matids[i][j])</div>
<div class="line">    end</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">----<span class="preprocessor">############################################### Setup mesh</span></div>
<div class="line">-- <a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line">--</div>
<div class="line">-- umesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga3feeabcd6b9ab6d60d66b6a3426e81da">chiUnpartitionedMeshFromMshFormat</a>(<span class="stringliteral">&quot;mesh/2D_c5g7_coarse.msh&quot;</span>,<span class="keyword">true</span>)</div>
<div class="line">--</div>
<div class="line">-- --############################################### Create meshers</div>
<div class="line">-- <a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line">-- <a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED,umesh);</div>
<div class="line">--</div>
<div class="line">-- --<a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga84f96adcccf43678b5b94285a2291e66">chiVolumeMesherSetKBAPartitioningPxPyPz</a>(2,2,1)</div>
<div class="line">-- --<a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga2048d69a09e224f5daf0ff4e6c4404e4">chiVolumeMesherSetKBACutsX</a>({27.72})</div>
<div class="line">-- --<a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gae5015130ffe27744255aa29b3e704eb7">chiVolumeMesherSetKBACutsY</a>({27.72})</div>
<div class="line">-- --<a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">PARTITION_TYPE</a>,KBA_STYLE_XYZ)</div>
<div class="line">--</div>
<div class="line">--</div>
<div class="line">-- --############################################### Execute meshing</div>
<div class="line">-- <a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line">-- <a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="ttc" id="achi__mesh__logicalvolume_8h_html_a74944438a086975793d26ae48d5882d4"><div class="ttname"><a href="../../d9/df5/chi__mesh__logicalvolume_8h.html#a74944438a086975793d26ae48d5882d4">RCC</a></div><div class="ttdeci">#define RCC</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df5/chi__mesh__logicalvolume_8h_source.html#l00011">chi_mesh_logicalvolume.h:11</a></div></div>
<div class="ttc" id="agroup___lua_logic_volumes_html_gac362f65e2642b15efd6abf99d2224d54"><div class="ttname"><a href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chi_lua::chiLogicalVolumeCreate</a></div><div class="ttdeci">Handle chiLogicalVolumeCreate(int TypeIndex, varying Values)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l01232">lua_functions.c:1232</a></div></div>
<div class="ttc" id="agroup___lua_unpartitioned_mesh_html_ga0f476b765a307ec7a477c237134298c2"><div class="ttname"><a href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga0f476b765a307ec7a477c237134298c2">chi_lua::chiUnpartitionedMeshFromWavefrontOBJ</a></div><div class="ttdeci">Handle chiUnpartitionedMeshFromWavefrontOBJ(char file_name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l01409">lua_functions.c:1409</a></div></div>
<div class="ttc" id="agroup___lua_volume_mesher_html_ga88fb27136bed385ee1ec665d8d2e9e63"><div class="ttname"><a href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chi_lua::chiVolumeMesherSetMatIDToAll</a></div><div class="ttdeci">void chiVolumeMesherSetMatIDToAll(int material_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l02185">lua_functions.c:2185</a></div></div>
<div class="ttc" id="anamespacechi__mesh_html_a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803"><div class="ttname"><a href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">chi_mesh::MATID_FROMLOGICAL</a></div><div class="ttdeci">@ MATID_FROMLOGICAL</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcb/chi__volumemesher_8h_source.html#l00031">chi_volumemesher.h:31</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_BigTests_c5g7_Test1_X_Sim1_lua" name="tests_BigTests_c5g7_Test1_X_Sim1_lua"></a>tests/BigTests/c5g7/Test1/X_Sim1.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- Final k-eigenvalue    :         1.1925596 (265)</div>
<div class="line">dofile(<span class="stringliteral">&quot;mesh/gmesh_coarse.lua&quot;</span>)</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#gae0ceeadeae53b7ac22b32f3665d1ea2a">chiMeshHandlerExportMeshToVTK</a>(<span class="stringliteral">&quot;ZMesh&quot;</span>)</div>
<div class="line">--os.exit()</div>
<div class="line"><a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#gadc5ded03a8c133015f41e70de61a9abd">chiDestroyUnpartitionedMesh</a>(umesh)</div>
<div class="line">dofile(<span class="stringliteral">&quot;materials/materials.lua&quot;</span>)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a2ab586d2eb85bc3164299497871c8abf">chiLBKESCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2, 2)</div>
<div class="line">--pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,1, 1)</div>
<div class="line"><a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chiOptimizeAngularQuadratureForPolarSymmetry</a>(pqaud, 4.0*math.pi)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga8f9de7a927209f9d2988404bd1eb7d83">chiLBSGroupsetSetAngleAggregationType</a>(phys1, cur_gs, LBSGroupset.ANGLE_AGG_SINGLE)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-8)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,10)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,50)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-8,false)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-8,false)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,LBSBoundaryTypes.REFLECTING);</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,YMIN,LBSBoundaryTypes.REFLECTING);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,0)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;K_EIGEN_METHOD&quot;, &quot;power1&quot;)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;PI_MAX_ITS&quot;, 1000)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;PI_K_TOL&quot;, 1.0e-10)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;PISA_PI_MAX_ITS&quot;, 30)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;PISA_VERBOSE_LEVEL&quot;, 2)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, USE_PRECURSORS, false)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_INNER_ITERATIONS, true)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_OUTER_ITERATIONS, true)</div>
<div class="line"> </div>
<div class="line">-- <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, SWEEP_EAGER_LIMIT, 1e9)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chiExportMultiFieldFunctionToVTK</a>(fflist,<span class="stringliteral">&quot;solutions/ZPhi&quot;</span>)</div>
<div class="ttc" id="agroup___lua_l_b_s_groupsets_html_ga01177a474f138bc1a8b2de984c5d19ae"><div class="ttname"><a href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chi_lua::chiLBSGroupsetAddGroups</a></div><div class="ttdeci">void chiLBSGroupsetAddGroups(int SolverIndex, int GroupsetIndex, int FromIndex, int ToIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l03907">lua_functions.c:3907</a></div></div>
<div class="ttc" id="agroup___lua_l_b_s_groupsets_html_ga6259f18338815b40c3dabacc85bbaa20"><div class="ttname"><a href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chi_lua::chiLBSGroupsetSetQuadrature</a></div><div class="ttdeci">void chiLBSGroupsetSetQuadrature(int SolverIndex, int GroupsetIndex, int QuadratureIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l03979">lua_functions.c:3979</a></div></div>
<div class="ttc" id="agroup___lua_l_b_s_groupsets_html_ga6f775fa549a000e9ef4dca648a8f0f26"><div class="ttname"><a href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chi_lua::chiLBSGroupsetSetTGDSA</a></div><div class="ttdeci">void chiLBSGroupsetSetTGDSA(int SolverIndex, int GroupsetIndex, int MaxIters, float ResTol, bool Verbose, char PETSCString)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04660">lua_functions.c:4660</a></div></div>
<div class="ttc" id="agroup___lua_l_b_s_groupsets_html_ga7d16e3fc369204834a671a6ecf34b564"><div class="ttname"><a href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chi_lua::chiLBSCreateGroup</a></div><div class="ttdeci">void chiLBSCreateGroup(int SolverIndex, int GroupId)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l03832">lua_functions.c:3832</a></div></div>
<div class="ttc" id="agroup___lua_l_b_s_groupsets_html_ga7ea307566dd5e37892f4d3398b87dd51"><div class="ttname"><a href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chi_lua::chiLBSGroupsetSetMaxIterations</a></div><div class="ttdeci">void chiLBSGroupsetSetMaxIterations(int SolverIndex, int GroupsetIndex, int Numiter)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04447">lua_functions.c:4447</a></div></div>
<div class="ttc" id="agroup___lua_l_b_s_groupsets_html_ga80f2a61eab1d91be0b1a2fbb7eee248d"><div class="ttname"><a href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chi_lua::chiLBSGroupsetSetAngleAggDiv</a></div><div class="ttdeci">void chiLBSGroupsetSetAngleAggDiv(int SolverIndex, int GroupsetIndex, int NumDiv)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04094">lua_functions.c:4094</a></div></div>
<div class="ttc" id="agroup___lua_l_b_s_groupsets_html_ga8f9de7a927209f9d2988404bd1eb7d83"><div class="ttname"><a href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga8f9de7a927209f9d2988404bd1eb7d83">chi_lua::chiLBSGroupsetSetAngleAggregationType</a></div><div class="ttdeci">void chiLBSGroupsetSetAngleAggregationType(int SolverIndex, int GroupsetIndex, int AggregationType)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04020">lua_functions.c:4020</a></div></div>
<div class="ttc" id="agroup___lua_l_b_s_groupsets_html_ga90ea59396524ccbe65703b14faa7c10f"><div class="ttname"><a href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chi_lua::chiLBSGroupsetSetGroupSubsets</a></div><div class="ttdeci">void chiLBSGroupsetSetGroupSubsets(int SolverIndex, int GroupsetIndex, int NumDiv)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04160">lua_functions.c:4160</a></div></div>
<div class="ttc" id="agroup___lua_l_b_s_groupsets_html_gaa3a93090cb8354c7f2140d569497d9ca"><div class="ttname"><a href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chi_lua::chiLBSGroupsetSetResidualTolerance</a></div><div class="ttdeci">void chiLBSGroupsetSetResidualTolerance(int SolverIndex, int GroupsetIndex, float ResidualTol)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04378">lua_functions.c:4378</a></div></div>
<div class="ttc" id="agroup___lua_l_b_s_groupsets_html_gab0c834b63faf291866f5db2b063897b5"><div class="ttname"><a href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chi_lua::chiLBSGroupsetSetWGDSA</a></div><div class="ttdeci">void chiLBSGroupsetSetWGDSA(int SolverIndex, int GroupsetIndex, int MaxIters, float ResTol, bool Verbose, char PETSCString)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04600">lua_functions.c:4600</a></div></div>
<div class="ttc" id="agroup___lua_l_b_s_groupsets_html_gaf50e94d09febcd8a846433e007ef4fd3"><div class="ttname"><a href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chi_lua::chiLBSGroupsetSetIterativeMethod</a></div><div class="ttdeci">void chiLBSGroupsetSetIterativeMethod(int SolverIndex, int GroupsetIndex, int IterativeMethod)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04305">lua_functions.c:4305</a></div></div>
<div class="ttc" id="agroup___lua_l_b_s_groupsets_html_gaf5d1e656f52f80b4615f022003d1b407"><div class="ttname"><a href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chi_lua::chiLBSCreateGroupset</a></div><div class="ttdeci">void chiLBSCreateGroupset(int SolverIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l03761">lua_functions.c:3761</a></div></div>
<div class="ttc" id="agroup___lua_l_b_s_groupsets_html_gaf8947d86f23a21e9243035e717e5ee4d"><div class="ttname"><a href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chi_lua::chiLBSGroupsetSetGMRESRestartIntvl</a></div><div class="ttdeci">void chiLBSGroupsetSetGMRESRestartIntvl(int SolverIndex, int GroupsetIndex, int Intvl)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04515">lua_functions.c:4515</a></div></div>
<div class="ttc" id="agroup___lua_l_b_s_html_ga56ba50206c4125503807c5889416b66a"><div class="ttname"><a href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chi_lua::chiLBSSetProperty</a></div><div class="ttdeci">void chiLBSSetProperty(int SolverIndex, int PropertyIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l03652">lua_functions.c:3652</a></div></div>
<div class="ttc" id="agroup___lua_l_b_s_html_gaf96d1d72d1274c36390436edabb1b0f9"><div class="ttname"><a href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chi_lua::chiLBSGetScalarFieldFunctionList</a></div><div class="ttdeci">Pair chiLBSGetScalarFieldFunctionList(int SolverIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04886">lua_functions.c:4886</a></div></div>
<div class="ttc" id="agroup___lua_mesh_handler_html_gae0ceeadeae53b7ac22b32f3665d1ea2a"><div class="ttname"><a href="../../da/d92/group___lua_mesh_handler.html#gae0ceeadeae53b7ac22b32f3665d1ea2a">chi_lua::chiMeshHandlerExportMeshToVTK</a></div><div class="ttdeci">void chiMeshHandlerExportMeshToVTK(char FileName)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l02349">lua_functions.c:2349</a></div></div>
<div class="ttc" id="agroup___lua_quadrature_html_ga310caeec08395d1fa35d319489fc08f2"><div class="ttname"><a href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chi_lua::chiCreateProductQuadrature</a></div><div class="ttdeci">Returns chiCreateProductQuadrature(int QuadratureType, varying values)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l03191">lua_functions.c:3191</a></div></div>
<div class="ttc" id="agroup___lua_quadrature_html_ga8c4e64918adaadfcd5bcfa03d515143a"><div class="ttname"><a href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chi_lua::chiOptimizeAngularQuadratureForPolarSymmetry</a></div><div class="ttdeci">void chiOptimizeAngularQuadratureForPolarSymmetry(int. handle, double. normalization)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l03261">lua_functions.c:3261</a></div></div>
<div class="ttc" id="agroup___lua_solver_html_ga2522341caaf1b9ae3f18451542d1956b"><div class="ttname"><a href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chi_lua::chiSolverSetBasicOption</a></div><div class="ttdeci">void chiSolverSetBasicOption(int solver_handle, string option_name, varying option_value)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00577">lua_functions.c:577</a></div></div>
<div class="ttc" id="agroup___lua_solver_html_ga28fdf6aad809b089f96c1776f699ee5c"><div class="ttname"><a href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chi_lua::chiSolverExecute</a></div><div class="ttdeci">void chiSolverExecute(int solver_handle)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00521">lua_functions.c:521</a></div></div>
<div class="ttc" id="agroup___lua_solver_html_gab828b1bcee57fed19f7dda9befc5846b"><div class="ttname"><a href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chi_lua::chiSolverInitialize</a></div><div class="ttdeci">void chiSolverInitialize(int solver_handle)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00457">lua_functions.c:457</a></div></div>
<div class="ttc" id="agroup___lua_unpartitioned_mesh_html_gadc5ded03a8c133015f41e70de61a9abd"><div class="ttname"><a href="../../d2/dde/group___lua_unpartitioned_mesh.html#gadc5ded03a8c133015f41e70de61a9abd">chi_lua::chiDestroyUnpartitionedMesh</a></div><div class="ttdeci">void chiDestroyUnpartitionedMesh(int handle)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l01276">lua_functions.c:1276</a></div></div>
<div class="ttc" id="anamespacechi__lua_html_a2ab586d2eb85bc3164299497871c8abf"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#a2ab586d2eb85bc3164299497871c8abf">chi_lua::chiLBKESCreateSolver</a></div><div class="ttdeci">Handle chiLBKESCreateSolver(string SolverName)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l03410">lua_functions.c:3410</a></div></div>
<div class="ttc" id="anamespacechi__lua_html_ab044ed9b1310ab95d5af2266a87869d3"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chi_lua::chiExportMultiFieldFunctionToVTK</a></div><div class="ttdeci">void chiExportMultiFieldFunctionToVTK(table listFFHandles, char BaseName)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00275">lua_functions.c:275</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_BigTests_QBlock_materials_lua" name="tests_BigTests_QBlock_materials_lua"></a>tests/BigTests/QBlock/materials.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Create cross sections</div>
<div class="line">xs = {}</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">for</span> m=0,1 <span class="keywordflow">do</span></div>
<div class="line">    xs[tostring(m)] = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga82468060b3343581b90ceb06aa1e52c3">chiPhysicsTransportXSCreate</a>()</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs[&quot;0&quot;],CHI_XSFILE,&quot;tests/BigTests/QBlock/xs_water_g2_bak.cxs&quot;)</div>
<div class="line"><a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs[&quot;1&quot;],CHI_XSFILE,&quot;tests/BigTests/QBlock/xs_fuel_g2_bak.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">water_xs = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#gaaf87347d2ab88ea5e88058038754bddf">chiPhysicsTransportXSGet</a>(xs[&quot;0&quot;])</div>
<div class="line">num_groups = water_xs[&quot;num_groups&quot;]</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Create materials</span></div>
<div class="line">materials = {}</div>
<div class="line"><span class="keywordflow">for</span> m=0,1 <span class="keywordflow">do</span></div>
<div class="line">    key = tostring(m)</div>
<div class="line">    materials[key] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Material_&quot;</span>..key)</div>
<div class="line">    <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(key,TRANSPORT_XSECTIONS)</div>
<div class="line">    <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(key,TRANSPORT_XSECTIONS, EXISTING,xs[key])</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_BigTests_QBlock_mesh_lua" name="tests_BigTests_QBlock_mesh_lua"></a>tests/BigTests/QBlock/mesh.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=40</div>
<div class="line">L=14</div>
<div class="line">xmin_ = 0.0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,10.0,-1000,10.0,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="ttc" id="achi__mesh__logicalvolume_8h_html_ab27b91d4128c63b2fa1ff9d4c7f179a5"><div class="ttname"><a href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a></div><div class="ttdeci">#define RPP</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df5/chi__mesh__logicalvolume_8h_source.html#l00010">chi_mesh_logicalvolume.h:10</a></div></div>
<div class="ttc" id="agroup___lua_mesh_macros_html_ga83d9d3e4a7ae7060391faefe17c1076a"><div class="ttname"><a href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chi_lua::chiMeshCreateUnpartitioned2DOrthoMesh</a></div><div class="ttdeci">Two chiMeshCreateUnpartitioned2DOrthoMesh(array_float x_nodes, array_float y_nodes)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l01706">lua_functions.c:1706</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_BigTests_QBlock_QBlock1a_lua" name="tests_BigTests_QBlock_QBlock1a_lua"></a>tests/BigTests/QBlock/QBlock1a.lua</h3><div class="textblock"><div class="fragment"><div class="line">dofile(<span class="stringliteral">&quot;tests/BigTests/QBlock/mesh.lua&quot;</span>)</div>
<div class="line">dofile(&quot;tests/BigTests/QBlock/materials.lua&quot;) --num_groups assigned here</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Setup Physics</span></div>
<div class="line">phys1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a2ab586d2eb85bc3164299497871c8abf">chiLBKESCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,4, 4)</div>
<div class="line"><a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chiOptimizeAngularQuadratureForPolarSymmetry</a>(pqaud, 4.0*math.pi)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_RICHARDSON_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-8)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,50)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,50)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-8,false)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-8,false)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,LBSBoundaryTypes.REFLECTING);</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,YMIN,LBSBoundaryTypes.REFLECTING);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,2)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#afa05f65c8e59f60b628b973204107feb">chiLBKESSetProperty</a>(phys1, &quot;MAX_ITERATIONS&quot;, 1000)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#afa05f65c8e59f60b628b973204107feb">chiLBKESSetProperty</a>(phys1, &quot;TOLERANCE&quot;, 1.0e-10)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#afa05f65c8e59f60b628b973204107feb">chiLBKESSetProperty</a>(phys1, &quot;K_EIGEN_METHOD&quot;, &quot;power&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, USE_PRECURSORS, false)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_INNER_ITERATIONS, false)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_OUTER_ITERATIONS, true)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chiExportMultiFieldFunctionToVTK</a>(fflist,<span class="stringliteral">&quot;tests/BigTests/QBlock/solutions/Flux&quot;</span>)</div>
<div class="line"> </div>
<div class="line">-- Reference value k_eff = 0.5969127</div>
<div class="ttc" id="anamespacechi__lua_html_afa05f65c8e59f60b628b973204107feb"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#afa05f65c8e59f60b628b973204107feb">chi_lua::chiLBKESSetProperty</a></div><div class="ttdeci">void chiLBKESSetProperty()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l03396">lua_functions.c:3396</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_BigTests_QBlock_QBlock1b_lua" name="tests_BigTests_QBlock_QBlock1b_lua"></a>tests/BigTests/QBlock/QBlock1b.lua</h3><div class="textblock"><div class="fragment"><div class="line">dofile(<span class="stringliteral">&quot;tests/BigTests/QBlock/mesh.lua&quot;</span>)</div>
<div class="line">dofile(&quot;tests/BigTests/QBlock/materials.lua&quot;) --num_groups assigned here</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Setup Physics</span></div>
<div class="line">phys1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a2ab586d2eb85bc3164299497871c8abf">chiLBKESCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,4, 4)</div>
<div class="line"><a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chiOptimizeAngularQuadratureForPolarSymmetry</a>(pqaud, 4.0*math.pi)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_RICHARDSON_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-8)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,50)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,10)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-8,false)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-8,false)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,LBSBoundaryTypes.REFLECTING);</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,YMIN,LBSBoundaryTypes.REFLECTING);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,2)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#afa05f65c8e59f60b628b973204107feb">chiLBKESSetProperty</a>(phys1, &quot;MAX_ITERATIONS&quot;, 100)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#afa05f65c8e59f60b628b973204107feb">chiLBKESSetProperty</a>(phys1, &quot;TOLERANCE&quot;, 1.0e-10)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#afa05f65c8e59f60b628b973204107feb">chiLBKESSetProperty</a>(phys1, &quot;K_EIGEN_METHOD&quot;, &quot;nonlinear&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, USE_PRECURSORS, false)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_INNER_ITERATIONS, false)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_OUTER_ITERATIONS, true)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chiExportMultiFieldFunctionToVTK</a>(fflist,<span class="stringliteral">&quot;tests/BigTests/QBlock/solutions/Flux&quot;</span>)</div>
<div class="line"> </div>
<div class="line">-- Reference value k_eff = 0.5969127</div>
</div><!-- fragment --> </div>

<h3><a id="tests_CFEM_Diffusion_cDiffusion_2D_1a_linear_lua" name="tests_CFEM_Diffusion_cDiffusion_2D_1a_linear_lua"></a>tests/CFEM_Diffusion/cDiffusion_2D_1a_linear.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=10</div>
<div class="line">L=2</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line">D = {1.0}</div>
<div class="line">Q = {0.0}</div>
<div class="line">XSa = {0.0}</div>
<div class="line">function D_coef(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> D[i+1]</div>
<div class="line">end</div>
<div class="line">function Q_ext(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> Q[i+1]</div>
<div class="line">end</div>
<div class="line">function Sigma_a(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> XSa[i+1]</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">-- Setboundary IDs</div>
<div class="line">-- xmin_,xmax_,ymin_,ymax_,zmin_,zmax_</div>
<div class="line">e_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,0.99999,1000,-1000,1000,-1000,1000)</div>
<div class="line">w_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,-0.9999,-1000,1000,-1000,1000)</div>
<div class="line">n_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,0.99999,1000,-1000,1000)</div>
<div class="line">s_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,-0.99999,-1000,1000)</div>
<div class="line"> </div>
<div class="line">e_bndry = 0</div>
<div class="line">w_bndry = 1</div>
<div class="line">n_bndry = 2</div>
<div class="line">s_bndry = 3</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,e_vol,e_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,w_vol,w_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,n_vol,n_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,s_vol,s_bndry)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add material properties</span></div>
<div class="line">--#### CFEM solver</div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga3ba95dae1e7a304f4c3e97eda855625d">chiCFEMDiffusionSolverCreate</a>()</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;residual_tolerance&quot;, 1E-8)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga5331d5d64e47705f13438030332354d0">chiCFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,e_bndry,&quot;robin&quot;, 0.25, 0.5, 0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga5331d5d64e47705f13438030332354d0">chiCFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,n_bndry,&quot;reflecting&quot;)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga5331d5d64e47705f13438030332354d0">chiCFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,s_bndry,&quot;reflecting&quot;)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga5331d5d64e47705f13438030332354d0">chiCFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,w_bndry,&quot;robin&quot;, 0.25, 0.5, 1.0)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Get field functions</span></div>
<div class="line">fflist,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Export VTU</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chiExportFieldFunctionToVTK</a>(fflist[1],<span class="stringliteral">&quot;CFEMDiff2D_linear&quot;</span>,<span class="stringliteral">&quot;flux&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Line plot</span></div>
<div class="line">cline = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(LINE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(cline,LINE_FIRSTPOINT,-L/2, 0.0, 0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(cline,LINE_SECONDPOINT,L/2, 0.0, 0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(cline,LINE_NUMBEROFPOINTS, 50)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(cline,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(cline)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(cline)</div>
<div class="line"> </div>
<div class="line">if (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(cline)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"> </div>
<div class="line">ffvol = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(ffvol)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(ffvol)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(ffvol)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Max-value=%.6f&quot;, maxval))</div>
<div class="ttc" id="agroup___lua_diffusion_html_ga3ba95dae1e7a304f4c3e97eda855625d"><div class="ttname"><a href="../../de/d15/group___lua_diffusion.html#ga3ba95dae1e7a304f4c3e97eda855625d">chi_lua::chiCFEMDiffusionSolverCreate</a></div><div class="ttdeci">Handle chiCFEMDiffusionSolverCreate()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l05215">lua_functions.c:5215</a></div></div>
<div class="ttc" id="agroup___lua_diffusion_html_ga5331d5d64e47705f13438030332354d0"><div class="ttname"><a href="../../de/d15/group___lua_diffusion.html#ga5331d5d64e47705f13438030332354d0">chi_lua::chiCFEMDiffusionSetBCProperty</a></div><div class="ttdeci">void chiCFEMDiffusionSetBCProperty(int SolverHandle, string PropertyName, varying Values)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l05272">lua_functions.c:5272</a></div></div>
<div class="ttc" id="agroup___lua_f_f_interpol_html_ga50c247b26a80c528198b5c2cd9be940c"><div class="ttname"><a href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chi_lua::chiFFInterpolationExportPython</a></div><div class="ttdeci">void chiFFInterpolationExportPython(int FFIHandle, char BaseName)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l02917">lua_functions.c:2917</a></div></div>
<div class="ttc" id="agroup___lua_f_f_interpol_html_ga7305438e0a0dac15a779e1a340b12f7b"><div class="ttname"><a href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chi_lua::chiFFInterpolationCreate</a></div><div class="ttdeci">Handle chiFFInterpolationCreate(int FFITypeIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l02732">lua_functions.c:2732</a></div></div>
<div class="ttc" id="agroup___lua_f_f_interpol_html_ga94fdabdc1c1558288c8660b86806b7a6"><div class="ttname"><a href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chi_lua::chiFFInterpolationExecute</a></div><div class="ttdeci">void chiFFInterpolationExecute(int FFIHandle)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l02598">lua_functions.c:2598</a></div></div>
<div class="ttc" id="agroup___lua_f_f_interpol_html_gabe37b9b7813af20ba8dc82a6b1eef3b8"><div class="ttname"><a href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chi_lua::chiFFInterpolationGetValue</a></div><div class="ttdeci">void chiFFInterpolationGetValue(int FFIHandle)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l02663">lua_functions.c:2663</a></div></div>
<div class="ttc" id="agroup___lua_f_f_interpol_html_gac6e3979ecc5e6a577eb268be00f4cfa0"><div class="ttname"><a href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chi_lua::chiFFInterpolationInitialize</a></div><div class="ttdeci">void chiFFInterpolationInitialize(int FFIHandle)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l02540">lua_functions.c:2540</a></div></div>
<div class="ttc" id="agroup___lua_f_f_interpol_html_gaf870d79259973f193b0d485bfdc1fc8d"><div class="ttname"><a href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chi_lua::chiFFInterpolationSetProperty</a></div><div class="ttdeci">Handle chiFFInterpolationSetProperty(int FFIHandle, int PropertyIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l02868">lua_functions.c:2868</a></div></div>
<div class="ttc" id="agroup___lua_solver_html_gafd9778eaca8f2cba9dd4b60dc9b51aa8"><div class="ttname"><a href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chi_lua::chiSolverGetFieldFunctionList</a></div><div class="ttdeci">void chiSolverGetFieldFunctionList(int SolverHandle)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00624">lua_functions.c:624</a></div></div>
<div class="ttc" id="anamespacechi__lua_html_ade62e412808353858dbd1a655127ae2e"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chi_lua::chiExportFieldFunctionToVTK</a></div><div class="ttdeci">void chiExportFieldFunctionToVTK(int FFHandle, char BaseName)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00244">lua_functions.c:244</a></div></div>
<div class="ttc" id="anamespacechi__math_html_a75948cb3d263fe5216470bae075742ea"><div class="ttname"><a href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">chi_math::Set</a></div><div class="ttdeci">void Set(VecDbl &amp;x, const double &amp;val)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d89/chi__math__03__vector__operations_8cc_source.html#l00023">chi_math_03_vector_operations.cc:23</a></div></div>
<div class="ttc" id="anamespacechi__mesh_html_a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285"><div class="ttname"><a href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">chi_mesh::BNDRYID_FROMLOGICAL</a></div><div class="ttdeci">@ BNDRYID_FROMLOGICAL</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcb/chi__volumemesher_8h_source.html#l00032">chi_volumemesher.h:32</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_CFEM_Diffusion_cDiffusion_2D_2a_DirBCs_lua" name="tests_CFEM_Diffusion_cDiffusion_2D_2a_DirBCs_lua"></a>tests/CFEM_Diffusion/cDiffusion_2D_2a_DirBCs.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=40</div>
<div class="line">L=2</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.5,0.5,-0.5,0.5,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line">D = {1.0,0.01}</div>
<div class="line">Q = {1.0,10.0}</div>
<div class="line">XSa = {1.0,10.0}</div>
<div class="line">function D_coef(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> D[i+1]</div>
<div class="line">end</div>
<div class="line">function Q_ext(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> Q[i+1]</div>
<div class="line">end</div>
<div class="line">function Sigma_a(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> XSa[i+1]</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">-- Setboundary IDs</div>
<div class="line">-- xmin_,xmax_,ymin_,ymax_,zmin_,zmax_</div>
<div class="line">e_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,0.99999,1000,-1000,1000,-1000,1000)</div>
<div class="line">w_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,-0.9999,-1000,1000,-1000,1000)</div>
<div class="line">n_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,0.99999,1000,-1000,1000)</div>
<div class="line">s_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,-0.99999,-1000,1000)</div>
<div class="line"> </div>
<div class="line">e_bndry = 0</div>
<div class="line">w_bndry = 1</div>
<div class="line">n_bndry = 2</div>
<div class="line">s_bndry = 3</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,e_vol,e_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,w_vol,w_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,n_vol,n_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,s_vol,s_bndry)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add material properties</span></div>
<div class="line">--#### CFEM solver</div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga3ba95dae1e7a304f4c3e97eda855625d">chiCFEMDiffusionSolverCreate</a>()</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;residual_tolerance&quot;, 1E-8)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga5331d5d64e47705f13438030332354d0">chiCFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,e_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga5331d5d64e47705f13438030332354d0">chiCFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,w_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga5331d5d64e47705f13438030332354d0">chiCFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,n_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga5331d5d64e47705f13438030332354d0">chiCFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,s_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Get field functions</span></div>
<div class="line">fflist,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Export VTU</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chiExportFieldFunctionToVTK</a>(fflist[1],<span class="stringliteral">&quot;CFEMDiff2D_Dirichlet&quot;</span>,<span class="stringliteral">&quot;flux&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"> </div>
<div class="line">ffvol = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,OPERATION,OP_AVG)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(ffvol)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(ffvol)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(ffvol)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Avg-value=%.6f&quot;, maxval))</div>
</div><!-- fragment --> </div>

<h3><a id="tests_CFEM_Diffusion_cDiffusion_2D_2b_RobinBCs_lua" name="tests_CFEM_Diffusion_cDiffusion_2D_2b_RobinBCs_lua"></a>tests/CFEM_Diffusion/cDiffusion_2D_2b_RobinBCs.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=40</div>
<div class="line">L=2</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.5,0.5,-0.5,0.5,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line">D = {1.0,5.0}</div>
<div class="line">Q = {0.0,1.0}</div>
<div class="line">XSa = {1.0,1.0}</div>
<div class="line">function D_coef(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> D[i+1] -- + x</div>
<div class="line">end</div>
<div class="line">function Q_ext(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> Q[i+1] -- x*x</div>
<div class="line">end</div>
<div class="line">function Sigma_a(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> XSa[i+1]</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">-- Setboundary IDs</div>
<div class="line">-- xmin_,xmax_,ymin_,ymax_,zmin_,zmax_</div>
<div class="line">e_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,0.99999,1000,-1000,1000,-1000,1000)</div>
<div class="line">w_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,-0.9999,-1000,1000,-1000,1000)</div>
<div class="line">n_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,0.99999,1000,-1000,1000)</div>
<div class="line">s_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,-0.99999,-1000,1000)</div>
<div class="line"> </div>
<div class="line">e_bndry = 0</div>
<div class="line">w_bndry = 1</div>
<div class="line">n_bndry = 2</div>
<div class="line">s_bndry = 3</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,e_vol,e_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,w_vol,w_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,n_vol,n_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,s_vol,s_bndry)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add material properties</span></div>
<div class="line">--#### CFEM solver</div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga3ba95dae1e7a304f4c3e97eda855625d">chiCFEMDiffusionSolverCreate</a>()</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;residual_tolerance&quot;, 1E-8)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga5331d5d64e47705f13438030332354d0">chiCFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,e_bndry,&quot;robin&quot;, 0.25, 0.5, 0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga5331d5d64e47705f13438030332354d0">chiCFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,n_bndry,&quot;reflecting&quot;)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga5331d5d64e47705f13438030332354d0">chiCFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,s_bndry,&quot;reflecting&quot;)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga5331d5d64e47705f13438030332354d0">chiCFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,w_bndry,&quot;robin&quot;, 0.25, 0.5, 0.1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Get field functions</span></div>
<div class="line">fflist,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Export VTU</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chiExportFieldFunctionToVTK</a>(fflist[1],<span class="stringliteral">&quot;CFEMDiff2D_RobinRefl&quot;</span>,<span class="stringliteral">&quot;flux&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"> </div>
<div class="line">ffvol = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,OPERATION,OP_AVG)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(ffvol)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(ffvol)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(ffvol)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Avg-value=%.6f&quot;, maxval))</div>
</div><!-- fragment --> </div>

<h3><a id="tests_CFEM_Diffusion_cDiffusion_2D_3a_analytical_coef_lua" name="tests_CFEM_Diffusion_cDiffusion_2D_3a_analytical_coef_lua"></a>tests/CFEM_Diffusion/cDiffusion_2D_3a_analytical_coef.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=100</div>
<div class="line">L=2</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">function D_coef(i,x,y,z)</div>
<div class="line">    return 3.0 + x + y</div>
<div class="line">end</div>
<div class="line">function Q_ext(i,x,y,z)</div>
<div class="line">    return x*x</div>
<div class="line">end</div>
<div class="line">function Sigma_a(i,x,y,z)</div>
<div class="line">    return x*y*y</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">-- Setboundary IDs</div>
<div class="line">-- xmin_,xmax_,ymin_,ymax_,zmin_,zmax_</div>
<div class="line">e_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,0.99999,1000,-1000,1000,-1000,1000)</div>
<div class="line">w_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,-0.9999,-1000,1000,-1000,1000)</div>
<div class="line">n_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,0.99999,1000,-1000,1000)</div>
<div class="line">s_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,-0.99999,-1000,1000)</div>
<div class="line"> </div>
<div class="line">e_bndry = 0</div>
<div class="line">w_bndry = 1</div>
<div class="line">n_bndry = 2</div>
<div class="line">s_bndry = 3</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,e_vol,e_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,w_vol,w_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,n_vol,n_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,s_vol,s_bndry)</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#gae0ceeadeae53b7ac22b32f3665d1ea2a">chiMeshHandlerExportMeshToVTK</a>(&quot;Mesh&quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add material properties</span></div>
<div class="line">--#### CFEM solver</div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga3ba95dae1e7a304f4c3e97eda855625d">chiCFEMDiffusionSolverCreate</a>()</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga5331d5d64e47705f13438030332354d0">chiCFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,e_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga5331d5d64e47705f13438030332354d0">chiCFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,w_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga5331d5d64e47705f13438030332354d0">chiCFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,n_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga5331d5d64e47705f13438030332354d0">chiCFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,s_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Get field functions</span></div>
<div class="line">fflist,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Export VTU</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chiExportFieldFunctionToVTK</a>(fflist[1],<span class="stringliteral">&quot;CFEMDiff2D_analytic_coef&quot;</span>,<span class="stringliteral">&quot;flux&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"> </div>
<div class="line">ffvol = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(ffvol)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(ffvol)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(ffvol)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Max-value=%.6f&quot;, maxval))</div>
</div><!-- fragment --> </div>

<h3><a id="tests_CFEM_Diffusion_cDiffusion_2D_3b_analytical_coef2_lua" name="tests_CFEM_Diffusion_cDiffusion_2D_3b_analytical_coef2_lua"></a>tests/CFEM_Diffusion/cDiffusion_2D_3b_analytical_coef2.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=40</div>
<div class="line">L=1</div>
<div class="line">xmin_ = 0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line">-- governing law: -(u_xx + u_yy) = q, on domain [0,1]x[0,1]</div>
<div class="line">-- when the exact solution is chosen u(x,y) = sin(pi.x) * sin(pi.y)</div>
<div class="line">-- <span class="keyword">this</span> automatically gives:</div>
<div class="line">--    boundary = zero-<a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200abac152b762896edff34ed668ae1a546f">Dirichlet</a> on all 4 sides</div>
<div class="line">--    volumetric source term: q(,x) = 2*pi*pi * sin(pi.x) * sin(pi.y)</div>
<div class="line">-- the factor 2 is the dim of the problem</div>
<div class="line"> </div>
<div class="line">function D_coef(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> 1.0</div>
<div class="line">end</div>
<div class="line">function Q_ext(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> 2.*math.pi*math.pi * math.sin(math.pi*x) * math.sin(math.pi*y)</div>
<div class="line">end</div>
<div class="line">function Sigma_a(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> 0.0</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">-- Setboundary IDs</div>
<div class="line">-- xmin_,xmax_,ymin_,ymax_,zmin_,zmax_</div>
<div class="line">e_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,0.99999,1000,-1000,1000,-1000,1000)</div>
<div class="line">w_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,0.00001,-1000,1000,-1000,1000)</div>
<div class="line">n_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,0.99999,1000,-1000,1000)</div>
<div class="line">s_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,0.00001,-1000,1000)</div>
<div class="line"> </div>
<div class="line">e_bndry = 0</div>
<div class="line">w_bndry = 1</div>
<div class="line">n_bndry = 2</div>
<div class="line">s_bndry = 3</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,e_vol,e_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,w_vol,w_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,n_vol,n_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,s_vol,s_bndry)</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#gae0ceeadeae53b7ac22b32f3665d1ea2a">chiMeshHandlerExportMeshToVTK</a>(&quot;Mesh&quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add material properties</span></div>
<div class="line">--#### CFEM solver</div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga3ba95dae1e7a304f4c3e97eda855625d">chiCFEMDiffusionSolverCreate</a>()</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga5331d5d64e47705f13438030332354d0">chiCFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,e_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga5331d5d64e47705f13438030332354d0">chiCFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,w_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga5331d5d64e47705f13438030332354d0">chiCFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,n_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga5331d5d64e47705f13438030332354d0">chiCFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,s_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Get field functions</span></div>
<div class="line">fflist,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Export VTU</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chiExportFieldFunctionToVTK</a>(fflist[1],<span class="stringliteral">&quot;CFEMDiff2D_analytic_coef2&quot;</span>,<span class="stringliteral">&quot;flux&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"> </div>
<div class="line">ffvol = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(ffvol)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(ffvol)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(ffvol)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Max-value=%.6f&quot;, maxval))</div>
<div class="ttc" id="anamespacecfem__diffusion_html_a231772ce90e37a7ba9331c9194a99200abac152b762896edff34ed668ae1a546f"><div class="ttname"><a href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200abac152b762896edff34ed668ae1a546f">cfem_diffusion::BoundaryType::Dirichlet</a></div><div class="ttdeci">@ Dirichlet</div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_DFEM_Diffusion_dDiffusion_2D_1a_linear_lua" name="tests_DFEM_Diffusion_dDiffusion_2D_1a_linear_lua"></a>tests/DFEM_Diffusion/dDiffusion_2D_1a_linear.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=10</div>
<div class="line">L=2</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line">D = {1.0}</div>
<div class="line">Q = {0.0}</div>
<div class="line">XSa = {0.0}</div>
<div class="line">function D_coef(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> D[i+1]</div>
<div class="line">end</div>
<div class="line">function Q_ext(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> Q[i+1]</div>
<div class="line">end</div>
<div class="line">function Sigma_a(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> XSa[i+1]</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">-- Setboundary IDs</div>
<div class="line">-- xmin_,xmax_,ymin_,ymax_,zmin_,zmax_</div>
<div class="line">e_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,0.99999,1000,-1000,1000,-1000,1000)</div>
<div class="line">w_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,-0.9999,-1000,1000,-1000,1000)</div>
<div class="line">n_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,0.99999,1000,-1000,1000)</div>
<div class="line">s_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,-0.99999,-1000,1000)</div>
<div class="line"> </div>
<div class="line">e_bndry = 0</div>
<div class="line">w_bndry = 1</div>
<div class="line">n_bndry = 2</div>
<div class="line">s_bndry = 3</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,e_vol,e_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,w_vol,w_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,n_vol,n_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,s_vol,s_bndry)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add material properties</span></div>
<div class="line">--#### DFEM solver</div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaa204e0f4273fce1a60a7c95a8925f28b">chiDFEMDiffusionSolverCreate</a>()</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;residual_tolerance&quot;, 1E-8)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga414ccf35e9892e26cd48da62b89489f0">chiDFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,e_bndry,&quot;robin&quot;, 0.25, 0.5, 0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga414ccf35e9892e26cd48da62b89489f0">chiDFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,n_bndry,&quot;reflecting&quot;)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga414ccf35e9892e26cd48da62b89489f0">chiDFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,s_bndry,&quot;reflecting&quot;)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga414ccf35e9892e26cd48da62b89489f0">chiDFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,w_bndry,&quot;robin&quot;, 0.25, 0.5, 1.0)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Get field functions</span></div>
<div class="line">fflist,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Export VTU</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chiExportFieldFunctionToVTK</a>(fflist[1],<span class="stringliteral">&quot;DFEMDiff2D_linear&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Line plot</span></div>
<div class="line">cline = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(LINE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(cline,LINE_FIRSTPOINT,-L/2, 0.0, 0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(cline,LINE_SECONDPOINT,L/2, 0.0, 0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(cline,LINE_NUMBEROFPOINTS, 50)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(cline,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(cline)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(cline)</div>
<div class="line"> </div>
<div class="line">if (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(cline)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"> </div>
<div class="line">ffvol = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(ffvol)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(ffvol)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(ffvol)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Max-value=%.6f&quot;, maxval))</div>
<div class="ttc" id="agroup___lua_diffusion_html_ga414ccf35e9892e26cd48da62b89489f0"><div class="ttname"><a href="../../de/d15/group___lua_diffusion.html#ga414ccf35e9892e26cd48da62b89489f0">chi_lua::chiDFEMDiffusionSetBCProperty</a></div><div class="ttdeci">void chiDFEMDiffusionSetBCProperty(int SolverHandle, string PropertyName, varying Values)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l05486">lua_functions.c:5486</a></div></div>
<div class="ttc" id="agroup___lua_diffusion_html_gaa204e0f4273fce1a60a7c95a8925f28b"><div class="ttname"><a href="../../de/d15/group___lua_diffusion.html#gaa204e0f4273fce1a60a7c95a8925f28b">chi_lua::chiDFEMDiffusionSolverCreate</a></div><div class="ttdeci">Handle chiDFEMDiffusionSolverCreate()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l05428">lua_functions.c:5428</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_DFEM_Diffusion_dDiffusion_2D_2a_DirBCs_lua" name="tests_DFEM_Diffusion_dDiffusion_2D_2a_DirBCs_lua"></a>tests/DFEM_Diffusion/dDiffusion_2D_2a_DirBCs.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=40</div>
<div class="line">L=2</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.5,0.5,-0.5,0.5,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line">D = {1.0,0.01}</div>
<div class="line">Q = {1.0,10.0}</div>
<div class="line">XSa = {1.0,10.0}</div>
<div class="line">function D_coef(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> D[i+1]</div>
<div class="line">end</div>
<div class="line">function Q_ext(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> Q[i+1]</div>
<div class="line">end</div>
<div class="line">function Sigma_a(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> XSa[i+1]</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">-- Setboundary IDs</div>
<div class="line">-- xmin_,xmax_,ymin_,ymax_,zmin_,zmax_</div>
<div class="line">e_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,0.99999,1000,-1000,1000,-1000,1000)</div>
<div class="line">w_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,-0.9999,-1000,1000,-1000,1000)</div>
<div class="line">n_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,0.99999,1000,-1000,1000)</div>
<div class="line">s_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,-0.99999,-1000,1000)</div>
<div class="line"> </div>
<div class="line">e_bndry = 0</div>
<div class="line">w_bndry = 1</div>
<div class="line">n_bndry = 2</div>
<div class="line">s_bndry = 3</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,e_vol,e_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,w_vol,w_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,n_vol,n_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,s_vol,s_bndry)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add material properties</span></div>
<div class="line">--#### DFEM solver</div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaa204e0f4273fce1a60a7c95a8925f28b">chiDFEMDiffusionSolverCreate</a>()</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;residual_tolerance&quot;, 1E-8)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga414ccf35e9892e26cd48da62b89489f0">chiDFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,e_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga414ccf35e9892e26cd48da62b89489f0">chiDFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,w_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga414ccf35e9892e26cd48da62b89489f0">chiDFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,n_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga414ccf35e9892e26cd48da62b89489f0">chiDFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,s_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Get field functions</span></div>
<div class="line">fflist,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Export VTU</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chiExportFieldFunctionToVTK</a>(fflist[1],<span class="stringliteral">&quot;DFEMDiff2D_Dirichlet&quot;</span>,<span class="stringliteral">&quot;flux&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"> </div>
<div class="line">ffvol = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,OPERATION,OP_AVG)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(ffvol)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(ffvol)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(ffvol)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Avg-value=%.6f&quot;, maxval))</div>
</div><!-- fragment --> </div>

<h3><a id="tests_DFEM_Diffusion_dDiffusion_2D_2b_RobinBCs_lua" name="tests_DFEM_Diffusion_dDiffusion_2D_2b_RobinBCs_lua"></a>tests/DFEM_Diffusion/dDiffusion_2D_2b_RobinBCs.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=40</div>
<div class="line">L=2</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.5,0.5,-0.5,0.5,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line">D = {1.0,5.0}</div>
<div class="line">Q = {0.0,1.0}</div>
<div class="line">XSa = {1.0,1.0}</div>
<div class="line">function D_coef(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> D[i+1] -- + x</div>
<div class="line">end</div>
<div class="line">function Q_ext(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> Q[i+1] -- x*x</div>
<div class="line">end</div>
<div class="line">function Sigma_a(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> XSa[i+1]</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">-- Setboundary IDs</div>
<div class="line">-- xmin_,xmax_,ymin_,ymax_,zmin_,zmax_</div>
<div class="line">e_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,0.99999,1000,-1000,1000,-1000,1000)</div>
<div class="line">w_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,-0.9999,-1000,1000,-1000,1000)</div>
<div class="line">n_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,0.99999,1000,-1000,1000)</div>
<div class="line">s_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,-0.99999,-1000,1000)</div>
<div class="line"> </div>
<div class="line">e_bndry = 0</div>
<div class="line">w_bndry = 1</div>
<div class="line">n_bndry = 2</div>
<div class="line">s_bndry = 3</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,e_vol,e_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,w_vol,w_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,n_vol,n_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,s_vol,s_bndry)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add material properties</span></div>
<div class="line">--#### DFEM solver</div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaa204e0f4273fce1a60a7c95a8925f28b">chiDFEMDiffusionSolverCreate</a>()</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;residual_tolerance&quot;, 1E-8)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga414ccf35e9892e26cd48da62b89489f0">chiDFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,e_bndry,&quot;robin&quot;, 0.25, 0.5, 0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga414ccf35e9892e26cd48da62b89489f0">chiDFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,n_bndry,&quot;reflecting&quot;)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga414ccf35e9892e26cd48da62b89489f0">chiDFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,s_bndry,&quot;reflecting&quot;)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga414ccf35e9892e26cd48da62b89489f0">chiDFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,w_bndry,&quot;robin&quot;, 0.25, 0.5, 0.1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Get field functions</span></div>
<div class="line">fflist,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Export VTU</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chiExportFieldFunctionToVTK</a>(fflist[1],<span class="stringliteral">&quot;DFEMDiff2D_RobinRefl&quot;</span>,<span class="stringliteral">&quot;flux&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"> </div>
<div class="line">ffvol = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,OPERATION,OP_AVG)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(ffvol)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(ffvol)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(ffvol)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Avg-value=%.6f&quot;, maxval))</div>
</div><!-- fragment --> </div>

<h3><a id="tests_DFEM_Diffusion_dDiffusion_2D_3a_analytical_coef_lua" name="tests_DFEM_Diffusion_dDiffusion_2D_3a_analytical_coef_lua"></a>tests/DFEM_Diffusion/dDiffusion_2D_3a_analytical_coef.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=100</div>
<div class="line">L=2</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">function D_coef(i,x,y,z)</div>
<div class="line">    return 3.0 + x + y</div>
<div class="line">end</div>
<div class="line">function Q_ext(i,x,y,z)</div>
<div class="line">    return x*x</div>
<div class="line">end</div>
<div class="line">function Sigma_a(i,x,y,z)</div>
<div class="line">    return x*y*y</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">-- Setboundary IDs</div>
<div class="line">-- xmin_,xmax_,ymin_,ymax_,zmin_,zmax_</div>
<div class="line">e_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,0.99999,1000,-1000,1000,-1000,1000)</div>
<div class="line">w_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,-0.9999,-1000,1000,-1000,1000)</div>
<div class="line">n_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,0.99999,1000,-1000,1000)</div>
<div class="line">s_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,-0.99999,-1000,1000)</div>
<div class="line"> </div>
<div class="line">e_bndry = 0</div>
<div class="line">w_bndry = 1</div>
<div class="line">n_bndry = 2</div>
<div class="line">s_bndry = 3</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,e_vol,e_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,w_vol,w_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,n_vol,n_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,s_vol,s_bndry)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add material properties</span></div>
<div class="line">--#### DFEM solver</div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaa204e0f4273fce1a60a7c95a8925f28b">chiDFEMDiffusionSolverCreate</a>()</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga414ccf35e9892e26cd48da62b89489f0">chiDFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,e_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga414ccf35e9892e26cd48da62b89489f0">chiDFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,w_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga414ccf35e9892e26cd48da62b89489f0">chiDFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,n_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga414ccf35e9892e26cd48da62b89489f0">chiDFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,s_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Get field functions</span></div>
<div class="line">fflist,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Export VTU</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chiExportFieldFunctionToVTK</a>(fflist[1],<span class="stringliteral">&quot;CFEMDiff2D_analytic_coef&quot;</span>,<span class="stringliteral">&quot;flux&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"> </div>
<div class="line">ffvol = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(ffvol)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(ffvol)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(ffvol)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Max-value=%.6f&quot;, maxval))</div>
</div><!-- fragment --> </div>

<h3><a id="tests_DFEM_Diffusion_dDiffusion_2D_3b_analytical_coef2_lua" name="tests_DFEM_Diffusion_dDiffusion_2D_3b_analytical_coef2_lua"></a>tests/DFEM_Diffusion/dDiffusion_2D_3b_analytical_coef2.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=40</div>
<div class="line">L=1</div>
<div class="line">xmin_ = 0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line">-- governing law: -(u_xx + u_yy) = q, on domain [0,1]x[0,1]</div>
<div class="line">-- when the exact solution is chosen u(x,y) = sin(pi.x) * sin(pi.y)</div>
<div class="line">-- <span class="keyword">this</span> automatically gives:</div>
<div class="line">--    boundary = zero-<a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200abac152b762896edff34ed668ae1a546f">Dirichlet</a> on all 4 sides</div>
<div class="line">--    volumetric source term: q(,x) = 2*pi*pi * sin(pi.x) * sin(pi.y)</div>
<div class="line">-- the factor 2 is the dim of the problem</div>
<div class="line">function D_coef(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> 1.0</div>
<div class="line">end</div>
<div class="line">function Q_ext(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> 2.*math.pi*math.pi * math.sin(math.pi*x) * math.sin(math.pi*y)</div>
<div class="line">end</div>
<div class="line">function Sigma_a(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> 0.0</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">-- <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> boundary IDs</div>
<div class="line">-- xmin_,xmax_,ymin_,ymax_,zmin_,zmax_</div>
<div class="line">e_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,0.99999,1000,-1000,1000,-1000,1000)</div>
<div class="line">w_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,0.00001,-1000,1000,-1000,1000)</div>
<div class="line">n_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,0.99999,1000,-1000,1000)</div>
<div class="line">s_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,0.00001,-1000,1000)</div>
<div class="line"> </div>
<div class="line">e_bndry = 0</div>
<div class="line">w_bndry = 1</div>
<div class="line">n_bndry = 2</div>
<div class="line">s_bndry = 3</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,e_vol,e_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,w_vol,w_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,n_vol,n_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,s_vol,s_bndry)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add material properties</span></div>
<div class="line">--#### DFEM solver</div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaa204e0f4273fce1a60a7c95a8925f28b">chiDFEMDiffusionSolverCreate</a>()</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;residual_tolerance&quot;, 1E-8)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga414ccf35e9892e26cd48da62b89489f0">chiDFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,e_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga414ccf35e9892e26cd48da62b89489f0">chiDFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,w_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga414ccf35e9892e26cd48da62b89489f0">chiDFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,n_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga414ccf35e9892e26cd48da62b89489f0">chiDFEMDiffusionSetBCProperty</a>(phys1,&quot;boundary_type&quot;,s_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Get field functions</span></div>
<div class="line">fflist,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Export VTU</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chiExportFieldFunctionToVTK</a>(fflist[1],<span class="stringliteral">&quot;DFEMDiff2D_analytic_coef2&quot;</span>,<span class="stringliteral">&quot;flux&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"> </div>
<div class="line">ffvol = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(ffvol)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(ffvol)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(ffvol)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Max-value=%.6f&quot;, maxval))</div>
</div><!-- fragment --> </div>

<h3><a id="tests_DFEM_Diffusion_dDiffusion_2D_3c_L2_error_MMS_lua" name="tests_DFEM_Diffusion_dDiffusion_2D_3c_L2_error_MMS_lua"></a>tests/DFEM_Diffusion/dDiffusion_2D_3c_L2_error_MMS.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=40</div>
<div class="line">L=1</div>
<div class="line">xmin_ = 0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line">-- governing law: -(u_xx + u_yy) = q, on domain [0,1]x[0,1]</div>
<div class="line">-- when the exact solution is chosen u(x,y) = sin(pi.x) * sin(pi.y)</div>
<div class="line">-- <span class="keyword">this</span> automatically gives:</div>
<div class="line">--    boundary = zero-<a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200abac152b762896edff34ed668ae1a546f">Dirichlet</a> on all 4 sides</div>
<div class="line">--    volumetric source term: q(,x) = 2*pi*pi * sin(pi.x) * sin(pi.y)</div>
<div class="line">-- the factor 2 is the dim of the problem</div>
<div class="line">function D_coef(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> 1.0</div>
<div class="line">end</div>
<div class="line">function Q_ext(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> 2.*math.pi*math.pi * math.sin(math.pi*x) * math.sin(math.pi*y)</div>
<div class="line">end</div>
<div class="line">function Sigma_a(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> 0.0</div>
<div class="line">end</div>
<div class="line">function MMS_phi(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> math.sin(math.pi*x) * math.sin(math.pi*y)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">-- <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> boundary IDs</div>
<div class="line">-- xmin_,xmax_,ymin_,ymax_,zmin_,zmax_</div>
<div class="line">e_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,0.99999,1000,-1000,1000,-1000,1000)</div>
<div class="line">w_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,0.00001,-1000,1000,-1000,1000)</div>
<div class="line">n_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,0.99999,1000,-1000,1000)</div>
<div class="line">s_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,0.00001,-1000,1000)</div>
<div class="line"> </div>
<div class="line">e_bndry = 0</div>
<div class="line">w_bndry = 1</div>
<div class="line">n_bndry = 2</div>
<div class="line">s_bndry = 3</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,e_vol,e_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,w_vol,w_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,n_vol,n_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,s_vol,s_bndry)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Call Lua Sim Test</span></div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a710404d85c5f13265814ad097b4f29cd">chiSimTest_IP_MMS_L2error</a>() --simtest_IP_MMS_L2_handle becomes available here</div>
<div class="line"> </div>
<div class="line">--############################################### Export VTU</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chiExportFieldFunctionToVTK</a>(simtest_IP_MMS_L2_handle,<span class="stringliteral">&quot;DFEMDiff2D_MMS&quot;</span>,<span class="stringliteral">&quot;flux&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">----<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line">--</div>
<div class="line">ffvol = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(ffvol,ADD_FIELDFUNCTION,simtest_IP_MMS_L2_handle)</div>
<div class="line">--</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(ffvol)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(ffvol)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(ffvol)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value=%.6f&quot;</span>, maxval))</div>
<div class="ttc" id="anamespacechi__lua_html_a710404d85c5f13265814ad097b4f29cd"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#a710404d85c5f13265814ad097b4f29cd">chi_lua::chiSimTest_IP_MMS_L2error</a></div><div class="ttdeci">void chiSimTest_IP_MMS_L2error()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00040">lua_functions.c:40</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Diffusion_Diffusion1D_IP_lua" name="tests_Diffusion_Diffusion1D_IP_lua"></a>tests/Diffusion/Diffusion1D_IP.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 1D Diffusion test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200abac152b762896edff34ed668ae1a546f">Dirichlet</a> BCs</div>
<div class="line">-- SMD: PWLD</div>
<div class="line">-- Test: Max-value=0.5006523132</div>
<div class="line">num_procs = 2</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=100</div>
<div class="line">L=2.0</div>
<div class="line">xmin_ = 0.0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#gabcd0e135b1081c3b9eb6661d44fb21d7">chiMeshCreateUnpartitioned1DOrthoMesh</a>(mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gaffef57d848300c3cb87f8ef6c4954b8d">chiVolumeMesherSetupOrthogonalBoundaries</a>()</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[0] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[0],SCALAR_VALUE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[0],SCALAR_VALUE,SINGLE_VALUE,1.0)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaa864dd5fda9e6c05e66e80b2411ccc83">chiDiffusionCreateSolver</a>()</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;discretization_method&quot;,&quot;PWLD_MIP&quot;)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;residual_tolerance&quot;,1.0e-6)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,<span class="stringliteral">&quot;ZMIN&quot;</span>,<span class="stringliteral">&quot;dirichlet&quot;</span>,0.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,&quot;boundary_type&quot;,&quot;ZMAX&quot;,&quot;dirichlet&quot;,0.0)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga4bdfbb9479a366e20aa38967521363fb">chiDiffusionInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaafc0819e34c8bdad070c5b3dcbf25e46">chiDiffusionExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fftemp,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Line plot</div>
<div class="line">line0 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(LINE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_FIRSTPOINT,0.1,0.0,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_SECONDPOINT,0.1,0.0, 2.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_NUMBEROFPOINTS, 100)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(line0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(line0)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Max-value=%.10f&quot;, maxval))</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Exports</span></div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(line0)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Plots</div>
<div class="line"><span class="keywordflow">if</span> ((chi_location_id == 0) and (master_export == nil)) then</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python ZLFFI00.py&quot;</span>)</div>
<div class="line">end</div>
<div class="ttc" id="agroup___lua_diffusion_html_ga4bdfbb9479a366e20aa38967521363fb"><div class="ttname"><a href="../../de/d15/group___lua_diffusion.html#ga4bdfbb9479a366e20aa38967521363fb">chi_lua::chiDiffusionInitialize</a></div><div class="ttdeci">Success chiDiffusionInitialize(int SolverHandle)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l05388">lua_functions.c:5388</a></div></div>
<div class="ttc" id="agroup___lua_diffusion_html_ga6ccf8162a4fd525c1fb520f21cc02050"><div class="ttname"><a href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chi_lua::chiDiffusionSetProperty</a></div><div class="ttdeci">void chiDiffusionSetProperty(int SolverHandle, string PropertyName, varying Values)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l05338">lua_functions.c:5338</a></div></div>
<div class="ttc" id="agroup___lua_diffusion_html_gaa864dd5fda9e6c05e66e80b2411ccc83"><div class="ttname"><a href="../../de/d15/group___lua_diffusion.html#gaa864dd5fda9e6c05e66e80b2411ccc83">chi_lua::chiDiffusionCreateSolver</a></div><div class="ttdeci">Handle chiDiffusionCreateSolver()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l05363">lua_functions.c:5363</a></div></div>
<div class="ttc" id="agroup___lua_diffusion_html_gaafc0819e34c8bdad070c5b3dcbf25e46"><div class="ttname"><a href="../../de/d15/group___lua_diffusion.html#gaafc0819e34c8bdad070c5b3dcbf25e46">chi_lua::chiDiffusionExecute</a></div><div class="ttdeci">Success chiDiffusionExecute(int SolverHandle)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l05413">lua_functions.c:5413</a></div></div>
<div class="ttc" id="agroup___lua_mesh_macros_html_gabcd0e135b1081c3b9eb6661d44fb21d7"><div class="ttname"><a href="../../d9/db8/group___lua_mesh_macros.html#gabcd0e135b1081c3b9eb6661d44fb21d7">chi_lua::chiMeshCreateUnpartitioned1DOrthoMesh</a></div><div class="ttdeci">Two chiMeshCreateUnpartitioned1DOrthoMesh(array_float x_nodes)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l01630">lua_functions.c:1630</a></div></div>
<div class="ttc" id="agroup___lua_volume_mesher_html_gaffef57d848300c3cb87f8ef6c4954b8d"><div class="ttname"><a href="../../d4/d3a/group___lua_volume_mesher.html#gaffef57d848300c3cb87f8ef6c4954b8d">chi_lua::chiVolumeMesherSetupOrthogonalBoundaries</a></div><div class="ttdeci">void chiVolumeMesherSetupOrthogonalBoundaries()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l01934">lua_functions.c:1934</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Diffusion_Diffusion1D_KBA_lua" name="tests_Diffusion_Diffusion1D_KBA_lua"></a>tests/Diffusion/Diffusion1D_KBA.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 1D Diffusion test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> BCs.</div>
<div class="line">-- SDM: PWLC</div>
<div class="line">-- Test: Max-value=2.50000</div>
<div class="line">num_procs = 2</div>
<div class="line">-- KBA-partitioning</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=100</div>
<div class="line">L=2.0</div>
<div class="line">xmin_ = 0.0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#gabcd0e135b1081c3b9eb6661d44fb21d7">chiMeshCreateUnpartitioned1DOrthoMesh</a>(mesh)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">PARTITION_TYPE</a>,KBA_STYLE_XYZ)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gadf7998a2c7070f92f69803f071dd5b2d">chiVolumeMesherSetKBACutsZ</a>({L/2})</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga84f96adcccf43678b5b94285a2291e66">chiVolumeMesherSetKBAPartitioningPxPyPz</a>(1,1,2)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set Material IDs</span></div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gaffef57d848300c3cb87f8ef6c4954b8d">chiVolumeMesherSetupOrthogonalBoundaries</a>()</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[0] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[0],SCALAR_VALUE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[0],SCALAR_VALUE,SINGLE_VALUE,1.0)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaa864dd5fda9e6c05e66e80b2411ccc83">chiDiffusionCreateSolver</a>();</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,<span class="stringliteral">&quot;discretization_method&quot;</span>,<span class="stringliteral">&quot;PWLC&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;residual_tolerance&quot;,1.0e-4)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,&quot;boundary_type&quot;,&quot;ZMIN&quot;,&quot;vacuum&quot;)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,&quot;boundary_type&quot;,&quot;ZMAX&quot;,&quot;vacuum&quot;)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga4bdfbb9479a366e20aa38967521363fb">chiDiffusionInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaafc0819e34c8bdad070c5b3dcbf25e46">chiDiffusionExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fftemp,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Line plot</div>
<div class="line">ffi0 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(LINE)</div>
<div class="line">curffi = ffi0;</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LINE_FIRSTPOINT,0.0,0.0,0.0+xmin_)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LINE_SECONDPOINT,0.0,0.0, 2.0+xmin_)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LINE_NUMBEROFPOINTS, 1000)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Max-value=%.5f&quot;, maxval))</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Exports</span></div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(ffi0)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line"> </div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python ZLFFI00.py&quot;</span>)</div>
<div class="line">end</div>
<div class="ttc" id="agroup___lua_volume_mesher_html_gadf7998a2c7070f92f69803f071dd5b2d"><div class="ttname"><a href="../../d4/d3a/group___lua_volume_mesher.html#gadf7998a2c7070f92f69803f071dd5b2d">chi_lua::chiVolumeMesherSetKBACutsZ</a></div><div class="ttdeci">void chiVolumeMesherSetKBACutsZ()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l02146">lua_functions.c:2146</a></div></div>
<div class="ttc" id="anamespacecfem__diffusion_html_a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10"><div class="ttname"><a href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">cfem_diffusion::BoundaryType::Vacuum</a></div><div class="ttdeci">@ Vacuum</div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Diffusion_Diffusion1D_lua" name="tests_Diffusion_Diffusion1D_lua"></a>tests/Diffusion/Diffusion1D.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 1D Diffusion test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> BCs.</div>
<div class="line">-- SDM: PWLC</div>
<div class="line">-- Test: Max-value=2.50000</div>
<div class="line">num_procs = 1</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=100</div>
<div class="line">L=2.0</div>
<div class="line">xmin_ = 0.0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#gabcd0e135b1081c3b9eb6661d44fb21d7">chiMeshCreateUnpartitioned1DOrthoMesh</a>(mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gaffef57d848300c3cb87f8ef6c4954b8d">chiVolumeMesherSetupOrthogonalBoundaries</a>()</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[0] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[0],SCALAR_VALUE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[0],SCALAR_VALUE,SINGLE_VALUE,1.0)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaa864dd5fda9e6c05e66e80b2411ccc83">chiDiffusionCreateSolver</a>();</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,<span class="stringliteral">&quot;discretization_method&quot;</span>,<span class="stringliteral">&quot;PWLC&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;residual_tolerance&quot;,1.0e-4)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,<span class="stringliteral">&quot;ZMIN&quot;</span>,<span class="stringliteral">&quot;vacuum&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,&quot;boundary_type&quot;,&quot;ZMAX&quot;,&quot;vacuum&quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga4bdfbb9479a366e20aa38967521363fb">chiDiffusionInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaafc0819e34c8bdad070c5b3dcbf25e46">chiDiffusionExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fftemp,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Line plot</div>
<div class="line">ffi0 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(LINE)</div>
<div class="line">curffi = ffi0;</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LINE_FIRSTPOINT,0.0,0.0,0.0+xmin_)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LINE_SECONDPOINT,0.0,0.0, 2.0+xmin_)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LINE_NUMBEROFPOINTS, 1000)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Max-value=%.5f&quot;, maxval))</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Exports</span></div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(ffi0)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Plots</div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python ZLFFI00.py&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Diffusion_Diffusion2D_1Poly_IP_lua" name="tests_Diffusion_Diffusion2D_1Poly_IP_lua"></a>tests/Diffusion/Diffusion2D_1Poly_IP.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Diffusion test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a9ee62873f779acffc647988768156e29">Reflecting</a> BCs.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=2.50000</div>
<div class="line">num_procs = 4</div>
<div class="line">--Also tests integrating with a lua-function</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=32</div>
<div class="line">L=2.0</div>
<div class="line">xmin_ = -1.0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">e_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,0.99999,1000,-1000,1000,-1000,1000)</div>
<div class="line">w_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,-0.99999,-1000,1000,-1000,1000)</div>
<div class="line">n_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,0.99999,1000,-1000,1000)</div>
<div class="line">s_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,-0.99999,-1000,1000)</div>
<div class="line"> </div>
<div class="line">--e_bndry = chiRegionAddEmptyBoundary(region1);</div>
<div class="line">--w_bndry = chiRegionAddEmptyBoundary(region1);</div>
<div class="line">--n_bndry = chiRegionAddEmptyBoundary(region1);</div>
<div class="line">--s_bndry = chiRegionAddEmptyBoundary(region1);</div>
<div class="line"> </div>
<div class="line">e_bndry = &quot;0&quot;</div>
<div class="line">w_bndry = &quot;1&quot;</div>
<div class="line">n_bndry = &quot;2&quot;</div>
<div class="line">s_bndry = &quot;3&quot;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,e_vol,e_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,w_vol,w_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,n_vol,n_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,s_vol,s_bndry)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[0] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[0],SCALAR_VALUE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[0],SCALAR_VALUE,SINGLE_VALUE,1.0)</div>
<div class="line"> </div>
<div class="line">prop = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc17967cd72687d326d2f59017e90636">chiPhysicsMaterialGetProperty</a>(materials[0],SCALAR_VALUE)</div>
<div class="line">if ((prop.is_empty ~=nil) and (not prop.is_empty)) then</div>
<div class="line">    print(&quot;<a class="code hl_enumeration" href="../../da/db4/namespacechi__mesh_1_1ff__interpolation.html#a49f92e14e4f4b59f46f7a0ba141f355a">Property</a> table populated, value=&quot;..tostring(prop.value))</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Setup Physics</span></div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaa864dd5fda9e6c05e66e80b2411ccc83">chiDiffusionCreateSolver</a>()</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;discretization_method&quot;,&quot;PWLD_MIP&quot;)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;residual_tolerance&quot;,1.0e-8)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,e_bndry,<span class="stringliteral">&quot;vacuum&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,&quot;boundary_type&quot;,w_bndry,&quot;vacuum&quot;)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,&quot;boundary_type&quot;,n_bndry,&quot;reflecting&quot;)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,&quot;boundary_type&quot;,s_bndry,&quot;reflecting&quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga4bdfbb9479a366e20aa38967521363fb">chiDiffusionInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaafc0819e34c8bdad070c5b3dcbf25e46">chiDiffusionExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fftemp,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">slice2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,SLICE_POINT,0.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice2)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice2)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value=%.5f&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--==========================================</div>
<div class="line">xwing=2.0</div>
<div class="line">function IntegrateMaterialVolume(ff_value,mat_id)</div>
<div class="line">    <span class="keywordflow">return</span> xwing</div>
<div class="line">end</div>
<div class="line">ffi2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi2</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_SUM_LUA,<span class="stringliteral">&quot;IntegrateMaterialVolume&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">print(<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi))</div>
<div class="line">--==========================================</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Exports</span></div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice2)</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chiExportFieldFunctionToVTK</a>(fftemp,<span class="stringliteral">&quot;ZPhi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">end</div>
<div class="ttc" id="agroup___lua_physics_materials_html_gafc17967cd72687d326d2f59017e90636"><div class="ttname"><a href="../../d7/d11/group___lua_physics_materials.html#gafc17967cd72687d326d2f59017e90636">chi_lua::chiPhysicsMaterialGetProperty</a></div><div class="ttdeci">Lua chiPhysicsMaterialGetProperty(int MaterialHandle, int PropertyIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00913">lua_functions.c:913</a></div></div>
<div class="ttc" id="anamespacecfem__diffusion_html_a231772ce90e37a7ba9331c9194a99200a9ee62873f779acffc647988768156e29"><div class="ttname"><a href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a9ee62873f779acffc647988768156e29">cfem_diffusion::BoundaryType::Reflecting</a></div><div class="ttdeci">@ Reflecting</div></div>
<div class="ttc" id="anamespacechi__mesh_1_1ff__interpolation_html_a49f92e14e4f4b59f46f7a0ba141f355a"><div class="ttname"><a href="../../da/db4/namespacechi__mesh_1_1ff__interpolation.html#a49f92e14e4f4b59f46f7a0ba141f355a">chi_mesh::ff_interpolation::Property</a></div><div class="ttdeci">Property</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d18/chi__ffinterpolation_8h_source.html#l00033">chi_ffinterpolation.h:34</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Diffusion_Diffusion2D_1Poly_lua" name="tests_Diffusion_Diffusion2D_1Poly_lua"></a>tests/Diffusion/Diffusion2D_1Poly.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Diffusion test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200abac152b762896edff34ed668ae1a546f">Dirichlet</a> BCs.</div>
<div class="line">-- SDM: PWLC</div>
<div class="line">-- Test: Max-value=0.29480</div>
<div class="line">num_procs = 1</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=32</div>
<div class="line">L=2.0</div>
<div class="line">xmin_ = -1.0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[0] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[0],SCALAR_VALUE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[0],SCALAR_VALUE,SINGLE_VALUE,1.0)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaa864dd5fda9e6c05e66e80b2411ccc83">chiDiffusionCreateSolver</a>()</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;discretization_method&quot;,&quot;PWLC&quot;)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;residual_tolerance&quot;,1.0e-4)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">--<a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,0,<span class="stringliteral">&quot;reflecting&quot;</span>,1.0)</div>
<div class="line">--<a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,1,<span class="stringliteral">&quot;vacuum&quot;</span>,2.0)</div>
<div class="line">--<a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,2,<span class="stringliteral">&quot;reflecting&quot;</span>,3.0)</div>
<div class="line">--<a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,3,<span class="stringliteral">&quot;vacuum&quot;</span>,4.0)</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga4bdfbb9479a366e20aa38967521363fb">chiDiffusionInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaafc0819e34c8bdad070c5b3dcbf25e46">chiDiffusionExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fftemp,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">slice2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,SLICE_POINT,0.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice2)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice2)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Line plot</span></div>
<div class="line">line0 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(LINE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_FIRSTPOINT,-1.0,0.1,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_SECONDPOINT, 1.0,0.1,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_NUMBEROFPOINTS, 100)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(line0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(line0)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value=%.5f&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice2)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(line0)</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chiExportFieldFunctionToVTK</a>(fftemp,<span class="stringliteral">&quot;ZPhi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python3 ZPFFI00.py&quot;</span>)</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python3 ZLFFI10.py&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Diffusion_Diffusion2D_2Unstructured_IP_lua" name="tests_Diffusion_Diffusion2D_2Unstructured_IP_lua"></a>tests/Diffusion/Diffusion2D_2Unstructured_IP.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Diffusion test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200abac152b762896edff34ed668ae1a546f">Dirichlet</a> BCs.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.29685</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">umesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga0f476b765a307ec7a477c237134298c2">chiUnpartitionedMeshFromWavefrontOBJ</a>(&quot;resources/TestMeshes/TriangleMesh2x2.obj&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED,umesh)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>()</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>()</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set Material IDs</span></div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gaffef57d848300c3cb87f8ef6c4954b8d">chiVolumeMesherSetupOrthogonalBoundaries</a>()</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[0] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[0],SCALAR_VALUE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[0],SCALAR_VALUE,SINGLE_VALUE,1.0)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaa864dd5fda9e6c05e66e80b2411ccc83">chiDiffusionCreateSolver</a>()</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;discretization_method&quot;,&quot;PWLD_MIP&quot;)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;residual_tolerance&quot;,1.0e-6)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">--<a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,0,<span class="stringliteral">&quot;reflecting&quot;</span>,1.0)</div>
<div class="line">--<a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,1,<span class="stringliteral">&quot;vacuum&quot;</span>,2.0)</div>
<div class="line">--<a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,2,<span class="stringliteral">&quot;reflecting&quot;</span>,3.0)</div>
<div class="line">--<a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,3,<span class="stringliteral">&quot;vacuum&quot;</span>,4.0)</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga4bdfbb9479a366e20aa38967521363fb">chiDiffusionInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaafc0819e34c8bdad070c5b3dcbf25e46">chiDiffusionExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fftemp,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">slice2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,SLICE_POINT,0.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice2)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice2)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Line plot</span></div>
<div class="line">line0 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(LINE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_FIRSTPOINT,-1.0,0.01,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_SECONDPOINT, 1.0,0.01,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_NUMBEROFPOINTS, 100)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(line0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(line0)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value=%.5f&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice2)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(line0)</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chiExportFieldFunctionToVTK</a>(fftemp,<span class="stringliteral">&quot;ZPhi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"><span class="keywordflow">if</span> ((master_export == nil) and (chi_location_id == 0)) then</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python3 ZPFFI00.py&quot;</span>)</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python3 ZLFFI10.py&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Diffusion_Diffusion2D_2Unstructured_lua" name="tests_Diffusion_Diffusion2D_2Unstructured_lua"></a>tests/Diffusion/Diffusion2D_2Unstructured.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Diffusion test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200abac152b762896edff34ed668ae1a546f">Dirichlet</a> BCs.</div>
<div class="line">-- SDM: PWLC</div>
<div class="line">-- Test: Max-value=0.30384</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">umesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga0f476b765a307ec7a477c237134298c2">chiUnpartitionedMeshFromWavefrontOBJ</a>(&quot;resources/TestMeshes/TriangleMesh2x2.obj&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED,umesh)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>()</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>()</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set Material IDs</span></div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gaffef57d848300c3cb87f8ef6c4954b8d">chiVolumeMesherSetupOrthogonalBoundaries</a>()</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[0] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[0],SCALAR_VALUE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[0],SCALAR_VALUE,SINGLE_VALUE,1.0)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaa864dd5fda9e6c05e66e80b2411ccc83">chiDiffusionCreateSolver</a>()</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;discretization_method&quot;,&quot;PWLC&quot;)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;residual_tolerance&quot;,1.0e-6)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">--<a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,0,<span class="stringliteral">&quot;reflecting&quot;</span>,1.0)</div>
<div class="line">--<a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,1,<span class="stringliteral">&quot;vacuum&quot;</span>,2.0)</div>
<div class="line">--<a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,2,<span class="stringliteral">&quot;reflecting&quot;</span>,3.0)</div>
<div class="line">--<a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,3,<span class="stringliteral">&quot;vacuum&quot;</span>,4.0)</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga4bdfbb9479a366e20aa38967521363fb">chiDiffusionInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaafc0819e34c8bdad070c5b3dcbf25e46">chiDiffusionExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fftemp,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">slice2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,SLICE_POINT,0.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice2)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice2)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Line plot</span></div>
<div class="line">line0 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(LINE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_FIRSTPOINT,-1.0,0.01,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_SECONDPOINT, 1.0,0.01,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_NUMBEROFPOINTS, 100)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(line0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(line0)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value=%.5f&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice2)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(line0)</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chiExportFieldFunctionToVTK</a>(fftemp,<span class="stringliteral">&quot;ZPhi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"><span class="keywordflow">if</span> ((master_export == nil) and (chi_location_id == 0)) then</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python3 ZPFFI00.py&quot;</span>)</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python3 ZLFFI10.py&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Diffusion_Diffusion3D_1Poly_IP_lua" name="tests_Diffusion_Diffusion3D_1Poly_IP_lua"></a>tests/Diffusion/Diffusion3D_1Poly_IP.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 3D Diffusion test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200abac152b762896edff34ed668ae1a546f">Dirichlet</a> and <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a9ee62873f779acffc647988768156e29">Reflecting</a> BCs.</div>
<div class="line">-- SDM: PWLC</div>
<div class="line">-- Test: Max-value=0.29492</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=32</div>
<div class="line">L=2.0</div>
<div class="line">xmin_ = -1.0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line">zmesh={}</div>
<div class="line"><span class="keywordflow">for</span> i=1,11 <span class="keywordflow">do</span></div>
<div class="line">    zmesh[i] = 0.0 + (i-1)*0.2/10</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga12dcd80ee2ab6104ba6e7142d7885221">chiMeshCreateUnpartitioned3DOrthoMesh</a>(mesh,mesh,zmesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gaffef57d848300c3cb87f8ef6c4954b8d">chiVolumeMesherSetupOrthogonalBoundaries</a>()</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[0] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[0],SCALAR_VALUE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[0],SCALAR_VALUE,SINGLE_VALUE,1.0)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaa864dd5fda9e6c05e66e80b2411ccc83">chiDiffusionCreateSolver</a>()</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;discretization_method&quot;,&quot;PWLD_MIP&quot;)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;residual_tolerance&quot;,1.0e-6)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,<span class="stringliteral">&quot;ZMIN&quot;</span>,<span class="stringliteral">&quot;reflecting&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,&quot;boundary_type&quot;,&quot;ZMAX&quot;,&quot;reflecting&quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga4bdfbb9479a366e20aa38967521363fb">chiDiffusionInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaafc0819e34c8bdad070c5b3dcbf25e46">chiDiffusionExecute</a>(phys1)</div>
<div class="line">--</div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">slice1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_POINT,0.008,0.0,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_BINORM,0.0,0.0,1.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_TANGENT,0.0,-1.0,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_NORMAL,1.0,0.0,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice1)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice1)</div>
<div class="line"> </div>
<div class="line">slice2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,SLICE_POINT,0.0,0.0,0.024)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice2)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice2)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Line plot</span></div>
<div class="line">line0 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(LINE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_FIRSTPOINT,-1.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_SECONDPOINT, 1.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_NUMBEROFPOINTS, 100)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(line0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(line0)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value=%.5f&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice1)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice2)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(line0)</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chiExportFieldFunctionToVTK</a>(fflist[1],<span class="stringliteral">&quot;ZPhi3D&quot;</span>,<span class="stringliteral">&quot;Temperature&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python ZPFFI10.py&quot;</span>)</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python ZLFFI20.py&quot;</span>)</div>
<div class="line">    print(<span class="stringliteral">&quot;Execution completed&quot;</span>)</div>
<div class="line">end</div>
<div class="ttc" id="agroup___lua_mesh_macros_html_ga12dcd80ee2ab6104ba6e7142d7885221"><div class="ttname"><a href="../../d9/db8/group___lua_mesh_macros.html#ga12dcd80ee2ab6104ba6e7142d7885221">chi_lua::chiMeshCreateUnpartitioned3DOrthoMesh</a></div><div class="ttdeci">Two chiMeshCreateUnpartitioned3DOrthoMesh(array_float x_nodes, array_float y_nodes, array_float z_nodes)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l01751">lua_functions.c:1751</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Diffusion_Diffusion3D_1Poly_lua" name="tests_Diffusion_Diffusion3D_1Poly_lua"></a>tests/Diffusion/Diffusion3D_1Poly.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 3D Diffusion test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200abac152b762896edff34ed668ae1a546f">Dirichlet</a> and <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a9ee62873f779acffc647988768156e29">Reflecting</a> BCs.</div>
<div class="line">-- SDM: PWLC</div>
<div class="line">-- Test: Max-value=0.29480</div>
<div class="line">num_procs = 1</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=32</div>
<div class="line">L=2.0</div>
<div class="line">xmin_ = -1.0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga12dcd80ee2ab6104ba6e7142d7885221">chiMeshCreateUnpartitioned3DOrthoMesh</a>(mesh,mesh,{0.0,0.1,0.2})</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gaffef57d848300c3cb87f8ef6c4954b8d">chiVolumeMesherSetupOrthogonalBoundaries</a>()</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[0] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[0],SCALAR_VALUE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[0],SCALAR_VALUE,SINGLE_VALUE,1.0)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaa864dd5fda9e6c05e66e80b2411ccc83">chiDiffusionCreateSolver</a>();</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,<span class="stringliteral">&quot;discretization_method&quot;</span>,<span class="stringliteral">&quot;PWLC&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;residual_tolerance&quot;,1.0e-6)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,<span class="stringliteral">&quot;ZMIN&quot;</span>,<span class="stringliteral">&quot;reflecting&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,&quot;boundary_type&quot;,&quot;ZMAX&quot;,&quot;reflecting&quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga4bdfbb9479a366e20aa38967521363fb">chiDiffusionInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaafc0819e34c8bdad070c5b3dcbf25e46">chiDiffusionExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fftemp,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">slice1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line">--<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_POINT,0.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_POINT,0.008,0.0,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_BINORM,0.0,0.0,1.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_TANGENT,0.0,-1.0,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_NORMAL,1.0,0.0,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice1)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice1)</div>
<div class="line"> </div>
<div class="line">slice2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,SLICE_POINT,0.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice2)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice2)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Line plot</span></div>
<div class="line">line0 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(LINE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_FIRSTPOINT,-1.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_SECONDPOINT, 1.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_NUMBEROFPOINTS, 100)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(line0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(line0)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value=%.5f&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice1)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice2)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(line0)</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chiExportFieldFunctionToVTK</a>(fftemp,<span class="stringliteral">&quot;ZPhi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python3 ZPFFI00.py&quot;</span>)</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python3 ZPFFI10.py&quot;</span>)</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python3 ZLFFI20.py&quot;</span>)</div>
<div class="line">    print(<span class="stringliteral">&quot;Execution completed&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Diffusion_Diffusion3D_2Ortho_lua" name="tests_Diffusion_Diffusion3D_2Ortho_lua"></a>tests/Diffusion/Diffusion3D_2Ortho.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 3D Diffusion test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200abac152b762896edff34ed668ae1a546f">Dirichlet</a> and <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a9ee62873f779acffc647988768156e29">Reflecting</a> BCs.</div>
<div class="line">-- SDM: PWLC</div>
<div class="line">-- Test: Max-value=0.29480</div>
<div class="line">num_procs = 1</div>
<div class="line">-- Uses extruder mesh</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">L=2.0</div>
<div class="line">N=32</div>
<div class="line">ds=L/N</div>
<div class="line">xmesh={}</div>
<div class="line"><span class="keywordflow">for</span> k=0,N <span class="keywordflow">do</span></div>
<div class="line">    xmesh[k+1] = -1.0 + ds*k</div>
<div class="line">end</div>
<div class="line">umesh = <a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(xmesh,xmesh);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_EXTRUDER,</div>
<div class="line">                      ExtruderTemplateType.UNPARTITIONED_MESH,</div>
<div class="line">                      umesh);</div>
<div class="line"> </div>
<div class="line">NZ=2</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2,NZ,<span class="stringliteral">&quot;Charlie&quot;</span>);</div>
<div class="line">--<a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2,NZ,<span class="stringliteral">&quot;Charlie&quot;</span>);</div>
<div class="line">--<a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2,NZ,<span class="stringliteral">&quot;Charlie&quot;</span>);</div>
<div class="line">--<a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2,NZ,<span class="stringliteral">&quot;Charlie&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">PARTITION_TYPE</a>,KBA_STYLE_XYZ)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gaffef57d848300c3cb87f8ef6c4954b8d">chiVolumeMesherSetupOrthogonalBoundaries</a>()</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[0] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[0],SCALAR_VALUE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[0],SCALAR_VALUE,SINGLE_VALUE,1.0)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaa864dd5fda9e6c05e66e80b2411ccc83">chiDiffusionCreateSolver</a>()</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;discretization_method&quot;,&quot;PWLC&quot;)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;residual_tolerance&quot;,1.0e-6)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,<span class="stringliteral">&quot;ZMIN&quot;</span>,<span class="stringliteral">&quot;reflecting&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,&quot;boundary_type&quot;,&quot;ZMAX&quot;,&quot;reflecting&quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga4bdfbb9479a366e20aa38967521363fb">chiDiffusionInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaafc0819e34c8bdad070c5b3dcbf25e46">chiDiffusionExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fftemp,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">slice1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_POINT,0.008,0.0,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_BINORM,0.0,0.0,1.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_TANGENT,0.0,-1.0,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_NORMAL,1.0,0.0,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice1)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice1)</div>
<div class="line"> </div>
<div class="line">slice2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,SLICE_POINT,0.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice2)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice2)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Line plot</span></div>
<div class="line">line0 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(LINE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_FIRSTPOINT,-1.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_SECONDPOINT, 1.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_NUMBEROFPOINTS, 100)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(line0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(line0)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value=%.5f&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice1)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice2)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(line0)</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chiExportFieldFunctionToVTK</a>(fftemp,<span class="stringliteral">&quot;ZPhi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python3 ZPFFI00.py&quot;</span>)</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python3 ZPFFI10.py&quot;</span>)</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python3 ZLFFI20.py&quot;</span>)</div>
<div class="line">    print(<span class="stringliteral">&quot;Execution completed&quot;</span>)</div>
<div class="line">end</div>
<div class="ttc" id="anamespacechi__mesh_html_a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5"><div class="ttname"><a href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">chi_mesh::EXTRUSION_LAYER</a></div><div class="ttdeci">@ EXTRUSION_LAYER</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcb/chi__volumemesher_8h_source.html#l00030">chi_volumemesher.h:30</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Diffusion_Diffusion3D_3Unstructured_IP_lua" name="tests_Diffusion_Diffusion3D_3Unstructured_IP_lua"></a>tests/Diffusion/Diffusion3D_3Unstructured_IP.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 3D Diffusion test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200abac152b762896edff34ed668ae1a546f">Dirichlet</a> and <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a9ee62873f779acffc647988768156e29">Reflecting</a> BCs.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.29632</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">unpart_mesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga0f476b765a307ec7a477c237134298c2">chiUnpartitionedMeshFromWavefrontOBJ</a>(</div>
<div class="line">                &quot;resources/TestMeshes/TriangleMesh2x2.obj&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_EXTRUDER,</div>
<div class="line">                      ExtruderTemplateType.UNPARTITIONED_MESH,</div>
<div class="line">                      unpart_mesh);</div>
<div class="line"> </div>
<div class="line">NZ=2</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2,NZ,&quot;Charlie&quot;);</div>
<div class="line">--<a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2,NZ,&quot;Charlie&quot;);</div>
<div class="line">--<a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2,NZ,&quot;Charlie&quot;);</div>
<div class="line">--<a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2,NZ,&quot;Charlie&quot;);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">PARTITION_TYPE</a>,KBA_STYLE_XYZ)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga84f96adcccf43678b5b94285a2291e66">chiVolumeMesherSetKBAPartitioningPxPyPz</a>(2,2,1)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga2048d69a09e224f5daf0ff4e6c4404e4">chiVolumeMesherSetKBACutsX</a>({0.0})</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gae5015130ffe27744255aa29b3e704eb7">chiVolumeMesherSetKBACutsY</a>({0.0})</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gaffef57d848300c3cb87f8ef6c4954b8d">chiVolumeMesherSetupOrthogonalBoundaries</a>()</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[0] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[0],SCALAR_VALUE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[0],SCALAR_VALUE,SINGLE_VALUE,1.0)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaa864dd5fda9e6c05e66e80b2411ccc83">chiDiffusionCreateSolver</a>()</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;discretization_method&quot;,&quot;PWLD_MIP&quot;)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;residual_tolerance&quot;,1.0e-6)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,<span class="stringliteral">&quot;ZMIN&quot;</span>,<span class="stringliteral">&quot;reflecting&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,&quot;boundary_type&quot;,&quot;ZMAX&quot;,&quot;reflecting&quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga4bdfbb9479a366e20aa38967521363fb">chiDiffusionInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaafc0819e34c8bdad070c5b3dcbf25e46">chiDiffusionExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fftemp,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">slice1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_POINT,0.008,0.0,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_BINORM,0.0,0.0,1.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_TANGENT,0.0,-1.0,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_NORMAL,1.0,0.0,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice1)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice1)</div>
<div class="line"> </div>
<div class="line">slice2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,SLICE_POINT,0.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice2)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice2)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Line plot</span></div>
<div class="line">line0 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(LINE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_FIRSTPOINT,-1.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_SECONDPOINT, 1.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_NUMBEROFPOINTS, 100)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(line0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(line0)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value=%.5f&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice1)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice2)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(line0)</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chiExportFieldFunctionToVTK</a>(fftemp,<span class="stringliteral">&quot;ZPhi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python3 ZPFFI00.py&quot;</span>)</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python3 ZPFFI10.py&quot;</span>)</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python3 ZLFFI20.py&quot;</span>)</div>
<div class="line">    print(<span class="stringliteral">&quot;Execution completed&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Diffusion_Diffusion3D_3Unstructured_lua" name="tests_Diffusion_Diffusion3D_3Unstructured_lua"></a>tests/Diffusion/Diffusion3D_3Unstructured.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 3D Diffusion test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200abac152b762896edff34ed668ae1a546f">Dirichlet</a> and <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a9ee62873f779acffc647988768156e29">Reflecting</a> BCs.</div>
<div class="line">-- SDM: PWLC</div>
<div class="line">-- Test: Max-value=0.29499</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">unpart_mesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga0f476b765a307ec7a477c237134298c2">chiUnpartitionedMeshFromWavefrontOBJ</a>(</div>
<div class="line">                &quot;resources/TestMeshes/TriangleMesh2x2.obj&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_EXTRUDER,</div>
<div class="line">                      ExtruderTemplateType.UNPARTITIONED_MESH,</div>
<div class="line">                      unpart_mesh);</div>
<div class="line"> </div>
<div class="line">NZ=2</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2,NZ,&quot;Charlie&quot;);</div>
<div class="line">--<a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2,NZ,&quot;Charlie&quot;);</div>
<div class="line">--<a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2,NZ,&quot;Charlie&quot;);</div>
<div class="line">--<a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2,NZ,&quot;Charlie&quot;);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">PARTITION_TYPE</a>,KBA_STYLE_XYZ)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga84f96adcccf43678b5b94285a2291e66">chiVolumeMesherSetKBAPartitioningPxPyPz</a>(2,2,1)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga2048d69a09e224f5daf0ff4e6c4404e4">chiVolumeMesherSetKBACutsX</a>({0.0})</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gae5015130ffe27744255aa29b3e704eb7">chiVolumeMesherSetKBACutsY</a>({0.0})</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gaffef57d848300c3cb87f8ef6c4954b8d">chiVolumeMesherSetupOrthogonalBoundaries</a>()</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[0] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[0],SCALAR_VALUE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[0],SCALAR_VALUE,SINGLE_VALUE,1.0)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaa864dd5fda9e6c05e66e80b2411ccc83">chiDiffusionCreateSolver</a>()</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;discretization_method&quot;,&quot;PWLC&quot;)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;residual_tolerance&quot;,1.0e-6)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,<span class="stringliteral">&quot;ZMIN&quot;</span>,<span class="stringliteral">&quot;reflecting&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,&quot;boundary_type&quot;,&quot;ZMAX&quot;,&quot;reflecting&quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga4bdfbb9479a366e20aa38967521363fb">chiDiffusionInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaafc0819e34c8bdad070c5b3dcbf25e46">chiDiffusionExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fftemp,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">slice1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_POINT,0.008,0.0,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_BINORM,0.0,0.0,1.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_TANGENT,0.0,-1.0,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_NORMAL,1.0,0.0,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice1)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice1)</div>
<div class="line"> </div>
<div class="line">slice2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,SLICE_POINT,0.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice2)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice2)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Line plot</span></div>
<div class="line">line0 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(LINE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_FIRSTPOINT,-1.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_SECONDPOINT, 1.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_NUMBEROFPOINTS, 100)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(line0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(line0)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fftemp[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value=%.5f&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice1)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice2)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(line0)</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chiExportFieldFunctionToVTK</a>(fftemp,<span class="stringliteral">&quot;ZPhi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python3 ZPFFI00.py&quot;</span>)</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python3 ZPFFI10.py&quot;</span>)</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python3 ZLFFI20.py&quot;</span>)</div>
<div class="line">    print(<span class="stringliteral">&quot;Execution completed&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Diffusion_Diffusion3D_4VTU_lua" name="tests_Diffusion_Diffusion3D_4VTU_lua"></a>tests/Diffusion/Diffusion3D_4VTU.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 3D Diffusion test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200abac152b762896edff34ed668ae1a546f">Dirichlet</a> and <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a9ee62873f779acffc647988768156e29">Reflecting</a> BCs.</div>
<div class="line">-- SDM: PWLC</div>
<div class="line">-- Test: Max-value=0.07373</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga8fd3c77424bb548d492468b2cadc220c">chiUnpartitionedMeshFromVTU</a>(&quot;tests/TestMesh.vtu&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>()</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set Material IDs</span></div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gaffef57d848300c3cb87f8ef6c4954b8d">chiVolumeMesherSetupOrthogonalBoundaries</a>()</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[0] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[0],SCALAR_VALUE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[0],SCALAR_VALUE,SINGLE_VALUE,1.0)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaa864dd5fda9e6c05e66e80b2411ccc83">chiDiffusionCreateSolver</a>()</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;discretization_method&quot;,&quot;PWLD_MIP&quot;)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;residual_tolerance&quot;,1.0e-6)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,<span class="stringliteral">&quot;ZMIN&quot;</span>,<span class="stringliteral">&quot;reflecting&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,&quot;boundary_type&quot;,&quot;ZMAX&quot;,&quot;reflecting&quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga4bdfbb9479a366e20aa38967521363fb">chiDiffusionInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaafc0819e34c8bdad070c5b3dcbf25e46">chiDiffusionExecute</a>(phys1)</div>
<div class="line">--</div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">slice1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_POINT,0.008,0.0,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_BINORM,0.0,0.0,1.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_TANGENT,0.0,-1.0,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,SLICE_NORMAL,1.0,0.0,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice1,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice1)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice1)</div>
<div class="line"> </div>
<div class="line">slice2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,SLICE_POINT,0.0,0.0,0.024)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice2)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice2)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Line plot</span></div>
<div class="line">line0 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(LINE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_FIRSTPOINT,-1.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_SECONDPOINT, 1.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,LINE_NUMBEROFPOINTS, 100)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line0,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(line0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(line0)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value=%.5f&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice1)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice2)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(line0)</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chiExportFieldFunctionToVTK</a>(fflist[1],<span class="stringliteral">&quot;ZPhi3D&quot;</span>,<span class="stringliteral">&quot;Temperature&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python ZPFFI10.py&quot;</span>)</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python ZLFFI20.py&quot;</span>)</div>
<div class="line">    print(<span class="stringliteral">&quot;Execution completed&quot;</span>)</div>
<div class="line">end</div>
<div class="ttc" id="agroup___lua_unpartitioned_mesh_html_ga8fd3c77424bb548d492468b2cadc220c"><div class="ttname"><a href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga8fd3c77424bb548d492468b2cadc220c">chi_lua::chiUnpartitionedMeshFromVTU</a></div><div class="ttdeci">Handle chiUnpartitionedMeshFromVTU(char file_name, char field)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l01306">lua_functions.c:1306</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Diffusion_Test_lua" name="tests_Diffusion_Test_lua"></a>tests/Diffusion/Test.lua</h3><div class="textblock"><div class="fragment"><div class="line">--===================================== Setup physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line">chiSolverAddRegion(phys1,region1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD3D)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad0 = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2, 2)</div>
<div class="line">pquad1 = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,8, 8)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line"> </div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,15)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad0)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,NPT_GMRES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-4)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,30)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="ttc" id="agroup___lua_l_b_s_html_gab469beed321e0c7688d4f537b480f5a6"><div class="ttname"><a href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chi_lua::chiLBSCreateSolver</a></div><div class="ttdeci">SolverHandle chiLBSCreateSolver(string SolverName)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l05021">lua_functions.c:5021</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_FFI_FFI_Diffusion_lua" name="tests_FFI_FFI_Diffusion_lua"></a>tests/FFI/FFI_Diffusion.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=100</div>
<div class="line">L=2</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.5,0.5,-0.5,0.5,-0.5,0.5)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line">D = {1.0,0.01}</div>
<div class="line">Q = {1.0,10.0}</div>
<div class="line">XSa = {1.0,10.0}</div>
<div class="line">function D_coef(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> D[i+1]</div>
<div class="line">end</div>
<div class="line">function Q_ext(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> Q[i+1]</div>
<div class="line">end</div>
<div class="line">function Sigma_a(i,x,y,z)</div>
<div class="line">    <span class="keywordflow">return</span> XSa[i+1]</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">-- Setboundary IDs</div>
<div class="line">-- xmin_,xmax_,ymin_,ymax_,zmin_,zmax_</div>
<div class="line">eps = 1.0e-6</div>
<div class="line">e_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,L/2-eps,1000,-1000,1000,-1000,1000)</div>
<div class="line">w_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,-L/2+eps,-1000,1000,-1000,1000)</div>
<div class="line">n_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,L/2-eps,1000,-1000,1000)</div>
<div class="line">s_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,-L/2+eps,-1000,1000)</div>
<div class="line">t_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,L/2-eps,1000)</div>
<div class="line">b_vol = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,-L/2+eps)</div>
<div class="line"> </div>
<div class="line">e_bndry = 0</div>
<div class="line">w_bndry = 1</div>
<div class="line">n_bndry = 2</div>
<div class="line">s_bndry = 3</div>
<div class="line">t_bndry = 4</div>
<div class="line">b_bndry = 5</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,e_vol,e_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,w_vol,w_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,n_vol,n_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,s_vol,s_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,t_vol,t_bndry)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7f91a4d4b8e9e23a94dfdc882c363285">BNDRYID_FROMLOGICAL</a>,b_vol,b_bndry)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add material properties</span></div>
<div class="line">print(solver)</div>
<div class="line"><span class="keywordflow">if</span> (solver == nil) then solver = <span class="stringliteral">&quot;CFEM&quot;</span> end</div>
<div class="line"> </div>
<div class="line">DiffusionSolverCreate = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga3ba95dae1e7a304f4c3e97eda855625d">chiCFEMDiffusionSolverCreate</a></div>
<div class="line">DiffusionSetBCProperty = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga5331d5d64e47705f13438030332354d0">chiCFEMDiffusionSetBCProperty</a></div>
<div class="line"><span class="keywordflow">if</span> (solver == <span class="stringliteral">&quot;DFEM&quot;</span>) then</div>
<div class="line">    DiffusionSolverCreate = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaa204e0f4273fce1a60a7c95a8925f28b">chiDFEMDiffusionSolverCreate</a></div>
<div class="line">    DiffusionSetBCProperty = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga414ccf35e9892e26cd48da62b89489f0">chiDFEMDiffusionSetBCProperty</a></div>
<div class="line">elseif (solver == <span class="stringliteral">&quot;FV&quot;</span>) then</div>
<div class="line">    DiffusionSolverCreate = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga7afd072a93defa6bb3539bd97747c723">chiFVDiffusionSolverCreate</a></div>
<div class="line">    DiffusionSetBCProperty = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga979b8f3f2997daddf4ada933aaa3811e">chiFVDiffusionSetBCProperty</a></div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">phys1 = DiffusionSolverCreate()</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;residual_tolerance&quot;, 1E-8)</div>
<div class="line"> </div>
<div class="line">DiffusionSetBCProperty(phys1,&quot;boundary_type&quot;,e_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line">DiffusionSetBCProperty(phys1,&quot;boundary_type&quot;,w_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line">DiffusionSetBCProperty(phys1,&quot;boundary_type&quot;,n_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line">DiffusionSetBCProperty(phys1,&quot;boundary_type&quot;,s_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line">DiffusionSetBCProperty(phys1,&quot;boundary_type&quot;,t_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line">DiffusionSetBCProperty(phys1,&quot;boundary_type&quot;,b_bndry,&quot;dirichlet&quot;,0.0)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">----<span class="preprocessor">############################################### Visualize the field function</span></div>
<div class="line">fflist,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chiExportMultiFieldFunctionToVTK</a>({fflist[1]},solver..<span class="stringliteral">&quot;Diff2D_Dirichlet&quot;</span>)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">slice2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,SLICE_POINT,0.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice2)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice2)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice2)</div>
<div class="line"> </div>
<div class="line">local handle = io.popen(&quot;python ZPFFI00.py&quot;)</div>
<div class="ttc" id="agroup___lua_diffusion_html_ga7afd072a93defa6bb3539bd97747c723"><div class="ttname"><a href="../../de/d15/group___lua_diffusion.html#ga7afd072a93defa6bb3539bd97747c723">chi_lua::chiFVDiffusionSolverCreate</a></div><div class="ttdeci">Handle chiFVDiffusionSolverCreate(string solver_name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l05499">lua_functions.c:5499</a></div></div>
<div class="ttc" id="agroup___lua_diffusion_html_ga979b8f3f2997daddf4ada933aaa3811e"><div class="ttname"><a href="../../de/d15/group___lua_diffusion.html#ga979b8f3f2997daddf4ada933aaa3811e">chi_lua::chiFVDiffusionSetBCProperty</a></div><div class="ttdeci">void chiFVDiffusionSetBCProperty(int SolverHandle, string PropertyName, varying Values)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l05551">lua_functions.c:5551</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_HarmonicsTest_HarmonicsTest1_lua" name="tests_HarmonicsTest_HarmonicsTest1_lua"></a>tests/HarmonicsTest/HarmonicsTest1.lua</h3><div class="textblock"><div class="fragment"><div class="line">print(<span class="stringliteral">&quot;############### Test of orthogonality&quot;</span>)</div>
<div class="line"> </div>
<div class="line">N = 1000</div>
<div class="line">Nt = N</div>
<div class="line">Nv = 2*N</div>
<div class="line"> </div>
<div class="line">dtheta = math.pi/Nt</div>
<div class="line">dvaphi = 2.0*math.pi/Nv</div>
<div class="line"> </div>
<div class="line">ell = 2</div>
<div class="line">m = 1</div>
<div class="line">ellp = 2</div>
<div class="line">mp = 1</div>
<div class="line">intgl = 0.0</div>
<div class="line">for i=0,(Nt-1) do</div>
<div class="line">    theta = dtheta/2.0 + i*dtheta</div>
<div class="line">    for j=0,(Nv-1) do</div>
<div class="line">        vaphi = dvaphi/2.0 + j*dtheta</div>
<div class="line"> </div>
<div class="line">        Y1 = <a class="code hl_function" href="../../d0/d4d/group___lua_math.html#ga1266ad6fd8ac5ff3828c2dbc258d28bd">chiYlm</a>(ell,m,theta,vaphi)</div>
<div class="line">        Y2 = <a class="code hl_function" href="../../d0/d4d/group___lua_math.html#ga1266ad6fd8ac5ff3828c2dbc258d28bd">chiYlm</a>(ellp,mp,theta,vaphi)</div>
<div class="line"> </div>
<div class="line">        intgl = intgl + Y1*Y2*math.sin(theta)*dtheta*dvaphi</div>
<div class="line">    end</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">print(&quot;Integral = &quot;..tostring(intgl))</div>
<div class="line">check = 4.0*math.pi/(2*ell+1)</div>
<div class="line">print(&quot;Check = &quot;..tostring(check))</div>
<div class="line"> </div>
<div class="line">print(&quot;<span class="preprocessor">############### Test of legendre addition theorem&quot;)</span></div>
<div class="line"><span class="preprocessor">value = 0.0</span></div>
<div class="line"><span class="preprocessor">theta = math.pi/3</span></div>
<div class="line"><span class="preprocessor">vaphi = math.pi/3</span></div>
<div class="line"><span class="preprocessor"></span> </div>
<div class="line"><span class="preprocessor">x1 = math.sin(theta)*math.cos(vaphi)</span></div>
<div class="line"><span class="preprocessor">y1 = math.sin(theta)*math.sin(vaphi)</span></div>
<div class="line"><span class="preprocessor">z1 = math.cos(theta)</span></div>
<div class="line"><span class="preprocessor"></span> </div>
<div class="line"><span class="preprocessor">thetap = math.pi/4</span></div>
<div class="line"><span class="preprocessor">vaphip = math.pi/4</span></div>
<div class="line"><span class="preprocessor"></span> </div>
<div class="line"><span class="preprocessor">x2 = math.sin(thetap)*math.cos(vaphip)</span></div>
<div class="line"><span class="preprocessor">y2 = math.sin(thetap)*math.sin(vaphip)</span></div>
<div class="line"><span class="preprocessor">z2 = math.cos(thetap)</span></div>
<div class="line"><span class="preprocessor"></span> </div>
<div class="line"><span class="preprocessor">mu = x1*x2 + y1*y2 + z1*z2</span></div>
<div class="line"><span class="preprocessor"></span> </div>
<div class="line"><span class="preprocessor">for m=(-ell),ell do</span></div>
<div class="line"><span class="preprocessor">    value = value + chiYlm(ell,m,theta,vaphi)*chiYlm(ell,m,thetap,vaphip)</span></div>
<div class="line"><span class="preprocessor">end</span></div>
<div class="line"><span class="preprocessor"></span> </div>
<div class="line"><span class="preprocessor">print(&quot;</span>sum = &quot;..tostring(value))</div>
<div class="line">check = chiLegendre(ell,mu)</div>
<div class="line">print(&quot;Check = &quot;..tostring(check))</div>
<div class="ttc" id="agroup___lua_math_html_ga1266ad6fd8ac5ff3828c2dbc258d28bd"><div class="ttname"><a href="../../d0/d4d/group___lua_math.html#ga1266ad6fd8ac5ff3828c2dbc258d28bd">chi_lua::chiYlm</a></div><div class="ttdeci">void chiYlm(int ell, int m, double theta, double varphi)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l03371">lua_functions.c:3371</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_MeshIO_ReadEnsight_lua" name="tests_MeshIO_ReadEnsight_lua"></a>tests/MeshIO/ReadEnsight.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.51187 and 1.42458e-03</div>
<div class="line">num_procs = 4</div>
<div class="line">--Unstructured mesh</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">umesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga786a5766d529beefbf4a695ee76993fd">chiUnpartitionedMeshFromExodusII</a>(&quot;resources/TestMeshes/Sphere.case&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED, umesh);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Exports</span></div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#gae0ceeadeae53b7ac22b32f3665d1ea2a">chiMeshHandlerExportMeshToVTK</a>(<span class="stringliteral">&quot;ZEnsight&quot;</span>)</div>
<div class="line">end</div>
<div class="ttc" id="agroup___lua_unpartitioned_mesh_html_ga786a5766d529beefbf4a695ee76993fd"><div class="ttname"><a href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga786a5766d529beefbf4a695ee76993fd">chi_lua::chiUnpartitionedMeshFromExodusII</a></div><div class="ttdeci">Handle chiUnpartitionedMeshFromExodusII(char file_name, float scale)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l01469">lua_functions.c:1469</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_MeshIO_ReadExodus1_lua" name="tests_MeshIO_ReadExodus1_lua"></a>tests/MeshIO/ReadExodus1.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.51187 and 1.42458e-03</div>
<div class="line">num_procs = 4</div>
<div class="line">--Unstructured mesh</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">umesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga786a5766d529beefbf4a695ee76993fd">chiUnpartitionedMeshFromExodusII</a>(&quot;tests/MeshIO/QBlock.e&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED, umesh);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Exports</span></div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#gae0ceeadeae53b7ac22b32f3665d1ea2a">chiMeshHandlerExportMeshToVTK</a>(<span class="stringliteral">&quot;ZExodus1&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_MeshIO_ReadExodus1bWriteExodus_lua" name="tests_MeshIO_ReadExodus1bWriteExodus_lua"></a>tests/MeshIO/ReadExodus1bWriteExodus.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.51187 and 1.42458e-03</div>
<div class="line">num_procs = 4</div>
<div class="line">--Unstructured mesh</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">umesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga786a5766d529beefbf4a695ee76993fd">chiUnpartitionedMeshFromExodusII</a>(&quot;tests/MeshIO/QBlock.e&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED, umesh);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Exports</span></div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#gaced6b42c4facef20a0c289f579146eb0">chiMeshHandlerExportMeshToExodus</a>(<span class="stringliteral">&quot;ZExodus1b&quot;</span>)</div>
<div class="line">end</div>
<div class="ttc" id="agroup___lua_mesh_handler_html_gaced6b42c4facef20a0c289f579146eb0"><div class="ttname"><a href="../../da/d92/group___lua_mesh_handler.html#gaced6b42c4facef20a0c289f579146eb0">chi_lua::chiMeshHandlerExportMeshToExodus</a></div><div class="ttdeci">void chiMeshHandlerExportMeshToExodus(char FileName)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l02358">lua_functions.c:2358</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_MeshIO_ReadExodus2_lua" name="tests_MeshIO_ReadExodus2_lua"></a>tests/MeshIO/ReadExodus2.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.51187 and 1.42458e-03</div>
<div class="line">num_procs = 4</div>
<div class="line">--Unstructured mesh</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">umesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga786a5766d529beefbf4a695ee76993fd">chiUnpartitionedMeshFromExodusII</a>(&quot;tests/MeshIO/Pins2D.e&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED, umesh);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Exports</span></div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#gae0ceeadeae53b7ac22b32f3665d1ea2a">chiMeshHandlerExportMeshToVTK</a>(<span class="stringliteral">&quot;ZExodus2&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_MeshIO_ReadExodus3_lua" name="tests_MeshIO_ReadExodus3_lua"></a>tests/MeshIO/ReadExodus3.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.51187 and 1.42458e-03</div>
<div class="line">num_procs = 4</div>
<div class="line">--Unstructured mesh</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">umesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga786a5766d529beefbf4a695ee76993fd">chiUnpartitionedMeshFromExodusII</a>(&quot;tests/MeshIO/ATR_2D_MeshD_lin_v256005_e262983.e&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED, umesh);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Exports</span></div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#gae0ceeadeae53b7ac22b32f3665d1ea2a">chiMeshHandlerExportMeshToVTK</a>(<span class="stringliteral">&quot;ZExodus3&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_MeshIO_ReadPVTU_lua" name="tests_MeshIO_ReadPVTU_lua"></a>tests/MeshIO/ReadPVTU.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.51187 and 1.42458e-03</div>
<div class="line">num_procs = 4</div>
<div class="line">--Unstructured mesh</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">umesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#gadce9cadb62b62b0169d7b66485c1e354">chiUnpartitionedMeshFromPVTU</a>(&quot;ZPhi3D_g0.pvtu&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED, umesh);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Exports</span></div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#gae0ceeadeae53b7ac22b32f3665d1ea2a">chiMeshHandlerExportMeshToVTK</a>(<span class="stringliteral">&quot;ZPVTU&quot;</span>)</div>
<div class="line">end</div>
<div class="ttc" id="agroup___lua_unpartitioned_mesh_html_gadce9cadb62b62b0169d7b66485c1e354"><div class="ttname"><a href="../../d2/dde/group___lua_unpartitioned_mesh.html#gadce9cadb62b62b0169d7b66485c1e354">chi_lua::chiUnpartitionedMeshFromPVTU</a></div><div class="ttdeci">Handle chiUnpartitionedMeshFromPVTU(char file_name, char field)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l01336">lua_functions.c:1336</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_MeshIO_ReadVTU_lua" name="tests_MeshIO_ReadVTU_lua"></a>tests/MeshIO/ReadVTU.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.51187 and 1.42458e-03</div>
<div class="line">num_procs = 4</div>
<div class="line">--Unstructured mesh</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">umesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga8fd3c77424bb548d492468b2cadc220c">chiUnpartitionedMeshFromVTU</a>(&quot;ZPhi3D_g0_0.vtu&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED, umesh);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Exports</span></div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#gae0ceeadeae53b7ac22b32f3665d1ea2a">chiMeshHandlerExportMeshToVTK</a>(<span class="stringliteral">&quot;ZVTU&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_MeshIO_ReadWavefrontObj1_lua" name="tests_MeshIO_ReadWavefrontObj1_lua"></a>tests/MeshIO/ReadWavefrontObj1.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.51187 and 1.42458e-03</div>
<div class="line">num_procs = 4</div>
<div class="line">--Unstructured mesh</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">umesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga0f476b765a307ec7a477c237134298c2">chiUnpartitionedMeshFromWavefrontOBJ</a>(&quot;tests/MeshIO/ReactorPinMesh.obj&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED, umesh);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Exports</span></div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#gae0ceeadeae53b7ac22b32f3665d1ea2a">chiMeshHandlerExportMeshToVTK</a>(<span class="stringliteral">&quot;ZObjMesh&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_MeshIO_ReadWavefrontObj2_lua" name="tests_MeshIO_ReadWavefrontObj2_lua"></a>tests/MeshIO/ReadWavefrontObj2.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.51187 and 1.42458e-03</div>
<div class="line">num_procs = 4</div>
<div class="line">--Unstructured mesh</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">umesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga0f476b765a307ec7a477c237134298c2">chiUnpartitionedMeshFromWavefrontOBJ</a>(&quot;tests/MeshIO/TempBlendA.obj&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED, umesh);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Exports</span></div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#gae0ceeadeae53b7ac22b32f3665d1ea2a">chiMeshHandlerExportMeshToVTK</a>(<span class="stringliteral">&quot;ZObjMesh2&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_MeshIO_ReadWavefrontObj3_lua" name="tests_MeshIO_ReadWavefrontObj3_lua"></a>tests/MeshIO/ReadWavefrontObj3.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.51187 and 1.42458e-03</div>
<div class="line">num_procs = 4</div>
<div class="line">--Unstructured mesh</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">umesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga0f476b765a307ec7a477c237134298c2">chiUnpartitionedMeshFromWavefrontOBJ</a>(&quot;tests/MeshIO/MeshWavefront3.obj&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED, umesh);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[<span class="stringliteral">&quot;0&quot;</span>] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[<span class="stringliteral">&quot;1&quot;</span>] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[<span class="stringliteral">&quot;0&quot;</span>],SCALAR_VALUE, <span class="stringliteral">&quot;D&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[&quot;0&quot;],SCALAR_VALUE, &quot;q&quot;)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[&quot;0&quot;],&quot;D&quot;,SINGLE_VALUE,1.0)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[&quot;0&quot;],&quot;q&quot;,SINGLE_VALUE,1.0)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[&quot;1&quot;],SCALAR_VALUE, &quot;D&quot;)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[&quot;1&quot;],SCALAR_VALUE, &quot;q&quot;)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[&quot;1&quot;],&quot;D&quot;,SINGLE_VALUE,1.0)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[&quot;1&quot;],&quot;q&quot;,SINGLE_VALUE,1.0)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Setup Physics</span></div>
<div class="line">phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaa864dd5fda9e6c05e66e80b2411ccc83">chiDiffusionCreateSolver</a>()</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;discretization_method&quot;,&quot;PWLC&quot;)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,&quot;residual_tolerance&quot;,1.0e-8)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,<span class="stringliteral">&quot;BndryTop&quot;</span>   ,<span class="stringliteral">&quot;dirichlet&quot;</span>,1.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,&quot;boundary_type&quot;,&quot;BndryBottom&quot;,&quot;dirichlet&quot;,1.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,&quot;boundary_type&quot;,&quot;BndryLeftA&quot; ,&quot;dirichlet&quot;,10.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,&quot;boundary_type&quot;,&quot;BndryLeftB&quot; ,&quot;dirichlet&quot;,1.0)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,&quot;boundary_type&quot;,&quot;BndryRight&quot; ,&quot;dirichlet&quot;,1.0)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga4bdfbb9479a366e20aa38967521363fb">chiDiffusionInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaafc0819e34c8bdad070c5b3dcbf25e46">chiDiffusionExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fftemp,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#gae0ceeadeae53b7ac22b32f3665d1ea2a">chiMeshHandlerExportMeshToVTK</a>(<span class="stringliteral">&quot;ZObjMesh2&quot;</span>)</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chiExportMultiFieldFunctionToVTK</a>(fftemp,&quot;ZPhiObjMesh2&quot;)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_MeshIO_ReadWavefrontObj3bWriteExodus_lua" name="tests_MeshIO_ReadWavefrontObj3bWriteExodus_lua"></a>tests/MeshIO/ReadWavefrontObj3bWriteExodus.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.51187 and 1.42458e-03</div>
<div class="line">num_procs = 1</div>
<div class="line">--Unstructured mesh</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">umesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga0f476b765a307ec7a477c237134298c2">chiUnpartitionedMeshFromWavefrontOBJ</a>(&quot;tests/MeshIO/MeshWavefront3.obj&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED, umesh);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line">--</div>
<div class="line">----<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">--materials = {}</div>
<div class="line">--materials[<span class="stringliteral">&quot;0&quot;</span>] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">--materials[<span class="stringliteral">&quot;1&quot;</span>] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">--</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[<span class="stringliteral">&quot;0&quot;</span>],SCALAR_VALUE, <span class="stringliteral">&quot;D&quot;</span>)</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[<span class="stringliteral">&quot;0&quot;</span>],SCALAR_VALUE, <span class="stringliteral">&quot;q&quot;</span>)</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[<span class="stringliteral">&quot;0&quot;</span>],<span class="stringliteral">&quot;D&quot;</span>,SINGLE_VALUE,1.0)</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[<span class="stringliteral">&quot;0&quot;</span>],<span class="stringliteral">&quot;q&quot;</span>,SINGLE_VALUE,100.0)</div>
<div class="line">--</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[<span class="stringliteral">&quot;1&quot;</span>],SCALAR_VALUE, <span class="stringliteral">&quot;D&quot;</span>)</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[<span class="stringliteral">&quot;1&quot;</span>],SCALAR_VALUE, <span class="stringliteral">&quot;q&quot;</span>)</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[<span class="stringliteral">&quot;1&quot;</span>],<span class="stringliteral">&quot;D&quot;</span>,SINGLE_VALUE,10.0)</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[<span class="stringliteral">&quot;1&quot;</span>],<span class="stringliteral">&quot;q&quot;</span>,SINGLE_VALUE,0.0)</div>
<div class="line">--</div>
<div class="line">----############################################### Setup Physics</div>
<div class="line">--phys1 = <a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaa864dd5fda9e6c05e66e80b2411ccc83">chiDiffusionCreateSolver</a>()</div>
<div class="line">--<a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,<span class="stringliteral">&quot;discretization_method&quot;</span>,<span class="stringliteral">&quot;PWLC&quot;</span>)</div>
<div class="line">--<a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1,<span class="stringliteral">&quot;residual_tolerance&quot;</span>,1.0e-8)</div>
<div class="line">--</div>
<div class="line">----############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> boundary conditions</div>
<div class="line">--<a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,<span class="stringliteral">&quot;BndryTop&quot;</span>,<span class="stringliteral">&quot;dirichlet&quot;</span>,0.0)</div>
<div class="line">--<a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,<span class="stringliteral">&quot;BndryBottom&quot;</span>,<span class="stringliteral">&quot;dirichlet&quot;</span>,0.0)</div>
<div class="line">--<a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,<span class="stringliteral">&quot;BndryLeftA&quot;</span>,<span class="stringliteral">&quot;dirichlet&quot;</span>,0.0)</div>
<div class="line">--<a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,<span class="stringliteral">&quot;BndryLeftB&quot;</span>,<span class="stringliteral">&quot;dirichlet&quot;</span>,1.0)</div>
<div class="line">--<a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga6ccf8162a4fd525c1fb520f21cc02050">chiDiffusionSetProperty</a>(phys1,<span class="stringliteral">&quot;boundary_type&quot;</span>,<span class="stringliteral">&quot;BndryRight&quot;</span>,<span class="stringliteral">&quot;dirichlet&quot;</span>,0.0)</div>
<div class="line">--</div>
<div class="line">----############################################### Initialize and Execute Solver</div>
<div class="line">--<a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#ga4bdfbb9479a366e20aa38967521363fb">chiDiffusionInitialize</a>(phys1)</div>
<div class="line">--<a class="code hl_function" href="../../de/d15/group___lua_diffusion.html#gaafc0819e34c8bdad070c5b3dcbf25e46">chiDiffusionExecute</a>(phys1)</div>
<div class="line">--</div>
<div class="line">----############################################### Get field functions</div>
<div class="line">--fftemp,count = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gafd9778eaca8f2cba9dd4b60dc9b51aa8">chiSolverGetFieldFunctionList</a>(phys1)</div>
<div class="line">--</div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#gaced6b42c4facef20a0c289f579146eb0">chiMeshHandlerExportMeshToExodus</a>(<span class="stringliteral">&quot;ZExodus3b&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_MeshIO_ReadWavefrontObj4ExtrudeWriteExodus_lua" name="tests_MeshIO_ReadWavefrontObj4ExtrudeWriteExodus_lua"></a>tests/MeshIO/ReadWavefrontObj4ExtrudeWriteExodus.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.51187 and 1.42458e-03</div>
<div class="line">num_procs = 1</div>
<div class="line">--Unstructured mesh</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">umesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga0f476b765a307ec7a477c237134298c2">chiUnpartitionedMeshFromWavefrontOBJ</a>(&quot;tests/MeshIO/ReadWavefrontObj4.obj&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_EXTRUDER,</div>
<div class="line">                      ExtruderTemplateType.UNPARTITIONED_MESH,</div>
<div class="line">                      umesh);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>, 12.0, 12, &quot;Single Layer&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">PARTITION_TYPE</a>,KBA_STYLE_XYZ)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Exports</span></div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#gaced6b42c4facef20a0c289f579146eb0">chiMeshHandlerExportMeshToExodus</a>(<span class="stringliteral">&quot;ZExodus4a&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Adjoint_Adjoint2D_1a_forward_lua" name="tests_Transport_Adjoint_Adjoint2D_1a_forward_lua"></a>tests/Transport_Adjoint/Adjoint2D_1a_forward.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with localized material source</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: QOI-value=1.38399e-05</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line">tmesh = <a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">nodes={}</div>
<div class="line">N=60</div>
<div class="line">L=5.0</div>
<div class="line">ds=L/N</div>
<div class="line">xmin_=0.0</div>
<div class="line"><span class="keywordflow">for</span> i=0,N <span class="keywordflow">do</span></div>
<div class="line">    nodes[i+1] = xmin_ + i*ds</div>
<div class="line">end</div>
<div class="line">mesh,region0 = <a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(nodes,nodes)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">----############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,0.0,0.8*L,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">----<span class="preprocessor">############################################### Set Material IDs</span></div>
<div class="line">vol0b = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.166666+2.5,0.166666+2.5,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0b,0)</div>
<div class="line"> </div>
<div class="line">vol2 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.166666+2.5,0.166666+2.5,0.0,2*0.166666,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol2,2)</div>
<div class="line"> </div>
<div class="line">vol1b = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1+2.5,1+2.5,0.9*L,L,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1b,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line">materials[3] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material3&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[3],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[3],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 1</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],</div>
<div class="line">                              TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1,1,0.01,0.01)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],</div>
<div class="line">                              TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1,1,0.1*20,0.8)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[3],</div>
<div class="line">                              TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1,1,0.3*20,0.0)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 3.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[3],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">solver_name = <span class="stringliteral">&quot;LBS&quot;</span></div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>(solver_name)</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,48, 6)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,500)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> solver properties</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line">--############################################### Create QOIs</div>
<div class="line">tvol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,2.3333,2.6666,4.16666,4.33333,-1000,1000)</div>
<div class="line">tvol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,0.5   ,0.8333,4.16666,4.33333,-1000,1000)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">ff_m0 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..<span class="stringliteral">&quot;_Flux_g0_m0&quot;</span>)</div>
<div class="line">ff_m1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..&quot;_Flux_g0_m1&quot;)</div>
<div class="line">ff_m2 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..&quot;_Flux_g0_m2&quot;)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Slice plot</span></div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_SUM)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,tvol1)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,ff_m0)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">QOI_value = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;QOI-value=%.5e&quot;</span>, QOI_value))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chiExportMultiFieldFunctionToVTK</a>({ff_m0, ff_m1, ff_m2},<span class="stringliteral">&quot;ZPhi_&quot;</span>..solver_name)</div>
<div class="line">end</div>
<div class="ttc" id="anamespacechi__lua_html_aa98bc59e0c79ae51d0a3337da4311cf2"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chi_lua::chiGetFieldFunctionHandleByName</a></div><div class="ttdeci">handle chiGetFieldFunctionHandleByName(string FFname)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00299">lua_functions.c:299</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Adjoint_Adjoint2D_1b_adjoint_lua" name="tests_Transport_Adjoint_Adjoint2D_1b_adjoint_lua"></a>tests/Transport_Adjoint/Adjoint2D_1b_adjoint.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with localized material source Adjoint generation</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: None</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line">tmesh = <a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">nodes={}</div>
<div class="line">N=60</div>
<div class="line">L=5.0</div>
<div class="line">ds=L/N</div>
<div class="line">xmin_=0.0</div>
<div class="line"><span class="keywordflow">for</span> i=0,N <span class="keywordflow">do</span></div>
<div class="line">    nodes[i+1] = xmin_ + i*ds</div>
<div class="line">end</div>
<div class="line">mesh = <a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(nodes,nodes)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">----############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,0.0,0.8*L,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">----<span class="preprocessor">############################################### Set Material IDs</span></div>
<div class="line">vol0b = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.166666+2.5,0.166666+2.5,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0b,0)</div>
<div class="line"> </div>
<div class="line">vol2 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.166666+2.5,0.166666+2.5,0.0,2*0.166666,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol2,2)</div>
<div class="line"> </div>
<div class="line">vol1b = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1+2.5,1+2.5,0.9*L,L,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1b,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line">materials[3] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material3&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[3],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[3],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 1</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],</div>
<div class="line">                              TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1,1,0.01,0.01)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],</div>
<div class="line">                              TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1,1,0.1*20,0.8)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[3],</div>
<div class="line">                              TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1,1,0.3*20,0.0)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 3.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[3],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">solver_name = <span class="stringliteral">&quot;LBAdjoint&quot;</span></div>
<div class="line">phys1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a37ce0190421f21b309244a7277c5dc9e">chiAdjointSolverCreate</a>(solver_name)</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,48, 6)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,500)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> solver properties</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line">--############################################### Create QOIs</div>
<div class="line">tvol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,2.3333,2.6666,4.16666,4.33333,-1000,1000)</div>
<div class="line">tvol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,0.5   ,0.8333,4.16666,4.33333,-1000,1000)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a5f37bfee2717670248b68b723c383115">chiAdjointSolverAddResponseFunction</a>(phys1,&quot;QOI0&quot;,tvol0)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a5f37bfee2717670248b68b723c383115">chiAdjointSolverAddResponseFunction</a>(phys1,&quot;QOI1&quot;,tvol1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;REFERENCE_RF&quot;, &quot;QOI1&quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a25d4454a9446c7f052d4dc0b8c02b3db">chiLBSWriteFluxMoments</a>(phys1, <span class="stringliteral">&quot;Adjoint2D_1b_adjoint&quot;</span>)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">ff_m0 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..<span class="stringliteral">&quot;_Flux_g0_m0&quot;</span>)</div>
<div class="line">ff_m1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..&quot;_Flux_g0_m1&quot;)</div>
<div class="line">ff_m2 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..&quot;_Flux_g0_m2&quot;)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Slice plot</span></div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chiExportMultiFieldFunctionToVTK</a>({ff_m0, ff_m1, ff_m2},<span class="stringliteral">&quot;ZPhi_&quot;</span>..solver_name)</div>
<div class="line">end</div>
<div class="ttc" id="anamespacechi__lua_html_a25d4454a9446c7f052d4dc0b8c02b3db"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#a25d4454a9446c7f052d4dc0b8c02b3db">chi_lua::chiLBSWriteFluxMoments</a></div><div class="ttdeci">void chiLBSWriteFluxMoments(int SolverIndex, string file_base)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04675">lua_functions.c:4675</a></div></div>
<div class="ttc" id="anamespacechi__lua_html_a37ce0190421f21b309244a7277c5dc9e"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#a37ce0190421f21b309244a7277c5dc9e">chi_lua::chiAdjointSolverCreate</a></div><div class="ttdeci">Handle chiAdjointSolverCreate(string SolverName)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04901">lua_functions.c:4901</a></div></div>
<div class="ttc" id="anamespacechi__lua_html_a5f37bfee2717670248b68b723c383115"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#a5f37bfee2717670248b68b723c383115">chi_lua::chiAdjointSolverAddResponseFunction</a></div><div class="ttdeci">void chiAdjointSolverAddResponseFunction()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04926">lua_functions.c:4926</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Adjoint_Adjoint2D_1c_response_lua" name="tests_Transport_Adjoint_Adjoint2D_1c_response_lua"></a>tests/Transport_Adjoint/Adjoint2D_1c_response.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with localized material source Adjoint response</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Inner-product=1.38405e-05</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line">tmesh = <a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">nodes={}</div>
<div class="line">N=60</div>
<div class="line">L=5.0</div>
<div class="line">ds=L/N</div>
<div class="line">xmin_=0.0</div>
<div class="line"><span class="keywordflow">for</span> i=0,N <span class="keywordflow">do</span></div>
<div class="line">    nodes[i+1] = xmin_ + i*ds</div>
<div class="line">end</div>
<div class="line">mesh = <a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(nodes,nodes)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">----############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,0.0,0.8*L,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">----<span class="preprocessor">############################################### Set Material IDs</span></div>
<div class="line">vol0b = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.166666+2.5,0.166666+2.5,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0b,0)</div>
<div class="line"> </div>
<div class="line">vol2 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.166666+2.5,0.166666+2.5,0.0,2*0.166666,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol2,2)</div>
<div class="line"> </div>
<div class="line">vol1b = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1+2.5,1+2.5,0.9*L,L,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1b,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line">materials[3] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material3&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[3],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[3],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 1</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],</div>
<div class="line">                              TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1,1,0.01,0.01)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],</div>
<div class="line">                              TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1,1,0.1*20,0.8)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[3],</div>
<div class="line">                              TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1,1,0.3*20,0.0)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 3.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[3],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">solver_name = <span class="stringliteral">&quot;LBAdjointResponse&quot;</span></div>
<div class="line">phys1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a37ce0190421f21b309244a7277c5dc9e">chiAdjointSolverCreate</a>(solver_name)</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,48, 6)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,500)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> solver properties</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line">--############################################### Create QOIs</div>
<div class="line">tvol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,2.3333,2.6666,4.16666,4.33333,-1000,1000)</div>
<div class="line">tvol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,0.5   ,0.8333,4.16666,4.33333,-1000,1000)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a5f37bfee2717670248b68b723c383115">chiAdjointSolverAddResponseFunction</a>(phys1,&quot;QOI0&quot;,tvol0)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a5f37bfee2717670248b68b723c383115">chiAdjointSolverAddResponseFunction</a>(phys1,&quot;QOI1&quot;,tvol1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;REFERENCE_RF&quot;, &quot;QOI1&quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line">--<a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a849987fa4e766b427675e1e072a71721">chiLBSReadFluxMoments</a>(phys1, <span class="stringliteral">&quot;Adjoint2D_1b_adjoint&quot;</span>)</div>
<div class="line">value = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#abb2fdc7ac2eb169834576d77ccb65087">chiAdjointSolverComputeInnerProduct</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Inner-product=%.5e&quot;, value))</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Get field functions</span></div>
<div class="line">ff_m0 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..<span class="stringliteral">&quot;_Flux_g0_m0&quot;</span>)</div>
<div class="line">ff_m1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..&quot;_Flux_g0_m1&quot;)</div>
<div class="line">ff_m2 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..&quot;_Flux_g0_m2&quot;)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Slice plot</span></div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chiExportMultiFieldFunctionToVTK</a>({ff_m0, ff_m1, ff_m2},<span class="stringliteral">&quot;ZPhi_&quot;</span>..solver_name)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Cleanup</div>
<div class="line"><a class="code hl_function" href="../../dd/d5c/group__chi_m_p_i.html#ga9cb624104190befb4f294d6c90452502">chiMPIBarrier</a>()</div>
<div class="line">if (chi_location_id == 0) then</div>
<div class="line">    os.execute(&quot;rm Adjoint2D_1b_adjoint*&quot;)</div>
<div class="line">end</div>
<div class="ttc" id="agroup__chi_m_p_i_html_ga9cb624104190befb4f294d6c90452502"><div class="ttname"><a href="../../dd/d5c/group__chi_m_p_i.html#ga9cb624104190befb4f294d6c90452502">chi_lua::chiMPIBarrier</a></div><div class="ttdeci">void chiMPIBarrier()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l03384">lua_functions.c:3384</a></div></div>
<div class="ttc" id="anamespacechi__lua_html_a849987fa4e766b427675e1e072a71721"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#a849987fa4e766b427675e1e072a71721">chi_lua::chiLBSReadFluxMoments</a></div><div class="ttdeci">void chiLBSReadFluxMoments(int SolverIndex, string file_base, bool single_file_flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04739">lua_functions.c:4739</a></div></div>
<div class="ttc" id="anamespacechi__lua_html_abb2fdc7ac2eb169834576d77ccb65087"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#abb2fdc7ac2eb169834576d77ccb65087">chi_lua::chiAdjointSolverComputeInnerProduct</a></div><div class="ttdeci">void chiAdjointSolverComputeInnerProduct()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04908">lua_functions.c:4908</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Adjoint_Adjoint2D_2a_forward_lua" name="tests_Transport_Adjoint_Adjoint2D_2a_forward_lua"></a>tests/Transport_Adjoint/Adjoint2D_2a_forward.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with point source FWD</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: QOI-value=2.90386e-05</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line">tmesh = <a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">nodes={}</div>
<div class="line">N=60</div>
<div class="line">L=5.0</div>
<div class="line">ds=L/N</div>
<div class="line">xmin_=0.0</div>
<div class="line"><span class="keywordflow">for</span> i=0,N <span class="keywordflow">do</span></div>
<div class="line">    nodes[i+1] = xmin_ + i*ds</div>
<div class="line">end</div>
<div class="line">mesh = <a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(nodes,nodes)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">----############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,0.0,0.8*L,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">----<span class="preprocessor">############################################### Set Material IDs</span></div>
<div class="line">vol0b = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.166666+2.5,0.166666+2.5,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0b,0)</div>
<div class="line"> </div>
<div class="line">vol1b = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1+2.5,1+2.5,0.9*L,L,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1b,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 1</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],</div>
<div class="line">                              TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1,1,0.01,0.01)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],</div>
<div class="line">                              TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1,1,0.1*20,0.8)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 1.0</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">solver_name = <span class="stringliteral">&quot;LBS&quot;</span></div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>(solver_name)</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,48, 6)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,500)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"> </div>
<div class="line">--############################################### Add point source</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga925760d56a5295d53aea810939693b39">chiLBSAddPointSource</a>(phys1, 1.25 - 0.5*ds, 1.5*ds, 0.0, src)</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> solver properties</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line">--############################################### Create QOIs</div>
<div class="line">tvol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,2.3333,2.6666,4.16666,4.33333,-1000,1000)</div>
<div class="line">tvol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,0.5   ,0.8333,4.16666,4.33333,-1000,1000)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">ff_m0 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..<span class="stringliteral">&quot;_Flux_g0_m0&quot;</span>)</div>
<div class="line">ff_m1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..&quot;_Flux_g0_m1&quot;)</div>
<div class="line">ff_m2 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..&quot;_Flux_g0_m2&quot;)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Slice plot</span></div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_SUM)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,tvol1)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,ff_m0)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">QOI_value = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;QOI-value=%.5e&quot;</span>, QOI_value))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chiExportMultiFieldFunctionToVTK</a>({ff_m0, ff_m1, ff_m2},<span class="stringliteral">&quot;ZPhi_&quot;</span>..solver_name)</div>
<div class="line">end</div>
<div class="ttc" id="agroup___lua_l_b_s_html_ga925760d56a5295d53aea810939693b39"><div class="ttname"><a href="../../d0/daf/group___lua_l_b_s.html#ga925760d56a5295d53aea810939693b39">chi_lua::chiLBSAddPointSource</a></div><div class="ttdeci">void chiLBSAddPointSource(int SolverIndex, double Location_x, double Location_y, double Location_z, table Strength)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04774">lua_functions.c:4774</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Adjoint_Adjoint2D_2b_adjoint_lua" name="tests_Transport_Adjoint_Adjoint2D_2b_adjoint_lua"></a>tests/Transport_Adjoint/Adjoint2D_2b_adjoint.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with point source Adjoint generation</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: None</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line">tmesh = <a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">nodes={}</div>
<div class="line">N=60</div>
<div class="line">L=5.0</div>
<div class="line">ds=L/N</div>
<div class="line">xmin_=0.0</div>
<div class="line"><span class="keywordflow">for</span> i=0,N <span class="keywordflow">do</span></div>
<div class="line">    nodes[i+1] = xmin_ + i*ds</div>
<div class="line">end</div>
<div class="line">mesh = <a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(nodes,nodes)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">----############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,0.0,0.8*L,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">----<span class="preprocessor">############################################### Set Material IDs</span></div>
<div class="line">vol0b = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.166666+2.5,0.166666+2.5,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0b,0)</div>
<div class="line"> </div>
<div class="line">vol1b = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1+2.5,1+2.5,0.9*L,L,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1b,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 1</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],</div>
<div class="line">                              TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1,1,0.01,0.01)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],</div>
<div class="line">                              TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1,1,0.1*20,0.8)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 1.0</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">solver_name = <span class="stringliteral">&quot;LBAdjoint&quot;</span></div>
<div class="line">phys1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a37ce0190421f21b309244a7277c5dc9e">chiAdjointSolverCreate</a>(solver_name)</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,48, 6)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,500)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"> </div>
<div class="line">--############################################### Add point source</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga925760d56a5295d53aea810939693b39">chiLBSAddPointSource</a>(phys1, 1.25 - 0.5*ds, 1.5*ds, 0.0, src)</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> solver properties</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line">--############################################### Create QOIs</div>
<div class="line">tvol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,2.3333,2.6666,4.16666,4.33333,-1000,1000)</div>
<div class="line">tvol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,0.5   ,0.8333,4.16666,4.33333,-1000,1000)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a5f37bfee2717670248b68b723c383115">chiAdjointSolverAddResponseFunction</a>(phys1,&quot;QOI0&quot;,tvol0)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a5f37bfee2717670248b68b723c383115">chiAdjointSolverAddResponseFunction</a>(phys1,&quot;QOI1&quot;,tvol1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;REFERENCE_RF&quot;, &quot;QOI1&quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a25d4454a9446c7f052d4dc0b8c02b3db">chiLBSWriteFluxMoments</a>(phys1, <span class="stringliteral">&quot;Adjoint2D_2b_adjoint&quot;</span>)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">ff_m0 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..<span class="stringliteral">&quot;_Flux_g0_m0&quot;</span>)</div>
<div class="line">ff_m1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..&quot;_Flux_g0_m1&quot;)</div>
<div class="line">ff_m2 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..&quot;_Flux_g0_m2&quot;)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Slice plot</span></div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chiExportMultiFieldFunctionToVTK</a>({ff_m0, ff_m1, ff_m2},<span class="stringliteral">&quot;ZPhi_&quot;</span>..solver_name)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Adjoint_Adjoint2D_2c_response_lua" name="tests_Transport_Adjoint_Adjoint2D_2c_response_lua"></a>tests/Transport_Adjoint/Adjoint2D_2c_response.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with point source Adjoint response</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Inner-product=2.90543e-05</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line">tmesh = <a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">nodes={}</div>
<div class="line">N=60</div>
<div class="line">L=5.0</div>
<div class="line">ds=L/N</div>
<div class="line">xmin_=0.0</div>
<div class="line"><span class="keywordflow">for</span> i=0,N <span class="keywordflow">do</span></div>
<div class="line">    nodes[i+1] = xmin_ + i*ds</div>
<div class="line">end</div>
<div class="line">mesh,region0 = <a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(nodes,nodes)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">----############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,0.0,0.8*L,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">----<span class="preprocessor">############################################### Set Material IDs</span></div>
<div class="line">vol0b = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.166666+2.5,0.166666+2.5,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0b,0)</div>
<div class="line"> </div>
<div class="line">vol1b = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1+2.5,1+2.5,0.9*L,L,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1b,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 1</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],</div>
<div class="line">                              TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1,1,0.01,0.01)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],</div>
<div class="line">                              TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1,1,0.1*20,0.8)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 1.0</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">solver_name = <span class="stringliteral">&quot;LBAdjointResponse&quot;</span></div>
<div class="line">phys1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a37ce0190421f21b309244a7277c5dc9e">chiAdjointSolverCreate</a>(solver_name)</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,48, 6)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,500)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"> </div>
<div class="line">--############################################### Add point source</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga925760d56a5295d53aea810939693b39">chiLBSAddPointSource</a>(phys1, 1.25 - 0.5*ds, 1.5*ds, 0.0, src)</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> solver properties</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line">--############################################### Create QOIs</div>
<div class="line">tvol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,2.3333,2.6666,4.16666,4.33333,-1000,1000)</div>
<div class="line">tvol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,0.5   ,0.8333,4.16666,4.33333,-1000,1000)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a5f37bfee2717670248b68b723c383115">chiAdjointSolverAddResponseFunction</a>(phys1,&quot;QOI0&quot;,tvol0)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a5f37bfee2717670248b68b723c383115">chiAdjointSolverAddResponseFunction</a>(phys1,&quot;QOI1&quot;,tvol1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;REFERENCE_RF&quot;, &quot;QOI1&quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line">--<a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a849987fa4e766b427675e1e072a71721">chiLBSReadFluxMoments</a>(phys1, <span class="stringliteral">&quot;Adjoint2D_2b_adjoint&quot;</span>)</div>
<div class="line">value = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#abb2fdc7ac2eb169834576d77ccb65087">chiAdjointSolverComputeInnerProduct</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Inner-product=%.5e&quot;, value))</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Get field functions</span></div>
<div class="line">ff_m0 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..<span class="stringliteral">&quot;_Flux_g0_m0&quot;</span>)</div>
<div class="line">ff_m1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..&quot;_Flux_g0_m1&quot;)</div>
<div class="line">ff_m2 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..&quot;_Flux_g0_m2&quot;)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Slice plot</span></div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chiExportMultiFieldFunctionToVTK</a>({ff_m0, ff_m1, ff_m2},<span class="stringliteral">&quot;ZPhi_&quot;</span>..solver_name)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Cleanup</div>
<div class="line"><a class="code hl_function" href="../../dd/d5c/group__chi_m_p_i.html#ga9cb624104190befb4f294d6c90452502">chiMPIBarrier</a>()</div>
<div class="line">if (chi_location_id == 0) then</div>
<div class="line">    os.execute(&quot;rm Adjoint2D_2b_adjoint*&quot;)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Adjoint_Adjoint2D_3a_forward_lua" name="tests_Transport_Adjoint_Adjoint2D_3a_forward_lua"></a>tests/Transport_Adjoint/Adjoint2D_3a_forward.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with point source Multigroup FWD</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test:</div>
<div class="line">--  QOI-value[0]= 1.12687e-06</div>
<div class="line">--  QOI-value[1]= 2.95934e-06</div>
<div class="line">--  QOI-value[2]= 3.92975e-06</div>
<div class="line">--  QOI-value[3]= 4.18474e-06</div>
<div class="line">--  QOI-value[4]= 3.89649e-06</div>
<div class="line">--  QOI-value[5]= 3.30482e-06</div>
<div class="line">--  QOI-value[6]= 1.54506e-06</div>
<div class="line">--  QOI-value[7]= 6.74868e-07</div>
<div class="line">--  QOI-value[8]= 3.06178e-07</div>
<div class="line">--  QOI-value[9]= 2.07284e-07</div>
<div class="line">--  QOI-value[sum]= 2.21354e-05</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line">tmesh = <a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">nodes={}</div>
<div class="line">N=60</div>
<div class="line">L=5.0</div>
<div class="line">ds=L/N</div>
<div class="line">xmin_=0.0</div>
<div class="line"><span class="keywordflow">for</span> i=0,N <span class="keywordflow">do</span></div>
<div class="line">    nodes[i+1] = xmin_ + i*ds</div>
<div class="line">end</div>
<div class="line">mesh = <a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(nodes,nodes)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">----############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,0.0,0.8*L,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">----<span class="preprocessor">############################################### Set Material IDs</span></div>
<div class="line">vol0b = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.166666+2.5,0.166666+2.5,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0b,0)</div>
<div class="line"> </div>
<div class="line">vol1b = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1+2.5,1+2.5,0.9*L,L,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1b,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 10</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],</div>
<div class="line">                              TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1,num_groups,0.01,0.01)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],</div>
<div class="line">                              TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1,num_groups,0.1*20,0.8)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 1.0</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">solver_name = <span class="stringliteral">&quot;LBS&quot;</span></div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>(solver_name)</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,12, 2)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,500)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"> </div>
<div class="line">--############################################### Add point source</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga925760d56a5295d53aea810939693b39">chiLBSAddPointSource</a>(phys1, 1.25 - 0.5*ds, 1.5*ds, 0.0, src)</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> solver properties</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line">--############################################### Create QOIs</div>
<div class="line">tvol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,2.3333,2.6666,4.16666,4.33333,-1000,1000)</div>
<div class="line">tvol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,0.5   ,0.8333,4.16666,4.33333,-1000,1000)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">ff_m0 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..<span class="stringliteral">&quot;_Flux_g000_m00&quot;</span>)</div>
<div class="line">ff_m1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..&quot;_Flux_g000_m01&quot;)</div>
<div class="line">ff_m2 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..&quot;_Flux_g000_m02&quot;)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Slice plot</span></div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line">QOI_value_sum = 0.0</div>
<div class="line"><span class="keywordflow">for</span> g=0,num_groups-1 <span class="keywordflow">do</span></div>
<div class="line">    ff = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..<span class="stringliteral">&quot;_Flux_g&quot;</span>..</div>
<div class="line">            <span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;%03d&quot;</span>,g)..<span class="stringliteral">&quot;_m&quot;</span>..<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;%02d&quot;</span>,0))</div>
<div class="line">    ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">    curffi = ffi1</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_SUM)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,tvol1)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,ff)</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">    QOI_value = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;QOI-value[&quot;..tostring(g)..&quot;]= %.5e&quot;, QOI_value))</div>
<div class="line"> </div>
<div class="line">    QOI_value_sum = QOI_value_sum + QOI_value</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;QOI-value[sum]= %.5e&quot;, QOI_value_sum))</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Exports</span></div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chiExportMultiFieldFunctionToVTK</a>({ff_m0, ff_m1, ff_m2},<span class="stringliteral">&quot;ZPhi_&quot;</span>..solver_name)</div>
<div class="line">    chiExportFieldFunctionToVTKG(ff_m0, <span class="stringliteral">&quot;ZPhi_&quot;</span>..solver_name)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--[0]  QOI-vallue[0]= 1.95637e-09</div>
<div class="line">--[0]  QOI-vallue[1]= 5.13773e-09</div>
<div class="line">--[0]  QOI-vallue[2]= 6.82248e-09</div>
<div class="line">--[0]  QOI-vallue[3]= 7.26518e-09</div>
<div class="line">--[0]  QOI-vallue[4]= 6.76479e-09</div>
<div class="line">--[0]  QOI-vallue[5]= 5.73749e-09</div>
<div class="line">--[0]  QOI-vallue[6]= 2.68214e-09</div>
<div class="line">--[0]  QOI-vallue[7]= 1.17145e-09</div>
<div class="line">--[0]  QOI-vallue[8]= 5.31336e-10</div>
<div class="line">--[0]  QOI-vallue[9]= 3.59573e-10</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Adjoint_Adjoint2D_3b_adjoint_lua" name="tests_Transport_Adjoint_Adjoint2D_3b_adjoint_lua"></a>tests/Transport_Adjoint/Adjoint2D_3b_adjoint.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with point source Multigroup Adjoint generation</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: None</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line">tmesh = <a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">nodes={}</div>
<div class="line">N=60</div>
<div class="line">L=5.0</div>
<div class="line">ds=L/N</div>
<div class="line">xmin_=0.0</div>
<div class="line"><span class="keywordflow">for</span> i=0,N <span class="keywordflow">do</span></div>
<div class="line">    nodes[i+1] = xmin_ + i*ds</div>
<div class="line">end</div>
<div class="line">mesh = <a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(nodes,nodes)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">----############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,0.0,0.8*L,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">----<span class="preprocessor">############################################### Set Material IDs</span></div>
<div class="line">vol0b = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.166666+2.5,0.166666+2.5,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0b,0)</div>
<div class="line"> </div>
<div class="line">vol1b = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1+2.5,1+2.5,0.9*L,L,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1b,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 10</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],</div>
<div class="line">                              TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1,num_groups,0.01,0.01)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],</div>
<div class="line">                              TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1,num_groups,0.1*20,0.8)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 1.0</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">solver_name = <span class="stringliteral">&quot;LBAdjoint&quot;</span></div>
<div class="line">phys1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a37ce0190421f21b309244a7277c5dc9e">chiAdjointSolverCreate</a>(solver_name)</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,12, 2)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,500)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"> </div>
<div class="line">--############################################### Add point source</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga925760d56a5295d53aea810939693b39">chiLBSAddPointSource</a>(phys1, 1.25 - 0.5*ds, 1.5*ds, 0.0, src)</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> solver properties</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line">--############################################### Create QOIs</div>
<div class="line">tvol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,2.3333,2.6666,4.16666,4.33333,-1000,1000)</div>
<div class="line">tvol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,0.5   ,0.8333,4.16666,4.33333,-1000,1000)</div>
<div class="line"> </div>
<div class="line">function ResponseFunction(cell_centroid, material_id)</div>
<div class="line">    response = {}</div>
<div class="line">    <span class="keywordflow">for</span> g=0,9 <span class="keywordflow">do</span></div>
<div class="line">        response[g+1] = 0.0</div>
<div class="line">    end</div>
<div class="line">    response[5+1] = 1.0</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> response</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a5f37bfee2717670248b68b723c383115">chiAdjointSolverAddResponseFunction</a>(phys1,<span class="stringliteral">&quot;QOI0&quot;</span>,tvol0,<span class="stringliteral">&quot;ResponseFunction&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a5f37bfee2717670248b68b723c383115">chiAdjointSolverAddResponseFunction</a>(phys1,&quot;QOI1&quot;,tvol1,&quot;ResponseFunction&quot;)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;REFERENCE_RF&quot;, &quot;QOI1&quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a25d4454a9446c7f052d4dc0b8c02b3db">chiLBSWriteFluxMoments</a>(phys1, <span class="stringliteral">&quot;Adjoint2D_3b_adjoint&quot;</span>)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">ff_m0 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..<span class="stringliteral">&quot;_Flux_g000_m00&quot;</span>)</div>
<div class="line">ff_m1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..&quot;_Flux_g000_m01&quot;)</div>
<div class="line">ff_m2 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..&quot;_Flux_g000_m02&quot;)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Slice plot</span></div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chiExportMultiFieldFunctionToVTK</a>({ff_m0, ff_m1, ff_m2},<span class="stringliteral">&quot;ZPhi_&quot;</span>..solver_name)</div>
<div class="line">    chiExportFieldFunctionToVTKG(ff_m0, <span class="stringliteral">&quot;ZPhi_&quot;</span>..solver_name)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Adjoint_Adjoint2D_3c_response_lua" name="tests_Transport_Adjoint_Adjoint2D_3c_response_lua"></a>tests/Transport_Adjoint/Adjoint2D_3c_response.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with point source Multigroup Adjoint Response</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Inner-product=3.30607e-06</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line">tmesh = <a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">nodes={}</div>
<div class="line">N=60</div>
<div class="line">L=5.0</div>
<div class="line">ds=L/N</div>
<div class="line">xmin_=0.0</div>
<div class="line"><span class="keywordflow">for</span> i=0,N <span class="keywordflow">do</span></div>
<div class="line">    nodes[i+1] = xmin_ + i*ds</div>
<div class="line">end</div>
<div class="line">mesh,region0 = <a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(nodes,nodes)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">----############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,0.0,0.8*L,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">----<span class="preprocessor">############################################### Set Material IDs</span></div>
<div class="line">vol0b = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.166666+2.5,0.166666+2.5,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0b,0)</div>
<div class="line"> </div>
<div class="line">vol1b = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1+2.5,1+2.5,0.9*L,L,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1b,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 10</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],</div>
<div class="line">                              TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1,num_groups,0.01,0.01)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],</div>
<div class="line">                              TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1,num_groups,0.1*20,0.8)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 1.0</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">solver_name = <span class="stringliteral">&quot;LBAdjointResponse&quot;</span></div>
<div class="line">phys1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a37ce0190421f21b309244a7277c5dc9e">chiAdjointSolverCreate</a>(solver_name)</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,12, 2)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,500)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"> </div>
<div class="line">--############################################### Add point source</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga925760d56a5295d53aea810939693b39">chiLBSAddPointSource</a>(phys1, 1.25 - 0.5*ds, 1.5*ds, 0.0, src)</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> solver properties</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line">--############################################### Create QOIs</div>
<div class="line">tvol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,2.3333,2.6666,4.16666,4.33333,-1000,1000)</div>
<div class="line">tvol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,0.5   ,0.8333,4.16666,4.33333,-1000,1000)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a5f37bfee2717670248b68b723c383115">chiAdjointSolverAddResponseFunction</a>(phys1,&quot;QOI0&quot;,tvol0)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a5f37bfee2717670248b68b723c383115">chiAdjointSolverAddResponseFunction</a>(phys1,&quot;QOI1&quot;,tvol1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;REFERENCE_RF&quot;, &quot;QOI1&quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line">--<a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a849987fa4e766b427675e1e072a71721">chiLBSReadFluxMoments</a>(phys1, <span class="stringliteral">&quot;Adjoint2D_3b_adjoint&quot;</span>)</div>
<div class="line">value = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#abb2fdc7ac2eb169834576d77ccb65087">chiAdjointSolverComputeInnerProduct</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Inner-product=%.5e&quot;, value))</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Get field functions</span></div>
<div class="line">ff_m0 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..<span class="stringliteral">&quot;_Flux_g000_m00&quot;</span>)</div>
<div class="line">ff_m1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..&quot;_Flux_g000_m01&quot;)</div>
<div class="line">ff_m2 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..&quot;_Flux_g000_m02&quot;)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Slice plot</span></div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chiExportMultiFieldFunctionToVTK</a>({ff_m0, ff_m1, ff_m2},<span class="stringliteral">&quot;ZPhi_&quot;</span>..solver_name)</div>
<div class="line">    chiExportFieldFunctionToVTKG(ff_m0, <span class="stringliteral">&quot;ZPhi_&quot;</span>..solver_name)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Cleanup</div>
<div class="line"><a class="code hl_function" href="../../dd/d5c/group__chi_m_p_i.html#ga9cb624104190befb4f294d6c90452502">chiMPIBarrier</a>()</div>
<div class="line">if (chi_location_id == 0) then</div>
<div class="line">    os.execute(&quot;rm Adjoint2D_3b_adjoint*&quot;)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Keigen_KEigenvalueTransport1D_1G_lua" name="tests_Transport_Keigen_KEigenvalueTransport1D_1G_lua"></a>tests/Transport_Keigen/KEigenvalueTransport1D_1G.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 1D 1G KEigenvalue::Solver test <span class="keyword">using</span> power iteration</div>
<div class="line">-- Test: Final k-eigenvalue: 0.9995433</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line">-- NOTE: For command line inputs, specify as:</div>
<div class="line">--       variable=[[argument]]</div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs == nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dd/d5c/group__chi_m_p_i.html#ga9cb624104190befb4f294d6c90452502">chiMPIBarrier</a>()</div>
<div class="line"> </div>
<div class="line">-- ##################################################</div>
<div class="line">-- ##### Parameters #####</div>
<div class="line">-- ##################################################</div>
<div class="line"> </div>
<div class="line">-- Mesh variables</div>
<div class="line"><span class="keywordflow">if</span> (L == nil) then L = 100.0 end</div>
<div class="line"><span class="keywordflow">if</span> (n_cells == nil) then n_cells = 50 end</div>
<div class="line"> </div>
<div class="line">-- Transport angle information</div>
<div class="line"><span class="keywordflow">if</span> (n_angles == nil) then n_angles = 16 end</div>
<div class="line"><span class="keywordflow">if</span> (scat_order == nil) then scat_order = 0 end</div>
<div class="line"> </div>
<div class="line">-- k-eigenvalue iteration parameters</div>
<div class="line"><span class="keywordflow">if</span> (kes_max_iterations == nil) then kes_max_iterations = 5000 end</div>
<div class="line"><span class="keywordflow">if</span> (kes_tolerance == nil) then kes_tolerance = 1e-8 end</div>
<div class="line"> </div>
<div class="line">-- Source iteration parameters</div>
<div class="line"><span class="keywordflow">if</span> (si_max_iterations == nil) then si_max_iterations = 500 end</div>
<div class="line"><span class="keywordflow">if</span> (si_tolerance == nil) then si_tolerance = 1e-8 end</div>
<div class="line"> </div>
<div class="line">-- Delayed neutrons</div>
<div class="line"><span class="keywordflow">if</span> (use_precursors == nil) then use_precursors = <span class="keyword">true</span> end</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">-- ##################################################</div>
<div class="line">-- ##### Run problem #####</div>
<div class="line">-- ##################################################</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line">nodes = {}</div>
<div class="line">dx = L/n_cells</div>
<div class="line"><span class="keywordflow">for</span> i=0,n_cells <span class="keywordflow">do</span></div>
<div class="line">  nodes[i+1] = i*dx</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#gabcd0e135b1081c3b9eb6661d44fb21d7">chiMeshCreateUnpartitioned1DOrthoMesh</a>(nodes)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>()</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line">--############################################### Add materials</div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Fissile Material&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1], TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line">xs_file = &quot;tests/Transport_Keigen/simple_fissile.cxs&quot;</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1], TRANSPORT_XSECTIONS,</div>
<div class="line">                              CHI_XSFILE, xs_file)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Setup Physics</span></div>
<div class="line">-- Define solver</div>
<div class="line">phys = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a2ab586d2eb85bc3164299497871c8abf">chiLBKESCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys, DISCRETIZATION_METHOD, PWLD)</div>
<div class="line"> </div>
<div class="line">-- Create quadrature and define scattering order</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE,n_angles)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys,SCATTERING_ORDER,scat_order)</div>
<div class="line"> </div>
<div class="line">-- Create groups</div>
<div class="line">num_groups = 1</div>
<div class="line">for g=0, num_groups - 1 do</div>
<div class="line">    <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">-- Create groupset</div>
<div class="line">gs = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys, gs, 0, num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys, gs, pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys, gs, si_max_iterations)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys, gs, si_tolerance)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys, gs, KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga8f9de7a927209f9d2988404bd1eb7d83">chiLBSGroupsetSetAngleAggregationType</a>(phys, gs, LBSGroupset.ANGLE_AGG_SINGLE)</div>
<div class="line"> </div>
<div class="line">-- Additional parameters</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys, USE_PRECURSORS, use_precursors)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys, &quot;K_EIGEN_METHOD&quot;, &quot;nonlinear&quot;)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys, &quot;NLK_MAX_ITS&quot;, kes_max_iterations)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys, &quot;NLK_ABS_TOL&quot;, kes_tolerance)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys, VERBOSE_INNER_ITERATIONS, false)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys, VERBOSE_OUTER_ITERATIONS, true)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">--############################################### Line plot</div>
<div class="line">--############################################### Volume integrations</div>
<div class="line">--############################################### Exports</div>
<div class="line">--############################################### Plots</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Keigen_KEigenvalueTransport2D_1a_QBlock_lua" name="tests_Transport_Keigen_KEigenvalueTransport2D_1a_QBlock_lua"></a>tests/Transport_Keigen/KEigenvalueTransport2D_1a_QBlock.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D 2G KEigenvalue::Solver test <span class="keyword">using</span> Power Iteration</div>
<div class="line">-- Test: Final k-eigenvalue: 0.5969127</div>
<div class="line"> </div>
<div class="line">dofile(<span class="stringliteral">&quot;tests/Transport_Keigen/QBlock_mesh.lua&quot;</span>)</div>
<div class="line">dofile(&quot;tests/Transport_Keigen/QBlock_materials.lua&quot;) --num_groups assigned here</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Setup Physics</span></div>
<div class="line">phys1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a2ab586d2eb85bc3164299497871c8abf">chiLBKESCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,4, 4)</div>
<div class="line"><a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chiOptimizeAngularQuadratureForPolarSymmetry</a>(pqaud, 4.0*math.pi)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_RICHARDSON_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-10)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,50)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,50)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-8,false)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-8,false)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,LBSBoundaryTypes.REFLECTING);</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,YMIN,LBSBoundaryTypes.REFLECTING);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,2)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;K_EIGEN_METHOD&quot;, &quot;power&quot;)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;PI_MAX_ITS&quot;, 1000)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;PI_K_TOL&quot;, 1.0e-10)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, USE_PRECURSORS, false)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_INNER_ITERATIONS, false)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_OUTER_ITERATIONS, true)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chiExportMultiFieldFunctionToVTK</a>(fflist,<span class="stringliteral">&quot;tests/BigTests/QBlock/solutions/Flux&quot;</span>)</div>
<div class="line"> </div>
<div class="line">-- Reference value k_eff = 0.5969127</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Keigen_KEigenvalueTransport2D_1b_QBlock_lua" name="tests_Transport_Keigen_KEigenvalueTransport2D_1b_QBlock_lua"></a>tests/Transport_Keigen/KEigenvalueTransport2D_1b_QBlock.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D 2G KEigenvalue::Solver test <span class="keyword">using</span> NonLinearK</div>
<div class="line">-- Test: Final k-eigenvalue: 0.5969127</div>
<div class="line"> </div>
<div class="line">dofile(<span class="stringliteral">&quot;tests/Transport_Keigen/QBlock_mesh.lua&quot;</span>)</div>
<div class="line">dofile(&quot;tests/Transport_Keigen/QBlock_materials.lua&quot;) --num_groups assigned here</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Setup Physics</span></div>
<div class="line">phys1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a2ab586d2eb85bc3164299497871c8abf">chiLBKESCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,4, 4)</div>
<div class="line"><a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chiOptimizeAngularQuadratureForPolarSymmetry</a>(pqaud, 4.0*math.pi)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_RICHARDSON_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-8)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,50)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,10)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-8,false)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-8,false)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,LBSBoundaryTypes.REFLECTING);</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,YMIN,LBSBoundaryTypes.REFLECTING);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,2)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;K_EIGEN_METHOD&quot;, &quot;nonlinear&quot;)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga2522341caaf1b9ae3f18451542d1956b">chiSolverSetBasicOption</a>(phys1, &quot;NLK_ABS_TOL&quot;, 1.0e-8)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, USE_PRECURSORS, false)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_INNER_ITERATIONS, false)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_OUTER_ITERATIONS, true)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chiExportMultiFieldFunctionToVTK</a>(fflist,<span class="stringliteral">&quot;tests/BigTests/QBlock/solutions/Flux&quot;</span>)</div>
<div class="line"> </div>
<div class="line">-- Reference value k_eff = 0.5969127</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Keigen_QBlock_materials_lua" name="tests_Transport_Keigen_QBlock_materials_lua"></a>tests/Transport_Keigen/QBlock_materials.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Create cross sections</div>
<div class="line">xs = {}</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">for</span> m=0,1 <span class="keywordflow">do</span></div>
<div class="line">    xs[tostring(m)] = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga82468060b3343581b90ceb06aa1e52c3">chiPhysicsTransportXSCreate</a>()</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs[&quot;0&quot;],CHI_XSFILE,&quot;tests/Transport_Keigen/xs_water_g2.cxs&quot;)</div>
<div class="line"><a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs[&quot;1&quot;],CHI_XSFILE,&quot;tests/Transport_Keigen/xs_fuel_g2.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">water_xs = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#gaaf87347d2ab88ea5e88058038754bddf">chiPhysicsTransportXSGet</a>(xs[&quot;0&quot;])</div>
<div class="line">num_groups = water_xs[&quot;num_groups&quot;]</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Create materials</span></div>
<div class="line">materials = {}</div>
<div class="line"><span class="keywordflow">for</span> m=0,1 <span class="keywordflow">do</span></div>
<div class="line">    key = tostring(m)</div>
<div class="line">    materials[key] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Material_&quot;</span>..key)</div>
<div class="line">    <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(key,TRANSPORT_XSECTIONS)</div>
<div class="line">    <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(key,TRANSPORT_XSECTIONS, EXISTING,xs[key])</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Keigen_QBlock_mesh_lua" name="tests_Transport_Keigen_QBlock_mesh_lua"></a>tests/Transport_Keigen/QBlock_mesh.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=40</div>
<div class="line">L=14</div>
<div class="line">xmin_ = 0.0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,10.0,-1000,10.0,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_MIP2D_1a_lua" name="tests_Transport_Steady_MIP2D_1a_lua"></a>tests/Transport_Steady/MIP2D_1a.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.50758 and 2.52527e-04</div>
<div class="line">-- div 5</div>
<div class="line">--[0]  Max-value1=9.62800</div>
<div class="line">--[0]  Max-value2=5.99168e-02</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=50/5</div>
<div class="line">L=200/5</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 168</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,<span class="stringliteral">&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,SIMPLEXS0,num_groups,0.1)</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,SIMPLEXS0,num_groups,0.1)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">src[1] = 1.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,4, 4)</div>
<div class="line"><a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chiOptimizeAngularQuadratureForPolarSymmetry</a>(pqaud, 4.0*math.pi)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,62)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,100)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">gs1 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs1</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,63,167)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,100)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,</div>
<div class="line">--                        LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,0)</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">slice2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,SLICE_POINT,0.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice2)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice2)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value1=%.5f&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[160])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value2=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice2)</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chiExportMultiFieldFunctionToVTK</a>(fflist, <span class="stringliteral">&quot;SNPhi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line">--<span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line">--    local handle = io.popen(<span class="stringliteral">&quot;python3 ZPFFI00.py&quot;</span>)</div>
<div class="line">--end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_MIP2D_2a_lua" name="tests_Transport_Steady_MIP2D_2a_lua"></a>tests/Transport_Steady/MIP2D_2a.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.50758 and 2.52527e-04</div>
<div class="line">-- div 5</div>
<div class="line">--[0]  Max-value1=9.30553</div>
<div class="line">--[0]  Max-value2=3.67967e-02</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=50/5</div>
<div class="line">L=200/5</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 168</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,<span class="stringliteral">&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,SIMPLEXS0,num_groups,0.1)</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,SIMPLEXS0,num_groups,0.1)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">src[1] = 1.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a633f686a449edd9780cacff7ab600a25">chiLBSMIPCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2, 1)</div>
<div class="line"><a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chiOptimizeAngularQuadratureForPolarSymmetry</a>(pqaud, 4.0*math.pi)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,62)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,2)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,1000,1.0e-8,false,&quot; &quot;)</div>
<div class="line"> </div>
<div class="line">gs1 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs1</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,63,167)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,2)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,1000,1.0e-8,false,&quot; &quot;)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,</div>
<div class="line">--                        LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_INNER_ITERATIONS, <span class="keyword">false</span>)</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">slice2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,SLICE_POINT,0.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice2)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice2)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value1=%.5f&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[160])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value2=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice2)</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chiExportMultiFieldFunctionToVTK</a>(fflist, <span class="stringliteral">&quot;MIPPhi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line">--<span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line">--    local handle = io.popen(<span class="stringliteral">&quot;python3 ZPFFI00.py&quot;</span>)</div>
<div class="line">--end</div>
<div class="ttc" id="anamespacechi__lua_html_a633f686a449edd9780cacff7ab600a25"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#a633f686a449edd9780cacff7ab600a25">chi_lua::chiLBSMIPCreateSolver</a></div><div class="ttdeci">Handle chiLBSMIPCreateSolver(string SolverName)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04936">lua_functions.c:4936</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_MIP2D_2b_lua" name="tests_Transport_Steady_MIP2D_2b_lua"></a>tests/Transport_Steady/MIP2D_2b.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.50758 and 2.52527e-04</div>
<div class="line">-- div 5</div>
<div class="line">--[0]  Max-value1=9.30554</div>
<div class="line">--[0]  Max-value2=3.67948e-02</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=50/5</div>
<div class="line">L=200/5</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 168</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,<span class="stringliteral">&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,SIMPLEXS0,num_groups,0.1)</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,SIMPLEXS0,num_groups,0.1)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">src[1] = 1.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a633f686a449edd9780cacff7ab600a25">chiLBSMIPCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2, 1)</div>
<div class="line"><a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chiOptimizeAngularQuadratureForPolarSymmetry</a>(pqaud, 4.0*math.pi)</div>
<div class="line"> </div>
<div class="line">function MakeGroupset(from, to, withTG)</div>
<div class="line">    gs = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">    cur_gs = gs</div>
<div class="line">    <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,from,to)</div>
<div class="line">    <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line">    <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line">    <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line">    <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line">    <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line">    <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line">    <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line">    <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,1000,1.0e-4,false,&quot; &quot;)</div>
<div class="line">    --if withTG~= nil then</div>
<div class="line">    --    <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,1000,1.0e-8,false,&quot; &quot;)</div>
<div class="line">    --end</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">initg = 0</div>
<div class="line">limit = 62</div>
<div class="line">incr = 1</div>
<div class="line">for g=initg,limit,incr do</div>
<div class="line">    MakeGroupset(g,math.min(limit,g+incr-1))</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">initg = 63</div>
<div class="line">limit = 167</div>
<div class="line">incr = 1</div>
<div class="line">for g=initg,limit,incr do</div>
<div class="line">    MakeGroupset(g,math.min(limit,g+incr-1), true)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,</div>
<div class="line">--                        LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_INNER_ITERATIONS, false)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">slice2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,SLICE_POINT,0.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice2)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice2)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value1=%.5f&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[160])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value2=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line">--<span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice2)</div>
<div class="line">--    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chiExportMultiFieldFunctionToVTK</a>(fflist, <span class="stringliteral">&quot;MIPPhi&quot;</span>)</div>
<div class="line">--end</div>
<div class="line"> </div>
<div class="line">--############################################### Plots</div>
<div class="line">--<span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line">--    local handle = io.popen(<span class="stringliteral">&quot;python3 ZPFFI00.py&quot;</span>)</div>
<div class="line">--end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport1D_1_lua" name="tests_Transport_Steady_Transport1D_1_lua"></a>tests/Transport_Steady/Transport1D_1.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 1D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.49903 and 7.18243e-4</div>
<div class="line">num_procs = 3</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=100</div>
<div class="line">L=30.0</div>
<div class="line">xmin_ = 0.0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#gabcd0e135b1081c3b9eb6661d44fb21d7">chiMeshCreateUnpartitioned1DOrthoMesh</a>(mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line">--############################################### Add materials</div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 168</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,<span class="stringliteral">&quot;tests/Transport_Steady/xs_3_170.cxs&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_3_170.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,SIMPLEXS0,num_groups,0.1)</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,SIMPLEXS0,num_groups,0.1)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">--src[1] = 1.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE,40)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,62)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,8)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line"> </div>
<div class="line">gs1 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs1</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,63,167)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,8)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/2</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMIN,LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,5)</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Line plot</div>
<div class="line">--Testing consolidated interpolation</div>
<div class="line">cline = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(LINE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(cline,LINE_FIRSTPOINT,0.0,0.0,0.0001+xmin_)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(cline,LINE_SECONDPOINT,0.0,0.0, 29.999+xmin_)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(cline,LINE_NUMBEROFPOINTS, 50)</div>
<div class="line"> </div>
<div class="line">for k=165,165 do</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(cline,ADD_FIELDFUNCTION,fflist[k])</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(cline)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(cline)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Max-value1=%.5f&quot;, maxval))</div>
<div class="line"> </div>
<div class="line">ffi2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi2</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[160])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Max-value2=%.5e&quot;, maxval))</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Exports</span></div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(cline)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Plots</div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python3 ZLFFI00.py&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport1D_3a_DSA_ortho_lua" name="tests_Transport_Steady_Transport1D_3a_DSA_ortho_lua"></a>tests/Transport_Steady/Transport1D_3a_DSA_ortho.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 1D LinearBSolver test of a block of graphite with an air cavity. DSA and TG</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: WGS groups [0-62] Iteration    28 Residual 6.74299e-07 CONVERGED</div>
<div class="line">-- and   WGS groups [63-167] Iteration    39 Residual 8.73816e-07 CONVERGED</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=1000</div>
<div class="line">L=100</div>
<div class="line">--N=10</div>
<div class="line">--L=200e6</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">--xmin_ = 0.0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#gabcd0e135b1081c3b9eb6661d44fb21d7">chiMeshCreateUnpartitioned1DOrthoMesh</a>(mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-10.0,10.0,-10.0,10.0,-10.0,10.0)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--num_groups = 1</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">--        SIMPLEXS1,num_groups,1.0,0.999)</div>
<div class="line">num_groups = 168</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_air50RH.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">src[1] = 1.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad0 = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2, 2,<span class="keyword">false</span>)</div>
<div class="line">pquad1 = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,8, 8,false)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line"> </div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,62)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad0)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_RICHARDSON_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,1000)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,30)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-2,false,&quot;&quot;)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot;&quot;)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">gs1 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line"> </div>
<div class="line">cur_gs = gs1</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,63,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad0)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_RICHARDSON_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,1000)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,30)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-2,false,&quot;&quot;)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot;&quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi;</div>
<div class="line">--bsrc[1] = 1.0</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMAX,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,YMIN,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,YMAX,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMIN,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMAX,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    chiExportFieldFunctionToVTKG(fflist[1],<span class="stringliteral">&quot;ZPhi&quot;</span>,<span class="stringliteral">&quot;Phi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"> </div>
<div class="line">--############################################### Stats N=50</div>
<div class="line">-- Case 0a 1MPI <a class="code hl_enumvalue" href="../../d9/d42/namespacelbs.html#a74e6ab7d8963411bcda1c642e3098508ac1bfd84e7215afa3204b8e1cdb21a2bd">GMRES</a>(30)</div>
<div class="line">-- GS0  53 its GS1 240 its</div>
<div class="line"> </div>
<div class="line">-- Case 1a 1MPI <a class="code hl_enumvalue" href="../../d9/d42/namespacelbs.html#a74e6ab7d8963411bcda1c642e3098508ac1bfd84e7215afa3204b8e1cdb21a2bd">GMRES</a>(30) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  27 its GS1  62 its</div>
<div class="line"> </div>
<div class="line">-- Case 2a 1MPI GMRES(30) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  27 its GS1  33 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">-- Case 0a 1MPI GMRES(60)</div>
<div class="line">-- GS0  36 its GS1 70 its</div>
<div class="line"> </div>
<div class="line">-- Case 1a 1MPI GMRES(60) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  27 its GS1  42 its</div>
<div class="line"> </div>
<div class="line">-- Case 2a 1MPI GMRES(60) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  27 its GS1  32 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">-- GMRES(10)</div>
<div class="line">-- Case 0b 1MPI GMRES(10)</div>
<div class="line">-- GS0  96 its GS1 357 its</div>
<div class="line"> </div>
<div class="line">-- Case 1b 1MPI GMRES(10) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  116 its GS1  inf its</div>
<div class="line"> </div>
<div class="line">-- Case 2b 1MPI GMRES(10) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  116 its GS1  86 its</div>
<div class="line"> </div>
<div class="line">-- 8 MPI</div>
<div class="line"> </div>
<div class="line">-- GMRES(60)</div>
<div class="line">-- Case 0c 8MPI GMRES(60)</div>
<div class="line">-- GS0  39 its GS1 117 its</div>
<div class="line"> </div>
<div class="line">-- Case 1c 8MPI GMRES(60) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  32 its GS1 60 its</div>
<div class="line"> </div>
<div class="line">-- Case 2c 8MPI GMRES(60) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  32 its GS1  41 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">-- GMRES(30)</div>
<div class="line">-- Case 0c 8MPI GMRES(30)</div>
<div class="line">-- GS0  53 its GS1 239 its</div>
<div class="line"> </div>
<div class="line">-- Case 1c 8MPI GMRES(30) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  47 its GS1  110 its</div>
<div class="line"> </div>
<div class="line">-- Case 2c 8MPI GMRES(30) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  47 its GS1  56 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">-- GMRES(20)</div>
<div class="line">-- Case 0c 8MPI GMRES(20)</div>
<div class="line">-- GS0 109 its GS1 300 its</div>
<div class="line"> </div>
<div class="line">-- Case 1c 8MPI GMRES(20) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  57 its GS1 155 its</div>
<div class="line"> </div>
<div class="line">-- Case 2c 8MPI GMRES(20) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  57 its GS1  62 its</div>
<div class="line"> </div>
<div class="line">-- GMRES(10)</div>
<div class="line">-- Case 0d 8MPI GMRES(10)</div>
<div class="line">-- GS0  92 its GS1 410 its</div>
<div class="line"> </div>
<div class="line">-- Case 1d 8MPI GMRES(10) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  92 its GS1  inf its</div>
<div class="line"> </div>
<div class="line">-- Case 2d 8MPI GMRES(10) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  92 its GS1  98 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--=============================================== BICGSTAB comparisons</div>
<div class="line">-- Case 0a 1MPI GMRES(10)</div>
<div class="line">-- GS0  87 its GS1 262 its TTS=56</div>
<div class="line"> </div>
<div class="line">-- Case 0a 1MPI GMRES(30)</div>
<div class="line">-- GS0  54 its GS1 244 its TTS=46</div>
<div class="line"> </div>
<div class="line">-- Case 0a 1MPI GMRES(60)</div>
<div class="line">-- GS0  37 its GS1 102 its TTS=21</div>
<div class="line"> </div>
<div class="line">-- BICGSTAB</div>
<div class="line">-- Case 0a 1MPI BICGSTAB</div>
<div class="line">-- GS0  34 its GS1 73 its TTS=30</div>
<div class="ttc" id="anamespacelbs_html_a74e6ab7d8963411bcda1c642e3098508ac1bfd84e7215afa3204b8e1cdb21a2bd"><div class="ttname"><a href="../../d9/d42/namespacelbs.html#a74e6ab7d8963411bcda1c642e3098508ac1bfd84e7215afa3204b8e1cdb21a2bd">lbs::IterativeMethod::GMRES</a></div><div class="ttdeci">@ GMRES</div><div class="ttdoc">GMRES iterative algorithm.</div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport1D_4_DSA_ortho_inf_lua" name="tests_Transport_Steady_Transport1D_4_DSA_ortho_inf_lua"></a>tests/Transport_Steady/Transport1D_4_DSA_ortho_inf.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 1D LinearBSolver test of a block of graphite mimicking an infinite medium. DSA and TG</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: WGS groups [0-62] Iteration    22 Residual 9.6079e-08 CONVERGED</div>
<div class="line">-- and   WGS groups [63-167] Iteration    59 Residual 4.73732e-07 CONVERGED</div>
<div class="line">num_procs = 1</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=1</div>
<div class="line">L=1e6</div>
<div class="line">--N=10</div>
<div class="line">--L=200e6</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">--xmin_ = 0.0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#gabcd0e135b1081c3b9eb6661d44fb21d7">chiMeshCreateUnpartitioned1DOrthoMesh</a>(mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line">--vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-10.0,10.0,-10.0,10.0,-10.0,10.0)</div>
<div class="line">--<a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line">--############################################### Add materials</div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--num_groups = 1</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">--        SIMPLEXS1,num_groups,1.0,0.999)</div>
<div class="line">num_groups = 168</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_air50RH.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">src[1] = 1.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad0 = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2, 2,<span class="keyword">false</span>)</div>
<div class="line">pquad1 = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,8, 8,false)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line"> </div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,62)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad0)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_RICHARDSON_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_RICHARDSON_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,1000)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,30)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-2,false,&quot;&quot;)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot;&quot;)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">gs1 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line"> </div>
<div class="line">cur_gs = gs1</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,63,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad0)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_RICHARDSON_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_RICHARDSON_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,1000)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,30)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-2,false,&quot;&quot;)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot;&quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi;</div>
<div class="line">--bsrc[1] = 1.0</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMAX,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,YMIN,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,YMAX,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMIN,LBSBoundaryTypes.REFLECTING);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMAX,LBSBoundaryTypes.REFLECTING);</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    chiExportFieldFunctionToVTKG(fflist[1],<span class="stringliteral">&quot;ZPhi&quot;</span>,<span class="stringliteral">&quot;Phi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"> </div>
<div class="line">--############################################### Stats N=50</div>
<div class="line">-- Case 0a 1MPI <a class="code hl_enumvalue" href="../../d9/d42/namespacelbs.html#a74e6ab7d8963411bcda1c642e3098508ac1bfd84e7215afa3204b8e1cdb21a2bd">GMRES</a>(30)</div>
<div class="line">-- GS0  53 its GS1 240 its</div>
<div class="line"> </div>
<div class="line">-- Case 1a 1MPI <a class="code hl_enumvalue" href="../../d9/d42/namespacelbs.html#a74e6ab7d8963411bcda1c642e3098508ac1bfd84e7215afa3204b8e1cdb21a2bd">GMRES</a>(30) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  27 its GS1  62 its</div>
<div class="line"> </div>
<div class="line">-- Case 2a 1MPI GMRES(30) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  27 its GS1  33 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">-- Case 0a 1MPI GMRES(60)</div>
<div class="line">-- GS0  36 its GS1 70 its</div>
<div class="line"> </div>
<div class="line">-- Case 1a 1MPI GMRES(60) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  27 its GS1  42 its</div>
<div class="line"> </div>
<div class="line">-- Case 2a 1MPI GMRES(60) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  27 its GS1  32 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">-- GMRES(10)</div>
<div class="line">-- Case 0b 1MPI GMRES(10)</div>
<div class="line">-- GS0  96 its GS1 357 its</div>
<div class="line"> </div>
<div class="line">-- Case 1b 1MPI GMRES(10) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  116 its GS1  inf its</div>
<div class="line"> </div>
<div class="line">-- Case 2b 1MPI GMRES(10) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  116 its GS1  86 its</div>
<div class="line"> </div>
<div class="line">-- 8 MPI</div>
<div class="line"> </div>
<div class="line">-- GMRES(60)</div>
<div class="line">-- Case 0c 8MPI GMRES(60)</div>
<div class="line">-- GS0  39 its GS1 117 its</div>
<div class="line"> </div>
<div class="line">-- Case 1c 8MPI GMRES(60) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  32 its GS1 60 its</div>
<div class="line"> </div>
<div class="line">-- Case 2c 8MPI GMRES(60) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  32 its GS1  41 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">-- GMRES(30)</div>
<div class="line">-- Case 0c 8MPI GMRES(30)</div>
<div class="line">-- GS0  53 its GS1 239 its</div>
<div class="line"> </div>
<div class="line">-- Case 1c 8MPI GMRES(30) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  47 its GS1  110 its</div>
<div class="line"> </div>
<div class="line">-- Case 2c 8MPI GMRES(30) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  47 its GS1  56 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">-- GMRES(20)</div>
<div class="line">-- Case 0c 8MPI GMRES(20)</div>
<div class="line">-- GS0 109 its GS1 300 its</div>
<div class="line"> </div>
<div class="line">-- Case 1c 8MPI GMRES(20) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  57 its GS1 155 its</div>
<div class="line"> </div>
<div class="line">-- Case 2c 8MPI GMRES(20) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  57 its GS1  62 its</div>
<div class="line"> </div>
<div class="line">-- GMRES(10)</div>
<div class="line">-- Case 0d 8MPI GMRES(10)</div>
<div class="line">-- GS0  92 its GS1 410 its</div>
<div class="line"> </div>
<div class="line">-- Case 1d 8MPI GMRES(10) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  92 its GS1  inf its</div>
<div class="line"> </div>
<div class="line">-- Case 2d 8MPI GMRES(10) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  92 its GS1  98 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--=============================================== BICGSTAB comparisons</div>
<div class="line">-- Case 0a 1MPI GMRES(10)</div>
<div class="line">-- GS0  87 its GS1 262 its TTS=56</div>
<div class="line"> </div>
<div class="line">-- Case 0a 1MPI GMRES(30)</div>
<div class="line">-- GS0  54 its GS1 244 its TTS=46</div>
<div class="line"> </div>
<div class="line">-- Case 0a 1MPI GMRES(60)</div>
<div class="line">-- GS0  37 its GS1 102 its TTS=21</div>
<div class="line"> </div>
<div class="line">-- BICGSTAB</div>
<div class="line">-- Case 0a 1MPI BICGSTAB</div>
<div class="line">-- GS0  34 its GS1 73 its TTS=30</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport2D_1Poly_Balance_lua" name="tests_Transport_Steady_Transport2D_1Poly_Balance_lua"></a>tests/Transport_Steady/Transport2D_1Poly_Balance.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.50758 and 2.52527e-04</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line">-- <span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">--     <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">--                       <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">--                       <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">--     os.exit(<span class="keyword">false</span>)</div>
<div class="line">-- end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=20</div>
<div class="line">L=5</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,0,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 1</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,<span class="stringliteral">&quot;tests/Transport_Steady/simple_scatter.cxs&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/simple_scatter.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,SIMPLEXS0,num_groups,0.1)</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,SIMPLEXS0,num_groups,0.1)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 1.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">fac=1</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,4*fac, 3*fac)</div>
<div class="line"><a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chiOptimizeAngularQuadratureForPolarSymmetry</a>(pqaud, 4.0*math.pi)</div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,0)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-8)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">-- gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">-- cur_gs = gs0</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,1,62)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,2)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-4)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">-- gs1 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">-- cur_gs = gs1</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,63,167)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,2)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-4)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">-- bsrc={}</div>
<div class="line">-- <span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">--     bsrc[g] = 0.0</div>
<div class="line">-- end</div>
<div class="line">-- bsrc[1] = 1.0/4.0/math.pi</div>
<div class="line">-- <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,</div>
<div class="line">--                         LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,0)</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga1d82231c3f7a0661e4f8371498d933c7">chiLBSComputeBalance</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">slice2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,SLICE_POINT,0.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice2)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice2)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value1=%.5f&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[160])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value2=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice2)</div>
<div class="line">    chiExportFieldFunctionToVTKG(fflist[1],<span class="stringliteral">&quot;ZPhi3D&quot;</span>,<span class="stringliteral">&quot;Phi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">end</div>
<div class="ttc" id="agroup___lua_l_b_s_html_ga1d82231c3f7a0661e4f8371498d933c7"><div class="ttname"><a href="../../d0/daf/group___lua_l_b_s.html#ga1d82231c3f7a0661e4f8371498d933c7">chi_lua::chiLBSComputeBalance</a></div><div class="ttdeci">void chiLBSComputeBalance(int SolverIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04964">lua_functions.c:4964</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport2D_1Poly_BalanceMG_lua" name="tests_Transport_Steady_Transport2D_1Poly_BalanceMG_lua"></a>tests/Transport_Steady/Transport2D_1Poly_BalanceMG.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.50758 and 2.52527e-04</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line">-- <span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">--     <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">--                       <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">--                       <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">--     os.exit(<span class="keyword">false</span>)</div>
<div class="line">-- end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=20</div>
<div class="line">L=5</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,0,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 168</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,<span class="stringliteral">&quot;tests/Transport_Steady/xs_3_170.cxs&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_3_170.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,SIMPLEXS0,num_groups,0.1)</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,SIMPLEXS0,num_groups,0.1)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 1.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">fac=1</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,4*fac, 3*fac)</div>
<div class="line"><a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chiOptimizeAngularQuadratureForPolarSymmetry</a>(pqaud, 4.0*math.pi)</div>
<div class="line">--========== Groupset def</div>
<div class="line">-- gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">-- cur_gs = gs0</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,0)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-8)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,62)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-4)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">gs1 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs1</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,63,167)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-4)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,</div>
<div class="line">                        LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,0)</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga1d82231c3f7a0661e4f8371498d933c7">chiLBSComputeBalance</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">slice2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,SLICE_POINT,0.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice2)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice2)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value1=%.5f&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[160])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value2=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice2)</div>
<div class="line">    chiExportFieldFunctionToVTKG(fflist[1],<span class="stringliteral">&quot;ZPhi3D&quot;</span>,<span class="stringliteral">&quot;Phi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport2D_1Poly_lua" name="tests_Transport_Steady_Transport2D_1Poly_lua"></a>tests/Transport_Steady/Transport2D_1Poly.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.50758 and 2.52527e-04</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">umesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga0f476b765a307ec7a477c237134298c2">chiUnpartitionedMeshFromWavefrontOBJ</a>(</div>
<div class="line">        &quot;resources/TestMeshes/SquareMesh2x2QuadsBlock.obj&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED, umesh);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga84f96adcccf43678b5b94285a2291e66">chiVolumeMesherSetKBAPartitioningPxPyPz</a>(2,2,1)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga2048d69a09e224f5daf0ff4e6c4404e4">chiVolumeMesherSetKBACutsX</a>({0.0})</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gae5015130ffe27744255aa29b3e704eb7">chiVolumeMesherSetKBACutsY</a>({0.0})</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">PARTITION_TYPE</a>,KBA_STYLE_XYZ)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 168</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,<span class="stringliteral">&quot;tests/Transport_Steady/xs_3_170.cxs&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_3_170.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,SIMPLEXS0,num_groups,0.1)</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,SIMPLEXS0,num_groups,0.1)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">--src[1] = 1.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2, 1)</div>
<div class="line"><a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chiOptimizeAngularQuadratureForPolarSymmetry</a>(pqaud, 4.0*math.pi)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,62)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,2)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">gs1 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs1</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,63,167)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,2)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,</div>
<div class="line">                        LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">slice2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,SLICE_POINT,0.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice2)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice2)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value1=%.5f&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[160])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value2=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice2)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Plots</div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport2D_1Poly_PsiTest_lua" name="tests_Transport_Steady_Transport2D_1Poly_PsiTest_lua"></a>tests/Transport_Steady/Transport2D_1Poly_PsiTest.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.50758 and 2.52527e-04</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga0f476b765a307ec7a477c237134298c2">chiUnpartitionedMeshFromWavefrontOBJ</a>(</div>
<div class="line">        &quot;resources/TestMeshes/SquareMesh2x2QuadsBlock.obj&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga84f96adcccf43678b5b94285a2291e66">chiVolumeMesherSetKBAPartitioningPxPyPz</a>(2,2,1)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga2048d69a09e224f5daf0ff4e6c4404e4">chiVolumeMesherSetKBACutsX</a>({0.0})</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gae5015130ffe27744255aa29b3e704eb7">chiVolumeMesherSetKBACutsY</a>({0.0})</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">PARTITION_TYPE</a>,KBA_STYLE_XYZ)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 168</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,<span class="stringliteral">&quot;tests/Transport_Steady/xs_3_170.cxs&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_3_170.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,SIMPLEXS0,num_groups,0.1)</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,SIMPLEXS0,num_groups,0.1)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">--src[1] = 1.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2, 1)</div>
<div class="line"><a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chiOptimizeAngularQuadratureForPolarSymmetry</a>(pqaud, 4.0*math.pi)</div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,62)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,2)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">-- gs1 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">-- cur_gs = gs1</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,63,167)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,2)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line">-- --<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line">-- --<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,</div>
<div class="line">                        LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,LBSProperty.SAVE_ANGULAR_FLUX,true)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line">-- <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a73c97de153015dbb06ea5025628211c1">chiLBSWriteGroupsetAngularFlux</a>(phys1,gs0,<span class="stringliteral">&quot;ZPsi&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line">if (chi_location_id == 0) then</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a8caffc672507f77c683cee0f3456f350">chiLBSReadGroupsetAngularFlux</a>(phys1,gs0,&quot;ZPsi&quot;)</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Get field functions</span></div>
<div class="line">-- <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a73c97de153015dbb06ea5025628211c1">chiLBSWriteGroupsetAngularFlux</a>(phys1,gs0,<span class="stringliteral">&quot;ZPsi&quot;</span>)</div>
<div class="line">-- <span class="keywordflow">if</span> (chi_location_id == 0) then</div>
<div class="line">--     <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a8caffc672507f77c683cee0f3456f350">chiLBSReadGroupsetAngularFlux</a>(phys1,gs0,<span class="stringliteral">&quot;ZPsi&quot;</span>)</div>
<div class="line">-- end</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">slice2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,SLICE_POINT,0.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice2)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice2)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value1=%.5f&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[160])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value2=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice2)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Plots</div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">end</div>
<div class="ttc" id="anamespacechi__lua_html_a73c97de153015dbb06ea5025628211c1"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#a73c97de153015dbb06ea5025628211c1">chi_lua::chiLBSWriteGroupsetAngularFlux</a></div><div class="ttdeci">void chiLBSWriteGroupsetAngularFlux(int SolverIndex, int GroupsetIndex, string file_base)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04804">lua_functions.c:4804</a></div></div>
<div class="ttc" id="anamespacechi__lua_html_a8caffc672507f77c683cee0f3456f350"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#a8caffc672507f77c683cee0f3456f350">chi_lua::chiLBSReadGroupsetAngularFlux</a></div><div class="ttdeci">void chiLBSReadGroupsetAngularFlux(int SolverIndex, int GroupsetIndex, string file_base)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04819">lua_functions.c:4819</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport2D_2Unstructured_lua" name="tests_Transport_Steady_Transport2D_2Unstructured_lua"></a>tests/Transport_Steady/Transport2D_2Unstructured.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.51187 and 1.42458e-03</div>
<div class="line">num_procs = 4</div>
<div class="line">--Unstructured mesh</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">umesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga0f476b765a307ec7a477c237134298c2">chiUnpartitionedMeshFromWavefrontOBJ</a>(</div>
<div class="line">        &quot;resources/TestMeshes/TriangleMesh2x2Cuts.obj&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED, umesh);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga84f96adcccf43678b5b94285a2291e66">chiVolumeMesherSetKBAPartitioningPxPyPz</a>(2,2,1)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga2048d69a09e224f5daf0ff4e6c4404e4">chiVolumeMesherSetKBACutsX</a>({0.0})</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gae5015130ffe27744255aa29b3e704eb7">chiVolumeMesherSetKBACutsY</a>({0.0})</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">PARTITION_TYPE</a>,KBA_STYLE_XYZ)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 168</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,<span class="stringliteral">&quot;tests/Transport_Steady/xs_3_170.cxs&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_3_170.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,SIMPLEXS0,num_groups,0.1)</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,SIMPLEXS0,num_groups,0.1)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">--src[1] = 1.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,8, 4)</div>
<div class="line"><a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chiOptimizeAngularQuadratureForPolarSymmetry</a>(pqaud, 4.0*math.pi)</div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,62)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,2)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">gs1 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs1</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,63,167)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,2)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,</div>
<div class="line">                        LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">slice2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,SLICE_POINT,0.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice2)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice2)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value1=%.5f&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[10])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value2=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice2)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Plots</div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport2D_3Poly_quad_mod_lua" name="tests_Transport_Steady_Transport2D_3Poly_quad_mod_lua"></a>tests/Transport_Steady/Transport2D_3Poly_quad_mod.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC. Quadrature optimized <span class="keywordflow">for</span> polar symmetry.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.50758 and 2.52527e-04</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">umesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga0f476b765a307ec7a477c237134298c2">chiUnpartitionedMeshFromWavefrontOBJ</a>(</div>
<div class="line">        &quot;resources/TestMeshes/SquareMesh2x2QuadsBlock.obj&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED, umesh);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga84f96adcccf43678b5b94285a2291e66">chiVolumeMesherSetKBAPartitioningPxPyPz</a>(2,2,1)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga2048d69a09e224f5daf0ff4e6c4404e4">chiVolumeMesherSetKBACutsX</a>({0.0})</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gae5015130ffe27744255aa29b3e704eb7">chiVolumeMesherSetKBACutsY</a>({0.0})</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">PARTITION_TYPE</a>,KBA_STYLE_XYZ)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 168</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,<span class="stringliteral">&quot;tests/Transport_Steady/xs_3_170.cxs&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_3_170.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,SIMPLEXS0,num_groups,0.1)</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,SIMPLEXS0,num_groups,0.1)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">--src[1] = 1.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2, 1)</div>
<div class="line"><a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chiOptimizeAngularQuadratureForPolarSymmetry</a>(pqaud, 4.0*math.pi)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,62)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,2)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">gs1 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs1</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,63,167)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,2)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,</div>
<div class="line">                        LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">slice2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,SLICE_POINT,0.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice2)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice2)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value1=%.5f&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[160])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value2=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice2)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Plots</div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport2D_4a_DSA_ortho_lua" name="tests_Transport_Steady_Transport2D_4a_DSA_ortho_lua"></a>tests/Transport_Steady/Transport2D_4a_DSA_ortho.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D LinearBSolver test of a block of graphite with an air cavity. DSA and TG</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: WGS groups [0-62] Iteration    53 Residual 5.96018e-07 CONVERGED</div>
<div class="line">-- and   WGS groups [63-167] Iteration    59 Residual 5.96296e-07 CONVERGED</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=20</div>
<div class="line">L=100</div>
<div class="line">--N=10</div>
<div class="line">--L=200e6</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">--xmin_ = 0.0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line">--<a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#gabcd0e135b1081c3b9eb6661d44fb21d7">chiMeshCreateUnpartitioned1DOrthoMesh</a>(mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-10.0,10.0,-10.0,10.0,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--num_groups = 1</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">--        SIMPLEXS1,num_groups,1.0,0.999)</div>
<div class="line">num_groups = 168</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_air50RH.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">src[1] = 1.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad0 = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2, 2,<span class="keyword">false</span>)</div>
<div class="line"><a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chiOptimizeAngularQuadratureForPolarSymmetry</a>(pqaud, 4.0*math.pi)</div>
<div class="line">pquad1 = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,8, 8,false)</div>
<div class="line"><a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chiOptimizeAngularQuadratureForPolarSymmetry</a>(pqaud1, 4.0*math.pi)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line"> </div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,62)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad0)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_RICHARDSON_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,1000)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,30)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-2,false,&quot;&quot;)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot;&quot;)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">gs1 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line"> </div>
<div class="line">cur_gs = gs1</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,63,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad0)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_RICHARDSON_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,1000)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,30)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-2,false,&quot;&quot;)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot;&quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi;</div>
<div class="line">--bsrc[1] = 1.0</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMAX,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,YMIN,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,YMAX,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMIN,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMAX,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    chiExportFieldFunctionToVTKG(fflist[1],<span class="stringliteral">&quot;ZPhi&quot;</span>,<span class="stringliteral">&quot;Phi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"> </div>
<div class="line">--############################################### Stats N=50</div>
<div class="line">-- Case 0a 1MPI <a class="code hl_enumvalue" href="../../d9/d42/namespacelbs.html#a74e6ab7d8963411bcda1c642e3098508ac1bfd84e7215afa3204b8e1cdb21a2bd">GMRES</a>(30)</div>
<div class="line">-- GS0  53 its GS1 240 its</div>
<div class="line"> </div>
<div class="line">-- Case 1a 1MPI <a class="code hl_enumvalue" href="../../d9/d42/namespacelbs.html#a74e6ab7d8963411bcda1c642e3098508ac1bfd84e7215afa3204b8e1cdb21a2bd">GMRES</a>(30) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  27 its GS1  62 its</div>
<div class="line"> </div>
<div class="line">-- Case 2a 1MPI GMRES(30) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  27 its GS1  33 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">-- Case 0a 1MPI GMRES(60)</div>
<div class="line">-- GS0  36 its GS1 70 its</div>
<div class="line"> </div>
<div class="line">-- Case 1a 1MPI GMRES(60) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  27 its GS1  42 its</div>
<div class="line"> </div>
<div class="line">-- Case 2a 1MPI GMRES(60) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  27 its GS1  32 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">-- GMRES(10)</div>
<div class="line">-- Case 0b 1MPI GMRES(10)</div>
<div class="line">-- GS0  96 its GS1 357 its</div>
<div class="line"> </div>
<div class="line">-- Case 1b 1MPI GMRES(10) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  116 its GS1  inf its</div>
<div class="line"> </div>
<div class="line">-- Case 2b 1MPI GMRES(10) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  116 its GS1  86 its</div>
<div class="line"> </div>
<div class="line">-- 8 MPI</div>
<div class="line"> </div>
<div class="line">-- GMRES(60)</div>
<div class="line">-- Case 0c 8MPI GMRES(60)</div>
<div class="line">-- GS0  39 its GS1 117 its</div>
<div class="line"> </div>
<div class="line">-- Case 1c 8MPI GMRES(60) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  32 its GS1 60 its</div>
<div class="line"> </div>
<div class="line">-- Case 2c 8MPI GMRES(60) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  32 its GS1  41 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">-- GMRES(30)</div>
<div class="line">-- Case 0c 8MPI GMRES(30)</div>
<div class="line">-- GS0  53 its GS1 239 its</div>
<div class="line"> </div>
<div class="line">-- Case 1c 8MPI GMRES(30) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  47 its GS1  110 its</div>
<div class="line"> </div>
<div class="line">-- Case 2c 8MPI GMRES(30) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  47 its GS1  56 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">-- GMRES(20)</div>
<div class="line">-- Case 0c 8MPI GMRES(20)</div>
<div class="line">-- GS0 109 its GS1 300 its</div>
<div class="line"> </div>
<div class="line">-- Case 1c 8MPI GMRES(20) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  57 its GS1 155 its</div>
<div class="line"> </div>
<div class="line">-- Case 2c 8MPI GMRES(20) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  57 its GS1  62 its</div>
<div class="line"> </div>
<div class="line">-- GMRES(10)</div>
<div class="line">-- Case 0d 8MPI GMRES(10)</div>
<div class="line">-- GS0  92 its GS1 410 its</div>
<div class="line"> </div>
<div class="line">-- Case 1d 8MPI GMRES(10) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  92 its GS1  inf its</div>
<div class="line"> </div>
<div class="line">-- Case 2d 8MPI GMRES(10) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  92 its GS1  98 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--=============================================== BICGSTAB comparisons</div>
<div class="line">-- Case 0a 1MPI GMRES(10)</div>
<div class="line">-- GS0  87 its GS1 262 its TTS=56</div>
<div class="line"> </div>
<div class="line">-- Case 0a 1MPI GMRES(30)</div>
<div class="line">-- GS0  54 its GS1 244 its TTS=46</div>
<div class="line"> </div>
<div class="line">-- Case 0a 1MPI GMRES(60)</div>
<div class="line">-- GS0  37 its GS1 102 its TTS=21</div>
<div class="line"> </div>
<div class="line">-- BICGSTAB</div>
<div class="line">-- Case 0a 1MPI BICGSTAB</div>
<div class="line">-- GS0  34 its GS1 73 its TTS=30</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport2D_4b_DSA_ortho_lua" name="tests_Transport_Steady_Transport2D_4b_DSA_ortho_lua"></a>tests/Transport_Steady/Transport2D_4b_DSA_ortho.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D LinearBSolver Same as 4a but with reflective BCs. DSA and TG</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: WGS groups [0-62] Iteration    54 Residual 5.00021e-07 CONVERGED</div>
<div class="line">-- and   WGS groups [63-167] Iteration    56 Residual 9.73954e-07 CONVERGED</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=20</div>
<div class="line">L=100</div>
<div class="line">--N=10</div>
<div class="line">--L=200e6</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">--xmin_ = 0.0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line">--<a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#gabcd0e135b1081c3b9eb6661d44fb21d7">chiMeshCreateUnpartitioned1DOrthoMesh</a>(mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-10.0,10.0,-10.0,10.0,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--num_groups = 1</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">--        SIMPLEXS1,num_groups,1.0,0.999)</div>
<div class="line">num_groups = 168</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_air50RH.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">src[1] = 1.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad0 = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2, 2,<span class="keyword">false</span>)</div>
<div class="line"><a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chiOptimizeAngularQuadratureForPolarSymmetry</a>(pqaud, 4.0*math.pi)</div>
<div class="line">pquad1 = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,8, 8,false)</div>
<div class="line"><a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chiOptimizeAngularQuadratureForPolarSymmetry</a>(pqaud1, 4.0*math.pi)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line"> </div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,62)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad0)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_RICHARDSON_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,1000)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,30)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-2,false,&quot;&quot;)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot;&quot;)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">gs1 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line"> </div>
<div class="line">cur_gs = gs1</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,63,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad0)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_RICHARDSON_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,1000)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,30)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-2,false,&quot;&quot;)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot;&quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi;</div>
<div class="line">--bsrc[1] = 1.0</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,LBSBoundaryTypes.REFLECTING);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMAX,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,YMIN,LBSBoundaryTypes.REFLECTING);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,YMAX,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMIN,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMAX,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    chiExportFieldFunctionToVTKG(fflist[1],<span class="stringliteral">&quot;ZPhi&quot;</span>,<span class="stringliteral">&quot;Phi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"> </div>
<div class="line">--############################################### Stats N=50</div>
<div class="line">-- Case 0a 1MPI <a class="code hl_enumvalue" href="../../d9/d42/namespacelbs.html#a74e6ab7d8963411bcda1c642e3098508ac1bfd84e7215afa3204b8e1cdb21a2bd">GMRES</a>(30)</div>
<div class="line">-- GS0  53 its GS1 240 its</div>
<div class="line"> </div>
<div class="line">-- Case 1a 1MPI <a class="code hl_enumvalue" href="../../d9/d42/namespacelbs.html#a74e6ab7d8963411bcda1c642e3098508ac1bfd84e7215afa3204b8e1cdb21a2bd">GMRES</a>(30) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  27 its GS1  62 its</div>
<div class="line"> </div>
<div class="line">-- Case 2a 1MPI GMRES(30) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  27 its GS1  33 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">-- Case 0a 1MPI GMRES(60)</div>
<div class="line">-- GS0  36 its GS1 70 its</div>
<div class="line"> </div>
<div class="line">-- Case 1a 1MPI GMRES(60) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  27 its GS1  42 its</div>
<div class="line"> </div>
<div class="line">-- Case 2a 1MPI GMRES(60) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  27 its GS1  32 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">-- GMRES(10)</div>
<div class="line">-- Case 0b 1MPI GMRES(10)</div>
<div class="line">-- GS0  96 its GS1 357 its</div>
<div class="line"> </div>
<div class="line">-- Case 1b 1MPI GMRES(10) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  116 its GS1  inf its</div>
<div class="line"> </div>
<div class="line">-- Case 2b 1MPI GMRES(10) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  116 its GS1  86 its</div>
<div class="line"> </div>
<div class="line">-- 8 MPI</div>
<div class="line"> </div>
<div class="line">-- GMRES(60)</div>
<div class="line">-- Case 0c 8MPI GMRES(60)</div>
<div class="line">-- GS0  39 its GS1 117 its</div>
<div class="line"> </div>
<div class="line">-- Case 1c 8MPI GMRES(60) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  32 its GS1 60 its</div>
<div class="line"> </div>
<div class="line">-- Case 2c 8MPI GMRES(60) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  32 its GS1  41 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">-- GMRES(30)</div>
<div class="line">-- Case 0c 8MPI GMRES(30)</div>
<div class="line">-- GS0  53 its GS1 239 its</div>
<div class="line"> </div>
<div class="line">-- Case 1c 8MPI GMRES(30) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  47 its GS1  110 its</div>
<div class="line"> </div>
<div class="line">-- Case 2c 8MPI GMRES(30) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  47 its GS1  56 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">-- GMRES(20)</div>
<div class="line">-- Case 0c 8MPI GMRES(20)</div>
<div class="line">-- GS0 109 its GS1 300 its</div>
<div class="line"> </div>
<div class="line">-- Case 1c 8MPI GMRES(20) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  57 its GS1 155 its</div>
<div class="line"> </div>
<div class="line">-- Case 2c 8MPI GMRES(20) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  57 its GS1  62 its</div>
<div class="line"> </div>
<div class="line">-- GMRES(10)</div>
<div class="line">-- Case 0d 8MPI GMRES(10)</div>
<div class="line">-- GS0  92 its GS1 410 its</div>
<div class="line"> </div>
<div class="line">-- Case 1d 8MPI GMRES(10) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  92 its GS1  inf its</div>
<div class="line"> </div>
<div class="line">-- Case 2d 8MPI GMRES(10) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  92 its GS1  98 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--=============================================== BICGSTAB comparisons</div>
<div class="line">-- Case 0a 1MPI GMRES(10)</div>
<div class="line">-- GS0  87 its GS1 262 its TTS=56</div>
<div class="line"> </div>
<div class="line">-- Case 0a 1MPI GMRES(30)</div>
<div class="line">-- GS0  54 its GS1 244 its TTS=46</div>
<div class="line"> </div>
<div class="line">-- Case 0a 1MPI GMRES(60)</div>
<div class="line">-- GS0  37 its GS1 102 its TTS=21</div>
<div class="line"> </div>
<div class="line">-- BICGSTAB</div>
<div class="line">-- Case 0a 1MPI BICGSTAB</div>
<div class="line">-- GS0  34 its GS1 73 its TTS=30</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport2D_5PolyA_AniHeteroBndry_lua" name="tests_Transport_Steady_Transport2D_5PolyA_AniHeteroBndry_lua"></a>tests/Transport_Steady/Transport2D_5PolyA_AniHeteroBndry.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value1=3.18785</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">            <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">            <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=40</div>
<div class="line">L=10.0</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line">--############################################### Add materials</div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 1</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,<span class="stringliteral">&quot;tests/Transport_Steady/xs_air50RH.cxs&quot;</span>)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">--src[1] = 1.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,12, 2)</div>
<div class="line"><a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chiOptimizeAngularQuadratureForPolarSymmetry</a>(pqaud, 4.0*math.pi)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,0)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,2)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">--<span class="keywordtype">int</span> cell_global_id</div>
<div class="line">--<span class="keywordtype">int</span> material_id</div>
<div class="line"> </div>
<div class="line">--VecXYZ location (.x .y and .z)</div>
<div class="line">--VecXYZ normal</div>
<div class="line"> </div>
<div class="line">--array&lt;int&gt;      quadrature_angle_indices</div>
<div class="line">--array&lt;VecXYZ&gt;   quadrature_angle_vectors</div>
<div class="line">--array&lt;PhiTheta&gt; quadrature_phi_theta_angles (PhiTheta.phi and PhiTheta.theta)</div>
<div class="line">--array&lt;int&gt;      group_indices</div>
<div class="line"> </div>
<div class="line">--<span class="keywordtype">double</span>          evaluation_time</div>
<div class="line">function luaBoundaryFunctionA(cell_global_id,</div>
<div class="line">                              material_id,</div>
<div class="line">                              location,</div>
<div class="line">                              normal,</div>
<div class="line">                              quadrature_angle_indices,</div>
<div class="line">                              quadrature_angle_vectors,</div>
<div class="line">                              quadrature_phi_theta_angles,</div>
<div class="line">                              group_indices,</div>
<div class="line">                              time)</div>
<div class="line">    num_angles = rawlen(quadrature_angle_vectors)</div>
<div class="line">    num_groups = rawlen(group_indices)</div>
<div class="line">    psi = {}</div>
<div class="line">    dof_count = 0</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> ni=1,num_angles <span class="keywordflow">do</span></div>
<div class="line">        omega = quadrature_angle_vectors[ni]</div>
<div class="line">        phi_theta = quadrature_phi_theta_angles[ni]</div>
<div class="line">        <span class="keywordflow">for</span> gi=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">            g = group_indices[gi]</div>
<div class="line"> </div>
<div class="line">            value = 1.0</div>
<div class="line">            <span class="keywordflow">if</span> (location.y &lt; 0.0 or omega.y &lt; 0.0) then</div>
<div class="line">                value = 0.0</div>
<div class="line">            end</div>
<div class="line"> </div>
<div class="line">            dof_count = dof_count + 1</div>
<div class="line">            psi[dof_count] = value</div>
<div class="line">        end</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> psi</div>
<div class="line">end</div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> boundary conditions</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,</div>
<div class="line">--        LBSBoundaryTypes.INCIDENT_ISOTROPIC, bsrc);</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,</div>
<div class="line">        LBSBoundaryTypes.INCIDENT_ANISTROPIC_HETEROGENEOUS,</div>
<div class="line">        <span class="stringliteral">&quot;luaBoundaryFunctionA&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">slice2 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,SLICE_POINT,0.0,0.0,0.025)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slice2,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slice2)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slice2)</div>
<div class="line"> </div>
<div class="line">----<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Max-value1=%.5f&quot;, maxval))</div>
<div class="line"> </div>
<div class="line">----<span class="preprocessor">############################################### Volume integrations</span></div>
<div class="line">--ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">--curffi = ffi1</div>
<div class="line">--<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line">--<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line">--<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[160])</div>
<div class="line">--</div>
<div class="line">--<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line">--<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">--maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line">--</div>
<div class="line">--<a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value2=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> master_export == nil then</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slice2)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Plots</div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line">    local handle = io.popen(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport3D_1a_Extruder_lua" name="tests_Transport_Steady_Transport3D_1a_Extruder_lua"></a>tests/Transport_Steady/Transport3D_1a_Extruder.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 3D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=5.27450e-01 and 3.76339e-04</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">unpart_mesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga0f476b765a307ec7a477c237134298c2">chiUnpartitionedMeshFromWavefrontOBJ</a>(</div>
<div class="line">        &quot;resources/TestMeshes/SquareMesh2x2Quads.obj&quot;,true)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_EXTRUDER,</div>
<div class="line">                      ExtruderTemplateType.UNPARTITIONED_MESH,</div>
<div class="line">                      unpart_mesh);</div>
<div class="line"> </div>
<div class="line">NZ=2</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2*NZ,NZ,&quot;Charlie&quot;);--0.4</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2*NZ,NZ,&quot;Chuck&quot;);--0.8</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2*NZ,NZ,&quot;Bob&quot;);--1.2</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2*NZ,NZ,&quot;SarahConner&quot;);--1.6</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">PARTITION_TYPE</a>,KBA_STYLE_XYZ)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga84f96adcccf43678b5b94285a2291e66">chiVolumeMesherSetKBAPartitioningPxPyPz</a>(2,2,1)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga2048d69a09e224f5daf0ff4e6c4404e4">chiVolumeMesherSetKBACutsX</a>({0.0})</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gae5015130ffe27744255aa29b3e704eb7">chiVolumeMesherSetKBACutsY</a>({0.0})</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.5,0.5,-0.5,0.5,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 21</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,<span class="stringliteral">&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line"> </div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2, 2)</div>
<div class="line">pquad2 = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,5, 5)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,20)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga8f9de7a927209f9d2988404bd1eb7d83">chiLBSGroupsetSetAngleAggregationType</a>(phys1,cur_gs,LBSGroupset.ANGLE_AGG_SINGLE)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line">if (master_export == nil) then</div>
<div class="line">    --<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga0d55640ff00a44cf4d2167ed04e5e634">chiLBSGroupsetSetEnableSweepLog</a>(phys1,cur_gs,true)</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi;</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMIN,LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">--slices = {}</div>
<div class="line">--<span class="keywordflow">for</span> k=1,count <span class="keywordflow">do</span></div>
<div class="line">--    slices[k] = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_POINT,0.0,0.0,0.8001)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],ADD_FIELDFUNCTION,fflist[k])</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_TANGENT,0.393,1.0-0.393,0)</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_NORMAL,-(1.0-0.393),-0.393,0.0)</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_BINORM,0.0,0.0,1.0)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slices[k])</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slices[k])</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slices[k])</div>
<div class="line">--end</div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value1=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[20])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value2=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    chiExportFieldFunctionToVTKG(fflist[1],<span class="stringliteral">&quot;ZPhi3D&quot;</span>,<span class="stringliteral">&quot;Phi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line"> </div>
<div class="line">    --os.execute(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">    ----os.execute(<span class="stringliteral">&quot;python ZPFFI11.py&quot;</span>)</div>
<div class="line">    --local handle = io.popen(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">    print(<span class="stringliteral">&quot;Execution completed&quot;</span>)</div>
<div class="line">end</div>
<div class="ttc" id="agroup___lua_l_b_s_groupsets_html_ga0d55640ff00a44cf4d2167ed04e5e634"><div class="ttname"><a href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga0d55640ff00a44cf4d2167ed04e5e634">chi_lua::chiLBSGroupsetSetEnableSweepLog</a></div><div class="ttdeci">void chiLBSGroupsetSetEnableSweepLog(int SolverIndex, int GroupsetIndex, bool flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04540">lua_functions.c:4540</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport3D_1b_Ortho_lua" name="tests_Transport_Steady_Transport3D_1b_Ortho_lua"></a>tests/Transport_Steady/Transport3D_1b_Ortho.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 3D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=5.28310e-01 and 8.04576e-04</div>
<div class="line">num_procs = 4</div>
<div class="line"><span class="keywordflow">if</span> (reflecting == nil) then reflecting = <span class="keyword">true</span> end</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=10</div>
<div class="line">L=5</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line">zmesh={}</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N/2+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    zmesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"><span class="keywordflow">if</span> (reflecting) then</div>
<div class="line">    <a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga12dcd80ee2ab6104ba6e7142d7885221">chiMeshCreateUnpartitioned3DOrthoMesh</a>(mesh,mesh,zmesh)</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">    <a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga12dcd80ee2ab6104ba6e7142d7885221">chiMeshCreateUnpartitioned3DOrthoMesh</a>(mesh,mesh,mesh)</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 21</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,<span class="stringliteral">&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;</span>)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line"> </div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2, 2)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,20)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga8f9de7a927209f9d2988404bd1eb7d83">chiLBSGroupsetSetAngleAggregationType</a>(phys1,cur_gs,LBSGroupset.ANGLE_AGG_SINGLE)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi;</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"><span class="keywordflow">if</span> (reflecting) then</div>
<div class="line">    <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMAX,LBSBoundaryTypes.REFLECTING,bsrc);</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">--slices = {}</div>
<div class="line">--<span class="keywordflow">for</span> k=1,count <span class="keywordflow">do</span></div>
<div class="line">--    slices[k] = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_POINT,0.0,0.0,0.8001)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],ADD_FIELDFUNCTION,fflist[k])</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_TANGENT,0.393,1.0-0.393,0)</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_NORMAL,-(1.0-0.393),-0.393,0.0)</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_BINORM,0.0,0.0,1.0)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slices[k])</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slices[k])</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slices[k])</div>
<div class="line">--end</div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value1=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[20])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value2=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <span class="keywordflow">if</span> (reflecting) then</div>
<div class="line">        chiExportFieldFunctionToVTKG(fflist[1],<span class="stringliteral">&quot;ZPhi3DReflected&quot;</span>,<span class="stringliteral">&quot;Phi&quot;</span>)</div>
<div class="line">    else</div>
<div class="line">        chiExportFieldFunctionToVTKG(fflist[1],&quot;ZPhi3D&quot;,&quot;Phi&quot;)</div>
<div class="line">    end</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line"> </div>
<div class="line">    --os.execute(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">    ----os.execute(<span class="stringliteral">&quot;python ZPFFI11.py&quot;</span>)</div>
<div class="line">    --local handle = io.popen(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">    print(<span class="stringliteral">&quot;Execution completed&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport3D_1Poly_parmetis_FF_lua" name="tests_Transport_Steady_Transport3D_1Poly_parmetis_FF_lua"></a>tests/Transport_Steady/Transport3D_1Poly_parmetis_FF.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 3D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.49903 and 7.18243e-4</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">Nxy = 32</div>
<div class="line">nodesxy = {}</div>
<div class="line">dxy = 2/Nxy</div>
<div class="line">dz = 1.6/8</div>
<div class="line"><span class="keywordflow">for</span> i=0,(Nxy) <span class="keywordflow">do</span></div>
<div class="line">    nodesxy[i+1] = -1.0 + i*dxy</div>
<div class="line">end</div>
<div class="line">nodesz = {}</div>
<div class="line"><span class="keywordflow">for</span> k=0,8 <span class="keywordflow">do</span></div>
<div class="line">    nodesz[k+1] = 0.0 + k*dz</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga12dcd80ee2ab6104ba6e7142d7885221">chiMeshCreateUnpartitioned3DOrthoMesh</a>(nodesxy,nodesxy,nodesz)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">PARTITION_TYPE</a>,PARMETIS)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.5,0.5,-0.5,0.5,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 21</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,<span class="stringliteral">&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line"> </div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2, 2)</div>
<div class="line">pquad2 = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,5, 5)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,20)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga8f9de7a927209f9d2988404bd1eb7d83">chiLBSGroupsetSetAngleAggregationType</a>(phys1,cur_gs,LBSGroupset.ANGLE_AGG_SINGLE)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line">if (master_export == nil) then</div>
<div class="line">    --<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga0d55640ff00a44cf4d2167ed04e5e634">chiLBSGroupsetSetEnableSweepLog</a>(phys1,cur_gs,true)</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi;</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMIN,LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">solver_name = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga809364d0d36788e4674f4d669364bd39">chiSolverGetName</a>(phys1)</div>
<div class="line"> </div>
<div class="line">lbs_ff_g0_m0 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..<span class="stringliteral">&quot;Flux_g0_m0&quot;</span>)</div>
<div class="line">lbs_ff_g0_m1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..&quot;Flux_g0_m1&quot;)</div>
<div class="line">lbs_ff_g0_m2 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..&quot;Flux_g0_m2&quot;)</div>
<div class="line">lbs_ff_g0_m3 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..&quot;Flux_g0_m3&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chiExportMultiFieldFunctionToVTK</a>({lbs_ff_g0_m0,</div>
<div class="line">                                  lbs_ff_g0_m1,</div>
<div class="line">                                  lbs_ff_g0_m2,</div>
<div class="line">                                  lbs_ff_g0_m3}, <span class="stringliteral">&quot;ZBullshit&quot;</span>)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">--slices = {}</div>
<div class="line">--<span class="keywordflow">for</span> k=1,count <span class="keywordflow">do</span></div>
<div class="line">--    slices[k] = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_POINT,0.0,0.0,0.8001)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],ADD_FIELDFUNCTION,fflist[k])</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_TANGENT,0.393,1.0-0.393,0)</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_NORMAL,-(1.0-0.393),-0.393,0.0)</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_BINORM,0.0,0.0,1.0)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slices[k])</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slices[k])</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slices[k])</div>
<div class="line">--end</div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value1=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[20])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value2=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    chiExportFieldFunctionToVTKG(fflist[1],<span class="stringliteral">&quot;ZPhi3D&quot;</span>,<span class="stringliteral">&quot;Phi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line"> </div>
<div class="line">    --os.execute(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">    ----os.execute(<span class="stringliteral">&quot;python ZPFFI11.py&quot;</span>)</div>
<div class="line">    --local handle = io.popen(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">    print(<span class="stringliteral">&quot;Execution completed&quot;</span>)</div>
<div class="line">end</div>
<div class="ttc" id="agroup___lua_solver_html_ga809364d0d36788e4674f4d669364bd39"><div class="ttname"><a href="../../dc/d4e/group___lua_solver.html#ga809364d0d36788e4674f4d669364bd39">chi_lua::chiSolverGetName</a></div><div class="ttdeci">void chiSolverGetName(int solver_handle)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00591">lua_functions.c:591</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport3D_1Poly_parmetis_lua" name="tests_Transport_Steady_Transport3D_1Poly_parmetis_lua"></a>tests/Transport_Steady/Transport3D_1Poly_parmetis.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 3D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=0.49903 and 7.18243e-4</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">Nxy = 32</div>
<div class="line">nodesxy = {}</div>
<div class="line">dxy = 2/Nxy</div>
<div class="line">dz = 1.6/8</div>
<div class="line"><span class="keywordflow">for</span> i=0,(Nxy) <span class="keywordflow">do</span></div>
<div class="line">    nodesxy[i+1] = -1.0 + i*dxy</div>
<div class="line">end</div>
<div class="line">nodesz = {}</div>
<div class="line"><span class="keywordflow">for</span> k=0,8 <span class="keywordflow">do</span></div>
<div class="line">    nodesz[k+1] = 0.0 + k*dz</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga12dcd80ee2ab6104ba6e7142d7885221">chiMeshCreateUnpartitioned3DOrthoMesh</a>(nodesxy,nodesxy,nodesz)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">PARTITION_TYPE</a>,PARMETIS)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.5,0.5,-0.5,0.5,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 21</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,<span class="stringliteral">&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line"> </div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2, 2)</div>
<div class="line">pquad2 = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,5, 5)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,20)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga8f9de7a927209f9d2988404bd1eb7d83">chiLBSGroupsetSetAngleAggregationType</a>(phys1,cur_gs,LBSGroupset.ANGLE_AGG_SINGLE)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line">if (master_export == nil) then</div>
<div class="line">    --<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga0d55640ff00a44cf4d2167ed04e5e634">chiLBSGroupsetSetEnableSweepLog</a>(phys1,cur_gs,true)</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi;</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMIN,LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">--slices = {}</div>
<div class="line">--<span class="keywordflow">for</span> k=1,count <span class="keywordflow">do</span></div>
<div class="line">--    slices[k] = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_POINT,0.0,0.0,0.8001)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],ADD_FIELDFUNCTION,fflist[k])</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_TANGENT,0.393,1.0-0.393,0)</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_NORMAL,-(1.0-0.393),-0.393,0.0)</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_BINORM,0.0,0.0,1.0)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slices[k])</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slices[k])</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slices[k])</div>
<div class="line">--end</div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value1=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[20])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value2=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    chiExportFieldFunctionToVTKG(fflist[1],<span class="stringliteral">&quot;ZPhi3D&quot;</span>,<span class="stringliteral">&quot;Phi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line"> </div>
<div class="line">    --os.execute(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">    ----os.execute(<span class="stringliteral">&quot;python ZPFFI11.py&quot;</span>)</div>
<div class="line">    --local handle = io.popen(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">    print(<span class="stringliteral">&quot;Execution completed&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport3D_1Poly_qmom_part1_lua" name="tests_Transport_Steady_Transport3D_1Poly_qmom_part1_lua"></a>tests/Transport_Steady/Transport3D_1Poly_qmom_part1.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 3D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> BCs and a material source writing source moments.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=1.08320e-01 and 0.0</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">unpart_mesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga0f476b765a307ec7a477c237134298c2">chiUnpartitionedMeshFromWavefrontOBJ</a>(</div>
<div class="line">        &quot;resources/TestMeshes/SquareMesh2x2Quads.obj&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_EXTRUDER,</div>
<div class="line">                      ExtruderTemplateType.UNPARTITIONED_MESH,</div>
<div class="line">                      unpart_mesh);</div>
<div class="line"> </div>
<div class="line">NZ=2</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2*NZ,NZ,&quot;Charlie&quot;);--0.4</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2*NZ,NZ,&quot;Chuck&quot;);--0.8</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2*NZ,NZ,&quot;Bob&quot;);--1.2</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2*NZ,NZ,&quot;SarahConner&quot;);--1.6</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">PARTITION_TYPE</a>,KBA_STYLE_XYZ)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga84f96adcccf43678b5b94285a2291e66">chiVolumeMesherSetKBAPartitioningPxPyPz</a>(2,2,1)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga2048d69a09e224f5daf0ff4e6c4404e4">chiVolumeMesherSetKBACutsX</a>({0.0})</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gae5015130ffe27744255aa29b3e704eb7">chiVolumeMesherSetKBACutsY</a>({0.0})</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.5/8,0.5/8,-0.5/8,0.5/8,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 21</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,<span class="stringliteral">&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 1.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line"> </div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2, 2)</div>
<div class="line">pquad2 = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,5, 5)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,20)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga8f9de7a927209f9d2988404bd1eb7d83">chiLBSGroupsetSetAngleAggregationType</a>(phys1,cur_gs,LBSGroupset.ANGLE_AGG_SINGLE)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_RICHARDSON)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line">if (master_export == nil) then</div>
<div class="line">    --<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga0d55640ff00a44cf4d2167ed04e5e634">chiLBSGroupsetSetEnableSweepLog</a>(phys1,cur_gs,true)</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,0)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi;</div>
<div class="line">-- <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMIN,LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#af7ff25258d19529fa93495369b077985">chiLBSCreateAndWriteSourceMoments</a>(phys1,<span class="stringliteral">&quot;Qmoms&quot;</span>)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">--slices = {}</div>
<div class="line">--<span class="keywordflow">for</span> k=1,count <span class="keywordflow">do</span></div>
<div class="line">--    slices[k] = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_POINT,0.0,0.0,0.8001)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],ADD_FIELDFUNCTION,fflist[k])</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_TANGENT,0.393,1.0-0.393,0)</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_NORMAL,-(1.0-0.393),-0.393,0.0)</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_BINORM,0.0,0.0,1.0)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slices[k])</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slices[k])</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slices[k])</div>
<div class="line">--end</div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value1=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[20])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value2=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    chiExportFieldFunctionToVTKG(fflist[1],<span class="stringliteral">&quot;ZPhi3D&quot;</span>,<span class="stringliteral">&quot;Phi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line"> </div>
<div class="line">    --os.execute(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">    ----os.execute(<span class="stringliteral">&quot;python ZPFFI11.py&quot;</span>)</div>
<div class="line">    --local handle = io.popen(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">    print(<span class="stringliteral">&quot;Execution completed&quot;</span>)</div>
<div class="line">end</div>
<div class="ttc" id="anamespacechi__lua_html_af7ff25258d19529fa93495369b077985"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#af7ff25258d19529fa93495369b077985">chi_lua::chiLBSCreateAndWriteSourceMoments</a></div><div class="ttdeci">void chiLBSCreateAndWriteSourceMoments(int SolverIndex, string file_base)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04688">lua_functions.c:4688</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport3D_1Poly_qmom_part2_lua" name="tests_Transport_Steady_Transport3D_1Poly_qmom_part2_lua"></a>tests/Transport_Steady/Transport3D_1Poly_qmom_part2.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 3D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> BCs and a material source reading source moments</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=1.01701e-04 and 9.14681e-06</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">unpart_mesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga0f476b765a307ec7a477c237134298c2">chiUnpartitionedMeshFromWavefrontOBJ</a>(</div>
<div class="line">        &quot;resources/TestMeshes/SquareMesh2x2Quads.obj&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_EXTRUDER,</div>
<div class="line">                      ExtruderTemplateType.UNPARTITIONED_MESH,</div>
<div class="line">                      unpart_mesh);</div>
<div class="line"> </div>
<div class="line">NZ=2</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2*NZ,NZ,&quot;Charlie&quot;);--0.4</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2*NZ,NZ,&quot;Chuck&quot;);--0.8</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2*NZ,NZ,&quot;Bob&quot;);--1.2</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2*NZ,NZ,&quot;SarahConner&quot;);--1.6</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">PARTITION_TYPE</a>,KBA_STYLE_XYZ)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga84f96adcccf43678b5b94285a2291e66">chiVolumeMesherSetKBAPartitioningPxPyPz</a>(2,2,1)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga2048d69a09e224f5daf0ff4e6c4404e4">chiVolumeMesherSetKBACutsX</a>({0.0})</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gae5015130ffe27744255aa29b3e704eb7">chiVolumeMesherSetKBACutsY</a>({0.0})</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.5/8,0.5/8,-0.5/8,0.5/8,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 21</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,<span class="stringliteral">&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 1.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line"> </div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2, 2)</div>
<div class="line">pquad2 = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,5, 5)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,20)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga8f9de7a927209f9d2988404bd1eb7d83">chiLBSGroupsetSetAngleAggregationType</a>(phys1,cur_gs,LBSGroupset.ANGLE_AGG_SINGLE)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi;</div>
<div class="line">-- <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMIN,LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#abc85d49db3c3e20552ade3bc0323e99e">chiLBSReadSourceMoments</a>(phys1,<span class="stringliteral">&quot;Qmoms&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,USE_SOURCE_MOMENTS,true)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Get field functions</span></div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">--slices = {}</div>
<div class="line">--<span class="keywordflow">for</span> k=1,count <span class="keywordflow">do</span></div>
<div class="line">--    slices[k] = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_POINT,0.0,0.0,0.8001)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],ADD_FIELDFUNCTION,fflist[k])</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_TANGENT,0.393,1.0-0.393,0)</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_NORMAL,-(1.0-0.393),-0.393,0.0)</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_BINORM,0.0,0.0,1.0)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slices[k])</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slices[k])</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slices[k])</div>
<div class="line">--end</div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value1=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[20])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value2=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    chiExportFieldFunctionToVTKG(fflist[1],<span class="stringliteral">&quot;ZPhi3DColl&quot;</span>,<span class="stringliteral">&quot;Phi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line"> </div>
<div class="line">    --os.execute(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">    ----os.execute(<span class="stringliteral">&quot;python ZPFFI11.py&quot;</span>)</div>
<div class="line">    --local handle = io.popen(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">    print(<span class="stringliteral">&quot;Execution completed&quot;</span>)</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../dd/d5c/group__chi_m_p_i.html#ga9cb624104190befb4f294d6c90452502">chiMPIBarrier</a>()</div>
<div class="line">if (chi_location_id == 0) then</div>
<div class="line">    os.execute(&quot;rm Qmoms*&quot;)</div>
<div class="line">end</div>
<div class="ttc" id="anamespacechi__lua_html_abc85d49db3c3e20552ade3bc0323e99e"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#abc85d49db3c3e20552ade3bc0323e99e">chi_lua::chiLBSReadSourceMoments</a></div><div class="ttdeci">void chiLBSReadSourceMoments(int SolverIndex, string file_base, bool single_file_flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04721">lua_functions.c:4721</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport3D_2Unstructured_lua" name="tests_Transport_Steady_Transport3D_2Unstructured_lua"></a>tests/Transport_Steady/Transport3D_2Unstructured.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 3D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=5.41465e-01 and 3.78243e-04</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">unpart_mesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga0f476b765a307ec7a477c237134298c2">chiUnpartitionedMeshFromWavefrontOBJ</a>(</div>
<div class="line">        &quot;resources/TestMeshes/TriangleMesh2x2Cuts.obj&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_EXTRUDER,</div>
<div class="line">                      ExtruderTemplateType.UNPARTITIONED_MESH,</div>
<div class="line">                      unpart_mesh);</div>
<div class="line"> </div>
<div class="line">NZ=2</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2*NZ,NZ,&quot;Charlie&quot;);--0.4</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2*NZ,NZ,&quot;Charlie&quot;);--0.8</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2*NZ,NZ,&quot;Charlie&quot;);--1.2</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2*NZ,NZ,&quot;Charlie&quot;);--1.6</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">PARTITION_TYPE</a>,KBA_STYLE_XYZ)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga84f96adcccf43678b5b94285a2291e66">chiVolumeMesherSetKBAPartitioningPxPyPz</a>(2,2,1)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga2048d69a09e224f5daf0ff4e6c4404e4">chiVolumeMesherSetKBACutsX</a>({0.0})</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gae5015130ffe27744255aa29b3e704eb7">chiVolumeMesherSetKBACutsY</a>({0.0})</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.5,0.5,-0.5,0.5,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 21</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,<span class="stringliteral">&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line"> </div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2, 2)</div>
<div class="line">pquad2 = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,5, 5)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,20)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga8f9de7a927209f9d2988404bd1eb7d83">chiLBSGroupsetSetAngleAggregationType</a>(phys1,cur_gs,LBSGroupset.ANGLE_AGG_SINGLE)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line">if (master_export == nil) then</div>
<div class="line">    --<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga0d55640ff00a44cf4d2167ed04e5e634">chiLBSGroupsetSetEnableSweepLog</a>(phys1,cur_gs,true)</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">--========== Boundary conditions</div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi;</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMIN,LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"> </div>
<div class="line">--========== Solvers</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SAVE_ANGULAR_FLUX,<span class="keyword">true</span>)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Get field functions</span></div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">--slices = {}</div>
<div class="line">--<span class="keywordflow">for</span> k=1,count <span class="keywordflow">do</span></div>
<div class="line">--    slices[k] = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_POINT,0.0,0.0,0.8001)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],ADD_FIELDFUNCTION,fflist[k])</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_TANGENT,0.393,1.0-0.393,0)</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_NORMAL,-(1.0-0.393),-0.393,0.0)</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_BINORM,0.0,0.0,1.0)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slices[k])</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slices[k])</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slices[k])</div>
<div class="line">--end</div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value1=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[20])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value2=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    chiExportFieldFunctionToVTKG(fflist[1],<span class="stringliteral">&quot;ZPhi3D&quot;</span>,<span class="stringliteral">&quot;Phi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line"> </div>
<div class="line">    --os.execute(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">    ----os.execute(<span class="stringliteral">&quot;python ZPFFI11.py&quot;</span>)</div>
<div class="line">    --local handle = io.popen(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">    print(<span class="stringliteral">&quot;Execution completed&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport3D_3a_DSA_ortho_lua" name="tests_Transport_Steady_Transport3D_3a_DSA_ortho_lua"></a>tests/Transport_Steady/Transport3D_3a_DSA_ortho.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 3D LinearBSolver test of a block of graphite with an air cavity. DSA and TG</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: WGS groups [0-62] Iteration    54 Residual 7.92062e-07 CONVERGED</div>
<div class="line">-- and   WGS groups [63-167] Iteration    63 Residual 8.1975e-07 CONVERGED</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=20</div>
<div class="line">L=100</div>
<div class="line">--N=10</div>
<div class="line">--L=200e6</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">--xmin_ = 0.0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga12dcd80ee2ab6104ba6e7142d7885221">chiMeshCreateUnpartitioned3DOrthoMesh</a>(mesh,mesh,{0.0,10.0,20.0,30.0,40.0})</div>
<div class="line">--<a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line">--<a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#gabcd0e135b1081c3b9eb6661d44fb21d7">chiMeshCreateUnpartitioned1DOrthoMesh</a>(mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-10.0,10.0,-10.0,10.0,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--num_groups = 1</div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">--        SIMPLEXS1,num_groups,1.0,0.999)</div>
<div class="line">num_groups = 168</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_air50RH.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">src[1] = 1.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1] = 0.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad0 = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2, 2,<span class="keyword">false</span>)</div>
<div class="line">pquad1 = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,8, 8,false)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line"> </div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,62)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad0)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_RICHARDSON_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,1000)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,30)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-2,false,&quot;&quot;)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot;&quot;)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">gs1 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line"> </div>
<div class="line">cur_gs = gs1</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,63,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad0)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_RICHARDSON_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,1000)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,30)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-2,false,&quot;&quot;)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot;&quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi;</div>
<div class="line">--bsrc[1] = 1.0</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMAX,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,YMIN,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,YMAX,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMIN,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMAX,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    chiExportFieldFunctionToVTKG(fflist[1],<span class="stringliteral">&quot;ZPhi&quot;</span>,<span class="stringliteral">&quot;Phi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"> </div>
<div class="line">--############################################### Stats N=50</div>
<div class="line">-- Case 0a 1MPI <a class="code hl_enumvalue" href="../../d9/d42/namespacelbs.html#a74e6ab7d8963411bcda1c642e3098508ac1bfd84e7215afa3204b8e1cdb21a2bd">GMRES</a>(30)</div>
<div class="line">-- GS0  53 its GS1 240 its</div>
<div class="line"> </div>
<div class="line">-- Case 1a 1MPI <a class="code hl_enumvalue" href="../../d9/d42/namespacelbs.html#a74e6ab7d8963411bcda1c642e3098508ac1bfd84e7215afa3204b8e1cdb21a2bd">GMRES</a>(30) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  27 its GS1  62 its</div>
<div class="line"> </div>
<div class="line">-- Case 2a 1MPI GMRES(30) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  27 its GS1  33 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">-- Case 0a 1MPI GMRES(60)</div>
<div class="line">-- GS0  36 its GS1 70 its</div>
<div class="line"> </div>
<div class="line">-- Case 1a 1MPI GMRES(60) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  27 its GS1  42 its</div>
<div class="line"> </div>
<div class="line">-- Case 2a 1MPI GMRES(60) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  27 its GS1  32 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">-- GMRES(10)</div>
<div class="line">-- Case 0b 1MPI GMRES(10)</div>
<div class="line">-- GS0  96 its GS1 357 its</div>
<div class="line"> </div>
<div class="line">-- Case 1b 1MPI GMRES(10) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  116 its GS1  inf its</div>
<div class="line"> </div>
<div class="line">-- Case 2b 1MPI GMRES(10) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  116 its GS1  86 its</div>
<div class="line"> </div>
<div class="line">-- 8 MPI</div>
<div class="line"> </div>
<div class="line">-- GMRES(60)</div>
<div class="line">-- Case 0c 8MPI GMRES(60)</div>
<div class="line">-- GS0  39 its GS1 117 its</div>
<div class="line"> </div>
<div class="line">-- Case 1c 8MPI GMRES(60) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  32 its GS1 60 its</div>
<div class="line"> </div>
<div class="line">-- Case 2c 8MPI GMRES(60) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  32 its GS1  41 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">-- GMRES(30)</div>
<div class="line">-- Case 0c 8MPI GMRES(30)</div>
<div class="line">-- GS0  53 its GS1 239 its</div>
<div class="line"> </div>
<div class="line">-- Case 1c 8MPI GMRES(30) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  47 its GS1  110 its</div>
<div class="line"> </div>
<div class="line">-- Case 2c 8MPI GMRES(30) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  47 its GS1  56 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">-- GMRES(20)</div>
<div class="line">-- Case 0c 8MPI GMRES(20)</div>
<div class="line">-- GS0 109 its GS1 300 its</div>
<div class="line"> </div>
<div class="line">-- Case 1c 8MPI GMRES(20) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  57 its GS1 155 its</div>
<div class="line"> </div>
<div class="line">-- Case 2c 8MPI GMRES(20) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  57 its GS1  62 its</div>
<div class="line"> </div>
<div class="line">-- GMRES(10)</div>
<div class="line">-- Case 0d 8MPI GMRES(10)</div>
<div class="line">-- GS0  92 its GS1 410 its</div>
<div class="line"> </div>
<div class="line">-- Case 1d 8MPI GMRES(10) WGDSA0 WGDSA1</div>
<div class="line">-- GS0  92 its GS1  inf its</div>
<div class="line"> </div>
<div class="line">-- Case 2d 8MPI GMRES(10) WGDSA0 WGDSA1 TG1</div>
<div class="line">-- GS0  92 its GS1  98 its</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--=============================================== BICGSTAB comparisons</div>
<div class="line">-- Case 0a 1MPI GMRES(10)</div>
<div class="line">-- GS0  87 its GS1 262 its TTS=56</div>
<div class="line"> </div>
<div class="line">-- Case 0a 1MPI GMRES(30)</div>
<div class="line">-- GS0  54 its GS1 244 its TTS=46</div>
<div class="line"> </div>
<div class="line">-- Case 0a 1MPI GMRES(60)</div>
<div class="line">-- GS0  37 its GS1 102 its TTS=21</div>
<div class="line"> </div>
<div class="line">-- BICGSTAB</div>
<div class="line">-- Case 0a 1MPI BICGSTAB</div>
<div class="line">-- GS0  34 its GS1 73 its TTS=30</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport3D_3BlockPoly_DSA_lua" name="tests_Transport_Steady_Transport3D_3BlockPoly_DSA_lua"></a>tests/Transport_Steady/Transport3D_3BlockPoly_DSA.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 3D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Nonce</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">unpart_mesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga0f476b765a307ec7a477c237134298c2">chiUnpartitionedMeshFromWavefrontOBJ</a>(</div>
<div class="line">        &quot;resources/TestMeshes/SquareMesh2x2QuadsBlock.obj&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_EXTRUDER,</div>
<div class="line">                      ExtruderTemplateType.UNPARTITIONED_MESH,</div>
<div class="line">                      unpart_mesh);</div>
<div class="line"> </div>
<div class="line">NZ=1</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,10.0,NZ,&quot;Charlie&quot;);--10.0</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,10.0,NZ,&quot;Charlie&quot;);--20.0</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,10.0,NZ,&quot;Charlie&quot;);--30.0</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,10.0,NZ,&quot;Charlie&quot;);--40.0</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga84f96adcccf43678b5b94285a2291e66">chiVolumeMesherSetKBAPartitioningPxPyPz</a>(2,2,1)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga2048d69a09e224f5daf0ff4e6c4404e4">chiVolumeMesherSetKBACutsX</a>({0.0})</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gae5015130ffe27744255aa29b3e704eb7">chiVolumeMesherSetKBACutsY</a>({0.0})</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">PARTITION_TYPE</a>,KBA_STYLE_XYZ)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-10.0,10.0,-10.0,10.0,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 168</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,<span class="stringliteral">&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_air50RH.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad0 = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2, 2,<span class="keyword">false</span>)</div>
<div class="line">pquad1 = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,8, 8,false)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line"> </div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,62)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad0)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-4)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,5)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,30)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-2)</div>
<div class="line">-- <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">gs1 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line"> </div>
<div class="line">cur_gs = gs1</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,63,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad0)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-4)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,5)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,30)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-2,false,&quot; &quot;)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-6,false,&quot; &quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi;</div>
<div class="line">--bsrc[1] = 1.0</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMAX,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,YMIN,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,YMAX,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMIN,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMAX,INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    chiExportFieldFunctionToVTKG(fflist[1],<span class="stringliteral">&quot;ZPhi&quot;</span>,<span class="stringliteral">&quot;Phi&quot;</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport3D_4Cycles1_lua" name="tests_Transport_Steady_Transport3D_4Cycles1_lua"></a>tests/Transport_Steady/Transport3D_4Cycles1.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 3D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> and Incident-isotropic BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=3.74343e-04</div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">unpart_mesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#ga0f476b765a307ec7a477c237134298c2">chiUnpartitionedMeshFromWavefrontOBJ</a>(</div>
<div class="line">        &quot;resources/TestMeshes/Square2x2_partition_cyclic3.obj&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED);</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_EXTRUDER,</div>
<div class="line">                      ExtruderTemplateType.UNPARTITIONED_MESH,</div>
<div class="line">                      unpart_mesh);</div>
<div class="line"> </div>
<div class="line">NZ=2</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2*NZ,NZ,&quot;Charlie&quot;);--0.4</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2*NZ,NZ,&quot;Charlie&quot;);--0.8</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2*NZ,NZ,&quot;Charlie&quot;);--1.2</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a7fa5319da678071d38e04d6f571f09f5">EXTRUSION_LAYER</a>,0.2*NZ,NZ,&quot;Charlie&quot;);--1.6</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">PARTITION_TYPE</a>,KBA_STYLE_XYZ)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga84f96adcccf43678b5b94285a2291e66">chiVolumeMesherSetKBAPartitioningPxPyPz</a>(2,2,1)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga2048d69a09e224f5daf0ff4e6c4404e4">chiVolumeMesherSetKBACutsX</a>({0.0})</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gae5015130ffe27744255aa29b3e704eb7">chiVolumeMesherSetKBACutsY</a>({0.0})</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>();</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">vol1 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-0.5,0.5,-0.5,0.5,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol1,1)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">num_groups = 21</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,<span class="stringliteral">&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line"> </div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2, 2)</div>
<div class="line">pquad2 = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,6, 6)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,20)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,300)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,30)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line">--</div>
<div class="line">--gs1 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,gs1,63,167)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,gs1,pquad)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi;</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMAX,LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,LBSBoundaryTypes.REFLECTING);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMAX,LBSBoundaryTypes.REFLECTING);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">--slices = {}</div>
<div class="line">--<span class="keywordflow">for</span> k=1,count <span class="keywordflow">do</span></div>
<div class="line">--    slices[k] = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_POINT,0.0,0.0,0.8001)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],ADD_FIELDFUNCTION,fflist[k])</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_TANGENT,0.393,1.0-0.393,0)</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_NORMAL,-(1.0-0.393),-0.393,0.0)</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_BINORM,0.0,0.0,1.0)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slices[k])</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slices[k])</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slices[k])</div>
<div class="line">--end</div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value1=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[20])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(<span class="stringliteral">&quot;Max-value2=%.5e&quot;</span>, maxval))</div>
<div class="line"> </div>
<div class="line">--############################################### Exports</div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    chiExportFieldFunctionToVTKG(fflist[1],<span class="stringliteral">&quot;ZPhi3D&quot;</span>,<span class="stringliteral">&quot;Phi&quot;</span>)</div>
<div class="line"> </div>
<div class="line">    line = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(LINE)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line,LINE_FIRSTPOINT,0.0,-1.0,0.5)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line,LINE_SECONDPOINT,0.0, 1.0,0.5)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line,LINE_NUMBEROFPOINTS,1000)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(line,ADD_FIELDFUNCTION,fflist[2])</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(line)</div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(line)</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(line,&quot;Line&quot;)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line"> </div>
<div class="line">    --os.execute(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">    ----os.execute(<span class="stringliteral">&quot;python ZPFFI11.py&quot;</span>)</div>
<div class="line">    --local handle = io.popen(<span class="stringliteral">&quot;python ZPFFI00.py&quot;</span>)</div>
<div class="line">    print(<span class="stringliteral">&quot;Execution completed&quot;</span>)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Transport3D_5Cycles2_lua" name="tests_Transport_Steady_Transport3D_5Cycles2_lua"></a>tests/Transport_Steady/Transport3D_5Cycles2.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 3D Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> BCs.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value1=6.55387e+00</div>
<div class="line">--       Max-value2=1.02940e+00</div>
<div class="line"> </div>
<div class="line">num_procs = 4</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">umesh = <a class="code hl_function" href="../../d2/dde/group___lua_unpartitioned_mesh.html#gaf29132bae6e3cdf17f39591e3012e1b9">chiUnpartitionedMeshFromEnsightGold</a>(&quot;resources/TestMeshes/Sphere.case&quot;)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#ga093aea22f7d29fe5ab8d6977dd22395c">chiSurfaceMesherCreate</a>(SURFACEMESHER_PREDEFINED)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga97061ff17454d77b1f4359690c624299">chiVolumeMesherCreate</a>(VOLUMEMESHER_UNPARTITIONED, umesh)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(VOLUMEPARTITION_X,2)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(VOLUMEPARTITION_Y,2)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5ac95a7b4eff4fbb448b25fe2571a4985c">CUTS_X</a>,0.0)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5ae63b21f1a550c17e040bb3ef61a6e25a">CUTS_Y</a>,0.0)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d1/d9b/group___lua_surface_mesher.html#gafa49ea05b8a7ca38d50ea324b39fb219">chiSurfaceMesherExecute</a>()</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>()</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line">num_groups = 5</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,<span class="stringliteral">&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;</span>)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        CHI_XSFILE,&quot;tests/Transport_Steady/xs_graphite_pure.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line">src[1]=1.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line"> </div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad  = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2, 2)</div>
<div class="line">pquad2 = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,12, 8)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga8f9de7a927209f9d2988404bd1eb7d83">chiLBSGroupsetSetAngleAggregationType</a>(phys1,cur_gs,LBSGroupset.ANGLE_AGG_SINGLE)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line">if (master_export == nil) then</div>
<div class="line">    --<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga0d55640ff00a44cf4d2167ed04e5e634">chiLBSGroupsetSetEnableSweepLog</a>(phys1,cur_gs,true)</div>
<div class="line">end</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,10)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">bsrc={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    bsrc[g] = 0.0</div>
<div class="line">end</div>
<div class="line">bsrc[1] = 1.0/4.0/math.pi;</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMIN,LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,0)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Get field functions</div>
<div class="line">fflist,count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys1)</div>
<div class="line"> </div>
<div class="line">--############################################### Slice plot</div>
<div class="line">--slices = {}</div>
<div class="line">--<span class="keywordflow">for</span> k=1,count <span class="keywordflow">do</span></div>
<div class="line">--    slices[k] = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(SLICE)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_POINT,0.0,0.0,0.8001)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],ADD_FIELDFUNCTION,fflist[k])</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_TANGENT,0.393,1.0-0.393,0)</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_NORMAL,-(1.0-0.393),-0.393,0.0)</div>
<div class="line">--    --<a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(slices[k],SLICE_BINORM,0.0,0.0,1.0)</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(slices[k])</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(slices[k])</div>
<div class="line">--    <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga50c247b26a80c528198b5c2cd9be940c">chiFFInterpolationExportPython</a>(slices[k])</div>
<div class="line">--end</div>
<div class="line"> </div>
<div class="line">--############################################### Volume integrations</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Max-value1=%.5e&quot;, maxval))</div>
<div class="line"> </div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[2])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Max-value2=%.5e&quot;, maxval))</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Exports</span></div>
<div class="line"><span class="keywordflow">if</span> (master_export == nil) then</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chiExportMultiFieldFunctionToVTK</a>(fflist,<span class="stringliteral">&quot;ZPhi3D&quot;</span>)</div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ade62e412808353858dbd1a655127ae2e">chiExportFieldFunctionToVTK</a>(fflist[1],&quot;ZPhi3D_g0&quot;)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Plots</span></div>
<div class="line"><span class="keywordflow">if</span> (chi_location_id == 0 and master_export == nil) then</div>
<div class="line">    print(<span class="stringliteral">&quot;Execution completed&quot;</span>)</div>
<div class="line">end</div>
<div class="ttc" id="agroup___lua_unpartitioned_mesh_html_gaf29132bae6e3cdf17f39591e3012e1b9"><div class="ttname"><a href="../../d2/dde/group___lua_unpartitioned_mesh.html#gaf29132bae6e3cdf17f39591e3012e1b9">chi_lua::chiUnpartitionedMeshFromEnsightGold</a></div><div class="ttdeci">Handle chiUnpartitionedMeshFromEnsightGold(char file_name, float scale)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l01364">lua_functions.c:1364</a></div></div>
<div class="ttc" id="anamespacechi__mesh_html_a496eecf9633f022b12704bc27a6726a5ac95a7b4eff4fbb448b25fe2571a4985c"><div class="ttname"><a href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5ac95a7b4eff4fbb448b25fe2571a4985c">chi_mesh::CUTS_X</a></div><div class="ttdeci">@ CUTS_X</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcb/chi__volumemesher_8h_source.html#l00028">chi_volumemesher.h:28</a></div></div>
<div class="ttc" id="anamespacechi__mesh_html_a496eecf9633f022b12704bc27a6726a5ae63b21f1a550c17e040bb3ef61a6e25a"><div class="ttname"><a href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5ae63b21f1a550c17e040bb3ef61a6e25a">chi_mesh::CUTS_Y</a></div><div class="ttdeci">@ CUTS_Y</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcb/chi__volumemesher_8h_source.html#l00027">chi_volumemesher.h:27</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Cyl_Transport2DCyl_1Monoenergetic_lua" name="tests_Transport_Steady_Cyl_Transport2DCyl_1Monoenergetic_lua"></a>tests/Transport_Steady_Cyl/Transport2DCyl_1Monoenergetic.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D transport test in axialsymmetric cylindrical geometry with</div>
<div class="line">-- vacuum boundary condition - monoenergetic.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-value=1.00000</div>
<div class="line">num_procs = 4</div>
<div class="line">--Structured mesh</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line">--  mesh</div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line">dim = 2</div>
<div class="line">length = {1, 2, }</div>
<div class="line">ncells = {50, 100, }</div>
<div class="line">nodes = {}</div>
<div class="line"><span class="keywordflow">for</span> d = 1, dim <span class="keywordflow">do</span></div>
<div class="line">  delta = length[d]/ncells[d]</div>
<div class="line">  nodes[d] = {}</div>
<div class="line">  <span class="keywordflow">for</span> i = 0, ncells[d] <span class="keywordflow">do</span></div>
<div class="line">    nodes[d][i+1] = i*delta</div>
<div class="line">  end</div>
<div class="line">end</div>
<div class="line">surf_mesh, region0 = <a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(nodes[1], nodes[2])</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">PARTITION_TYPE</a>, PARMETIS)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>()</div>
<div class="line"> </div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>, 0, length[1], 0, length[2], 0, 0)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line">--  materials</div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line">ngrp = 1</div>
<div class="line">sigmat = 25.0</div>
<div class="line">ratioc = 0.1</div>
<div class="line">source = sigmat * (1 - ratioc)</div>
<div class="line"> </div>
<div class="line">material0 = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(&quot;Material_0&quot;);</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(material0,TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(material0,ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(material0, TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1, ngrp, sigmat, ratioc)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(material0, ISOTROPIC_MG_SOURCE,</div>
<div class="line">                              SINGLE_VALUE, source)</div>
<div class="line"> </div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line">--  physics</div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line">phys0 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a4a3184b46b8e8c24b16f15b078e4cc4d">chiLBSCurvilinearCreateSolver</a>(LBSCurvilinear.CYLINDRICAL)</div>
<div class="line"> </div>
<div class="line">--  angular quadrature</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga1b1e0347acc28da6892dac146596e683">chiCreateCylindricalProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV, 4, 8)</div>
<div class="line"> </div>
<div class="line">--  groups</div>
<div class="line">groups = {}</div>
<div class="line"><span class="keywordflow">for</span> g = 1, ngrp <span class="keywordflow">do</span></div>
<div class="line">  groups[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys0)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--  groupsets</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys0)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys0, gs0, 0, ngrp-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys0, gs0, pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga8f9de7a927209f9d2988404bd1eb7d83">chiLBSGroupsetSetAngleAggregationType</a>(phys0, gs0, LBSGroupset.ANGLE_AGG_AZIMUTHAL)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys0, gs0, KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys0, gs0, 1.0e-12)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys0, gs0, 100)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys0, gs0, 30)</div>
<div class="line"> </div>
<div class="line">--  spatial discretisation</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys0, DISCRETIZATION_METHOD, PWLD)</div>
<div class="line"> </div>
<div class="line">--  scattering order</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys0, SCATTERING_ORDER, 0)</div>
<div class="line"> </div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line">--  boundary conditions</div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line">dirichlet_value = {}</div>
<div class="line"><span class="keywordflow">for</span> g = 1, ngrp <span class="keywordflow">do</span></div>
<div class="line">  dirichlet_value[g] = 0</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys0, BOUNDARY_CONDITION,</div>
<div class="line">                  XMIN, LBSBoundaryTypes.REFLECTING)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys0, BOUNDARY_CONDITION,</div>
<div class="line">                  XMAX, LBSBoundaryTypes.INCIDENT_ISOTROPIC, dirichlet_value)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys0, BOUNDARY_CONDITION,</div>
<div class="line">                  YMIN, LBSBoundaryTypes.INCIDENT_ISOTROPIC, dirichlet_value)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys0, BOUNDARY_CONDITION,</div>
<div class="line">                  YMAX, LBSBoundaryTypes.INCIDENT_ISOTROPIC, dirichlet_value)</div>
<div class="line"> </div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line">--  solvers</div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys0)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys0)</div>
<div class="line"> </div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line">--  output</div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line">--  field functions</div>
<div class="line">fflist, count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys0)</div>
<div class="line">if master_export == nil then</div>
<div class="line">  chiExportFieldFunctionToVTKG(fflist,</div>
<div class="line">                               &quot;Transport2DCyl1-scalar_flux&quot;,</div>
<div class="line">                               &quot;scalar_flux&quot;)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--  volume integrations</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi, OPERATION, OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi, LOGICAL_VOLUME, vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi, ADD_FIELDFUNCTION, fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0, <span class="keywordtype">string</span>.format(&quot;Max-value=%.5f&quot;, maxval))</div>
<div class="ttc" id="agroup___lua_quadrature_html_ga1b1e0347acc28da6892dac146596e683"><div class="ttname"><a href="../../de/d37/group___lua_quadrature.html#ga1b1e0347acc28da6892dac146596e683">chi_lua::chiCreateCylindricalProductQuadrature</a></div><div class="ttdeci">Returns chiCreateCylindricalProductQuadrature(int QuadratureType, varying values)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l03074">lua_functions.c:3074</a></div></div>
<div class="ttc" id="anamespacechi__lua_html_a4a3184b46b8e8c24b16f15b078e4cc4d"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#a4a3184b46b8e8c24b16f15b078e4cc4d">chi_lua::chiLBSCurvilinearCreateSolver</a></div><div class="ttdeci">SolverHandle chiLBSCurvilinearCreateSolver()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04953">lua_functions.c:4953</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Steady_Cyl_Transport2DCyl_2Multigroup_lua" name="tests_Transport_Steady_Cyl_Transport2DCyl_2Multigroup_lua"></a>tests/Transport_Steady_Cyl/Transport2DCyl_2Multigroup.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 2D transport test in axialsymmetric cylindrical geometry with</div>
<div class="line">-- vacuum boundary condition - multigroup with DSA.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test: Max-valueG1=1.00000, Max-valueG2=0.25000</div>
<div class="line">num_procs = 4</div>
<div class="line">--Structured mesh</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line">--  mesh</div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line">dim = 2</div>
<div class="line">length = {1, 2, }</div>
<div class="line">ncells = {50, 100, }</div>
<div class="line">nodes = {}</div>
<div class="line"><span class="keywordflow">for</span> d = 1, dim <span class="keywordflow">do</span></div>
<div class="line">  delta = length[d]/ncells[d]</div>
<div class="line">  nodes[d] = {}</div>
<div class="line">  <span class="keywordflow">for</span> i = 0, ncells[d] <span class="keywordflow">do</span></div>
<div class="line">    nodes[d][i+1] = i*delta</div>
<div class="line">  end</div>
<div class="line">end</div>
<div class="line">surf_mesh = <a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(nodes[1], nodes[2])</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a704f523c928ce09f4a03ebc860c4064b">PARTITION_TYPE</a>, PARMETIS)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>()</div>
<div class="line"> </div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>, 0, length[1], 0, length[2], 0, 0)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line">--  materials</div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line">ngrp = 2</div>
<div class="line">sigmat = 20.0</div>
<div class="line">ratioc = 0.4</div>
<div class="line">source = {}</div>
<div class="line">source[1] = sigmat * (1 - 0.5*ratioc)</div>
<div class="line"><span class="keywordflow">for</span> g = 2, ngrp <span class="keywordflow">do</span></div>
<div class="line">  source[g] = 0</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">material0 = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Material_0&quot;</span>);</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(material0,TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(material0,ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(material0, TRANSPORT_XSECTIONS,</div>
<div class="line">                              SIMPLEXS1, ngrp, sigmat, ratioc)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(material0, ISOTROPIC_MG_SOURCE,</div>
<div class="line">                              FROM_ARRAY, source)</div>
<div class="line"> </div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line">--  physics</div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line">phys0 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a4a3184b46b8e8c24b16f15b078e4cc4d">chiLBSCurvilinearCreateSolver</a>(LBSCurvilinear.CYLINDRICAL)</div>
<div class="line"> </div>
<div class="line">--  angular quadrature</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga1b1e0347acc28da6892dac146596e683">chiCreateCylindricalProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV, 4, 8)</div>
<div class="line"> </div>
<div class="line">--  groups</div>
<div class="line">groups = {}</div>
<div class="line"><span class="keywordflow">for</span> g = 1, ngrp <span class="keywordflow">do</span></div>
<div class="line">  groups[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys0)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--  groupsets</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys0)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys0, gs0, 0, ngrp-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys0, gs0, pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga8f9de7a927209f9d2988404bd1eb7d83">chiLBSGroupsetSetAngleAggregationType</a>(phys0, gs0, LBSGroupset.ANGLE_AGG_AZIMUTHAL)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys0, gs0, KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys0, gs0, 1.0e-12)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys0, gs0, 100)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys0, gs0, 30)</div>
<div class="line">petsc_options = &quot;&quot;</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys0, gs0, 50, 1.0e-09, false, petsc_options)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys0, gs0, 50, 1.0e-09, false, petsc_options)</div>
<div class="line"> </div>
<div class="line">--  spatial discretisation</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys0, DISCRETIZATION_METHOD, PWLD)</div>
<div class="line"> </div>
<div class="line">--  scattering order</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys0, SCATTERING_ORDER, 0)</div>
<div class="line"> </div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line">--  boundary conditions</div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line">dirichlet_value = {}</div>
<div class="line"><span class="keywordflow">for</span> g = 1, ngrp <span class="keywordflow">do</span></div>
<div class="line">  dirichlet_value[g] = 0</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys0, BOUNDARY_CONDITION,</div>
<div class="line">                  XMIN, LBSBoundaryTypes.REFLECTING)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys0, BOUNDARY_CONDITION,</div>
<div class="line">                  XMAX, LBSBoundaryTypes.INCIDENT_ISOTROPIC, dirichlet_value)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys0, BOUNDARY_CONDITION,</div>
<div class="line">                  YMIN, LBSBoundaryTypes.INCIDENT_ISOTROPIC, dirichlet_value)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys0, BOUNDARY_CONDITION,</div>
<div class="line">                  YMAX, LBSBoundaryTypes.INCIDENT_ISOTROPIC, dirichlet_value)</div>
<div class="line"> </div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line">--  solvers</div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys0)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys0)</div>
<div class="line"> </div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line">--  output</div>
<div class="line">--------------------------------------------------------------------------------</div>
<div class="line">--  field functions</div>
<div class="line">fflist, count = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gaf96d1d72d1274c36390436edabb1b0f9">chiLBSGetScalarFieldFunctionList</a>(phys0)</div>
<div class="line">if master_export == nil then</div>
<div class="line">  chiExportFieldFunctionToVTKG(fflist,</div>
<div class="line">                               &quot;Transport2DCyl2-scalar_flux&quot;,</div>
<div class="line">                               &quot;scalar_flux&quot;)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--  volume integrations - energy group 1</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi, OPERATION, OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi, LOGICAL_VOLUME, vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi, ADD_FIELDFUNCTION, fflist[1])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Max-valueG1=%.5f&quot;, maxval))</div>
<div class="line"> </div>
<div class="line">--  volume integrations - energy group 2</div>
<div class="line">ffi1 = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga7305438e0a0dac15a779e1a340b12f7b">chiFFInterpolationCreate</a>(VOLUME)</div>
<div class="line">curffi = ffi1</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,OPERATION,OP_MAX)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,LOGICAL_VOLUME,vol0)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gaf870d79259973f193b0d485bfdc1fc8d">chiFFInterpolationSetProperty</a>(curffi,ADD_FIELDFUNCTION,fflist[2])</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gac6e3979ecc5e6a577eb268be00f4cfa0">chiFFInterpolationInitialize</a>(curffi)</div>
<div class="line"><a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#ga94fdabdc1c1558288c8660b86806b7a6">chiFFInterpolationExecute</a>(curffi)</div>
<div class="line">maxval = <a class="code hl_function" href="../../d9/dfa/group___lua_f_f_interpol.html#gabe37b9b7813af20ba8dc82a6b1eef3b8">chiFFInterpolationGetValue</a>(curffi)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;Max-valueG2=%.5f&quot;, maxval))</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Transient_TransientTransport1D_1_lua" name="tests_Transport_Transient_TransientTransport1D_1_lua"></a>tests/Transport_Transient/TransientTransport1D_1.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 1D Transient Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test:</div>
<div class="line">num_procs = 2</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">                      <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">                      <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=20</div>
<div class="line">L=100.0</div>
<div class="line">xmin_ = 0.0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#gabcd0e135b1081c3b9eb6661d44fb21d7">chiMeshCreateUnpartitioned1DOrthoMesh</a>(mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line">--############################################### Add materials</div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line">-- Define microscopic cross sections</div>
<div class="line">xs = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga82468060b3343581b90ceb06aa1e52c3">chiPhysicsTransportXSCreate</a>()</div>
<div class="line">xs_file = &quot;tests/Transport_Transient/subcritical_1g.cxs&quot;</div>
<div class="line"><a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs, CHI_XSFILE, xs_file)</div>
<div class="line"> </div>
<div class="line">-- Define macroscopic cross sections</div>
<div class="line">--xs = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#gaf2eaf25408e5d7cdc62b9c03a29cb502">chiPhysicsTransportXSMakeCombined</a>({{xs, 0.00264086}}) -- just sub-critical</div>
<div class="line">xs = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#gaf2eaf25408e5d7cdc62b9c03a29cb502">chiPhysicsTransportXSMakeCombined</a>({{xs, 0.0424459}}) -- just sub-critical</div>
<div class="line"> </div>
<div class="line">num_groups = 1</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        EXISTING,xs)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        EXISTING,xs)</div>
<div class="line"> </div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">--src[1] = 1.0</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a529534755839f8be78616016fa1bc711">chiLBSCreateTransientSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE,16)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,8)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,1000)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line"> </div>
<div class="line">--</div>
<div class="line">----<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">--bsrc={}</div>
<div class="line">--<span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">--    bsrc[g] = 0.0</div>
<div class="line">--end</div>
<div class="line">--bsrc[1] = 1.0/2</div>
<div class="line">----<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMIN,LBSBoundaryTypes.INCIDENT_ISOTROPIC,bsrc);</div>
<div class="line">--</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#afa05f65c8e59f60b628b973204107feb">chiLBKESSetProperty</a>(phys1, &quot;MAX_ITERATIONS&quot;, 100)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#afa05f65c8e59f60b628b973204107feb">chiLBKESSetProperty</a>(phys1, &quot;TOLERANCE&quot;, 1.0e-8)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, USE_PRECURSORS, true)</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_INNER_ITERATIONS, false)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_INNER_ITERATIONS, false)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_OUTER_ITERATIONS, true)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chiLBTSSetProperty</a>(phys1, <span class="stringliteral">&quot;TIMESTEP&quot;</span>, 1e-1)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chiLBTSSetProperty</a>(phys1, &quot;VERBOSITY_LEVEL&quot;, 0)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chiLBTSSetProperty</a>(phys1, &quot;TIMESTEP_METHOD&quot;, &quot;CRANK_NICOLSON&quot;)</div>
<div class="line"> </div>
<div class="line">phys1name = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga809364d0d36788e4674f4d669364bd39">chiSolverGetName</a>(phys1);</div>
<div class="line"> </div>
<div class="line">--for k=1,2 do</div>
<div class="line">--    --<a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chiLBTSSetProperty</a>(phys1, &quot;INHIBIT_ADVANCE&quot;, true)</div>
<div class="line">--    <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga4c3e39b671bc808b3c2c9748a5e93383">chiSolverStep</a>(phys1)</div>
<div class="line">--    FRf = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;NEW&quot;)</div>
<div class="line">--    FRi = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;OLD&quot;)</div>
<div class="line">--    dt = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chiLBTSGetProperty</a>(phys1, &quot;TIMESTEP&quot;)</div>
<div class="line">--    t = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chiLBTSGetProperty</a>(phys1, &quot;TIME&quot;)</div>
<div class="line">--    period = dt/math.log(FRf/FRi)</div>
<div class="line">--    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0, <span class="keywordtype">string</span>.format(&quot;%s time=%10.3g dt=%10.3g period=%10.3g&quot;, phys1name,t,dt,period))</div>
<div class="line">--end</div>
<div class="line"> </div>
<div class="line">time = 0.0</div>
<div class="line">time_stop = 20.0</div>
<div class="line">k=0</div>
<div class="line">while (time &lt; time_stop) do</div>
<div class="line">    k = k + 1</div>
<div class="line">    <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga4c3e39b671bc808b3c2c9748a5e93383">chiSolverStep</a>(phys1)</div>
<div class="line">    FRf = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;NEW&quot;)</div>
<div class="line">    FRi = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;OLD&quot;)</div>
<div class="line">    dt = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chiLBTSGetProperty</a>(phys1, &quot;TIMESTEP&quot;)</div>
<div class="line">    time = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chiLBTSGetProperty</a>(phys1, &quot;TIME&quot;)</div>
<div class="line">    period = dt/math.log(FRf/FRi)</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0, <span class="keywordtype">string</span>.format(&quot;%s %4d time=%10.3g dt=%10.4g period=%10.3g FR=%10.3e&quot;,</div>
<div class="line">            phys1name,k,time,dt,period,FRf))</div>
<div class="line">end</div>
<div class="ttc" id="agroup___lua_l_b_s_html_gab808368124d002e83f86816c20681e30"><div class="ttname"><a href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chi_lua::chiLBSComputeFissionRate</a></div><div class="ttdeci">double chiLBSComputeFissionRate(int SolverIndex, string OldNewOption)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04838">lua_functions.c:4838</a></div></div>
<div class="ttc" id="agroup___lua_solver_html_ga4c3e39b671bc808b3c2c9748a5e93383"><div class="ttname"><a href="../../dc/d4e/group___lua_solver.html#ga4c3e39b671bc808b3c2c9748a5e93383">chi_lua::chiSolverStep</a></div><div class="ttdeci">void chiSolverStep(int solver_handle)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00534">lua_functions.c:534</a></div></div>
<div class="ttc" id="agroup___lua_transport_x_ss_html_gaf2eaf25408e5d7cdc62b9c03a29cb502"><div class="ttname"><a href="../../de/dd8/group___lua_transport_x_ss.html#gaf2eaf25408e5d7cdc62b9c03a29cb502">chi_lua::chiPhysicsTransportXSMakeCombined</a></div><div class="ttdeci">Returns chiPhysicsTransportXSMakeCombined(table Combinations)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l01066">lua_functions.c:1066</a></div></div>
<div class="ttc" id="anamespacechi__lua_html_a218a1b3c8e8c63410bca1097d3f464df"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chi_lua::chiLBTSGetProperty</a></div><div class="ttdeci">void chiLBTSGetProperty(int SolverIndex, string PropertyName)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l05134">lua_functions.c:5134</a></div></div>
<div class="ttc" id="anamespacechi__lua_html_a529534755839f8be78616016fa1bc711"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#a529534755839f8be78616016fa1bc711">chi_lua::chiLBSCreateTransientSolver</a></div><div class="ttdeci">void chiLBSCreateTransientSolver(string SolverName)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l05103">lua_functions.c:5103</a></div></div>
<div class="ttc" id="anamespacechi__lua_html_adc93d6def641a364a7d236d4e0544a80"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chi_lua::chiLBTSSetProperty</a></div><div class="ttdeci">void chiLBTSSetProperty(int SolverIndex, string PropertyName)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l05089">lua_functions.c:5089</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Transient_TransientTransport1D_2_lua" name="tests_Transport_Transient_TransientTransport1D_2_lua"></a>tests/Transport_Transient/TransientTransport1D_2.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 1D Transient Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test:</div>
<div class="line">num_procs = 2</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">            <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">            <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=4</div>
<div class="line">L=100.0</div>
<div class="line">xmin_ = 0.0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#gabcd0e135b1081c3b9eb6661d44fb21d7">chiMeshCreateUnpartitioned1DOrthoMesh</a>(mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line">--############################################### Add materials</div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line">-- Define microscopic cross sections</div>
<div class="line">xs_critical = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga82468060b3343581b90ceb06aa1e52c3">chiPhysicsTransportXSCreate</a>()</div>
<div class="line"><a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs_critical, CHI_XSFILE, &quot;tests/Transport_Transient/xs_inf_critical_1g.cxs&quot;)</div>
<div class="line">xs_21cent = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga82468060b3343581b90ceb06aa1e52c3">chiPhysicsTransportXSCreate</a>()</div>
<div class="line"><a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs_21cent, CHI_XSFILE, &quot;tests/Transport_Transient/xs_inf_21cent_1g.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">num_groups = 1</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        EXISTING,xs_critical)</div>
<div class="line"> </div>
<div class="line">src={0.0}</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">function SwapXS(solver_handle, new_xs)</div>
<div class="line">    <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">            EXISTING,new_xs)</div>
<div class="line">    <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gad44dcd1c761be67367c66fd3ff7cf865">chiLBSInitializeMaterials</a>(solver_handle)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a529534755839f8be78616016fa1bc711">chiLBSCreateTransientSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE,16)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,8)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,1000)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line"> </div>
<div class="line">--</div>
<div class="line">----<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">--bsrc={}</div>
<div class="line">--<span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">--    bsrc[g] = 0.0</div>
<div class="line">--end</div>
<div class="line">--bsrc[1] = 1.0/2</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMIN,LBSBoundaryTypes.REFLECTING);</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMAX,LBSBoundaryTypes.REFLECTING);</div>
<div class="line">--</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#afa05f65c8e59f60b628b973204107feb">chiLBKESSetProperty</a>(phys1, &quot;MAX_ITERATIONS&quot;, 100)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#afa05f65c8e59f60b628b973204107feb">chiLBKESSetProperty</a>(phys1, &quot;TOLERANCE&quot;, 1.0e-8)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, USE_PRECURSORS, true)</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_INNER_ITERATIONS, false)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_INNER_ITERATIONS, false)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_OUTER_ITERATIONS, true)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chiLBTSSetProperty</a>(phys1, <span class="stringliteral">&quot;TIMESTEP&quot;</span>, 1e-3)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chiLBTSSetProperty</a>(phys1, &quot;VERBOSITY_LEVEL&quot;, 0)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chiLBTSSetProperty</a>(phys1, &quot;TIMESTEP_METHOD&quot;, &quot;CRANK_NICOLSON&quot;)</div>
<div class="line"> </div>
<div class="line">phys1name = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga809364d0d36788e4674f4d669364bd39">chiSolverGetName</a>(phys1);</div>
<div class="line">initial_FR = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;OLD&quot;)</div>
<div class="line"> </div>
<div class="line">--time = 0.0</div>
<div class="line">--for k=1,2 do</div>
<div class="line">--    --<a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chiLBTSSetProperty</a>(phys1, &quot;INHIBIT_ADVANCE&quot;, true)</div>
<div class="line">--    <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga4c3e39b671bc808b3c2c9748a5e93383">chiSolverStep</a>(phys1)</div>
<div class="line">--    FRf = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;NEW&quot;)</div>
<div class="line">--    FRi = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;OLD&quot;)</div>
<div class="line">--    dt = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chiLBTSGetProperty</a>(phys1, &quot;TIMESTEP&quot;)</div>
<div class="line">--    time = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chiLBTSGetProperty</a>(phys1, &quot;TIME&quot;)</div>
<div class="line">--    period = dt/math.log(FRf/FRi)</div>
<div class="line">--    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0, <span class="keywordtype">string</span>.format(&quot;%s %4d time=%10.3g dt=%10.4g period=%10.3g FR=%10.3e&quot;,</div>
<div class="line">--            phys1name,k,time,dt,period,FRf/initial_FR))</div>
<div class="line">--end</div>
<div class="line"> </div>
<div class="line">time = 0.0</div>
<div class="line">time_stop = 1.0</div>
<div class="line">k=0</div>
<div class="line">swapped = false</div>
<div class="line">while (time &lt; time_stop) do</div>
<div class="line">    k = k + 1</div>
<div class="line">    <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga4c3e39b671bc808b3c2c9748a5e93383">chiSolverStep</a>(phys1)</div>
<div class="line">    FRf = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;NEW&quot;)</div>
<div class="line">    FRi = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;OLD&quot;)</div>
<div class="line">    dt = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chiLBTSGetProperty</a>(phys1, &quot;TIMESTEP&quot;)</div>
<div class="line">    time = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chiLBTSGetProperty</a>(phys1, &quot;TIME&quot;)</div>
<div class="line">    period = dt/math.log(FRf/FRi)</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0, <span class="keywordtype">string</span>.format(&quot;%s %4d time=%10.3g dt=%10.4g period=%10.3g FR=%10.3e&quot;,</div>
<div class="line">            phys1name,k,time,dt,period,FRf/initial_FR))</div>
<div class="line">    if (time &gt;= 0.2 and not swapped) then</div>
<div class="line">        SwapXS(phys1, xs_21cent)</div>
<div class="line">        swapped = true</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab51b4997706125b668f1c0ac9f3b79f5">chiLBTSAdvanceTimeData</a>(phys1)</div>
<div class="line">end</div>
<div class="ttc" id="agroup___lua_l_b_s_html_gad44dcd1c761be67367c66fd3ff7cf865"><div class="ttname"><a href="../../d0/daf/group___lua_l_b_s.html#gad44dcd1c761be67367c66fd3ff7cf865">chi_lua::chiLBSInitializeMaterials</a></div><div class="ttdeci">void chiLBSInitializeMaterials(int SolverIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l04755">lua_functions.c:4755</a></div></div>
<div class="ttc" id="anamespacechi__lua_html_ab51b4997706125b668f1c0ac9f3b79f5"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#ab51b4997706125b668f1c0ac9f3b79f5">chi_lua::chiLBTSAdvanceTimeData</a></div><div class="ttdeci">void chiLBTSAdvanceTimeData(int SolverIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l05147">lua_functions.c:5147</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Transient_TransientTransport1D_3_lua" name="tests_Transport_Transient_TransientTransport1D_3_lua"></a>tests/Transport_Transient/TransientTransport1D_3.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 1D Transient Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test:</div>
<div class="line">num_procs = 2</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">            <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">            <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=2000</div>
<div class="line">L=100.0</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#gabcd0e135b1081c3b9eb6661d44fb21d7">chiMeshCreateUnpartitioned1DOrthoMesh</a>(mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-L/4,L/4)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,1)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Strong fuel&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Weak fuel&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line">-- Define microscopic cross sections</div>
<div class="line">xs_strong_fuel_micro = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga82468060b3343581b90ceb06aa1e52c3">chiPhysicsTransportXSCreate</a>()</div>
<div class="line"><a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs_strong_fuel_micro, CHI_XSFILE, &quot;tests/Transport_Transient/xs_inf_k1_6_1g.cxs&quot;)</div>
<div class="line">xs_weak_fuelA_micro = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga82468060b3343581b90ceb06aa1e52c3">chiPhysicsTransportXSCreate</a>()</div>
<div class="line"><a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs_weak_fuelA_micro, CHI_XSFILE, &quot;tests/Transport_Transient/xs_inf_critical_1g.cxs&quot;)</div>
<div class="line">xs_weak_fuelB_micro = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga82468060b3343581b90ceb06aa1e52c3">chiPhysicsTransportXSCreate</a>()</div>
<div class="line"><a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs_weak_fuelB_micro, CHI_XSFILE, &quot;tests/Transport_Transient/xs_inf_weak_1g.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">atom_density = 0.056559</div>
<div class="line">xs_strong_fuel = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#gaf2eaf25408e5d7cdc62b9c03a29cb502">chiPhysicsTransportXSMakeCombined</a>({{xs_strong_fuel_micro, atom_density}}) --critical</div>
<div class="line">xs_weak_fuelA  = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#gaf2eaf25408e5d7cdc62b9c03a29cb502">chiPhysicsTransportXSMakeCombined</a>({{ xs_weak_fuelA_micro, atom_density}}) --critical</div>
<div class="line">xs_weak_fuelB  = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#gaf2eaf25408e5d7cdc62b9c03a29cb502">chiPhysicsTransportXSMakeCombined</a>({{xs_weak_fuelB_micro, atom_density}})   --critical</div>
<div class="line"> </div>
<div class="line">num_groups = 1</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        EXISTING,xs_strong_fuel)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        EXISTING,xs_weak_fuelA)</div>
<div class="line"> </div>
<div class="line">src={0.0}</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">function SwapXS(solver_handle, new_xs)</div>
<div class="line">    <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">            EXISTING,new_xs)</div>
<div class="line">    <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gad44dcd1c761be67367c66fd3ff7cf865">chiLBSInitializeMaterials</a>(solver_handle)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a529534755839f8be78616016fa1bc711">chiLBSCreateTransientSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE,16)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,8)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_RICHARDSON)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,1000)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line"> </div>
<div class="line">--</div>
<div class="line">----<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">--bsrc={}</div>
<div class="line">--<span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">--    bsrc[g] = 0.0</div>
<div class="line">--end</div>
<div class="line">--bsrc[1] = 1.0/2</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMIN,LBSBoundaryTypes.REFLECTING);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMAX,LBSBoundaryTypes.REFLECTING);</div>
<div class="line">--</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#afa05f65c8e59f60b628b973204107feb">chiLBKESSetProperty</a>(phys1, &quot;MAX_ITERATIONS&quot;, 1000)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#afa05f65c8e59f60b628b973204107feb">chiLBKESSetProperty</a>(phys1, &quot;TOLERANCE&quot;, 1.0e-8)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, USE_PRECURSORS, true)</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_INNER_ITERATIONS, false)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_INNER_ITERATIONS, false)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_OUTER_ITERATIONS, true)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chiLBTSSetProperty</a>(phys1, <span class="stringliteral">&quot;TIMESTEP&quot;</span>, 1e-3*100)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chiLBTSSetProperty</a>(phys1, &quot;TIMESTOP&quot;, 1.0*100)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chiLBTSSetProperty</a>(phys1, &quot;MAX_TIMESTEPS&quot;, -1)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chiLBTSSetProperty</a>(phys1, &quot;VERBOSITY_LEVEL&quot;, 0)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chiLBTSSetProperty</a>(phys1, &quot;TIMESTEP_METHOD&quot;, &quot;CRANK_NICOLSON&quot;)</div>
<div class="line"> </div>
<div class="line">phys1name = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga809364d0d36788e4674f4d669364bd39">chiSolverGetName</a>(phys1);</div>
<div class="line">initial_FR = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;OLD&quot;)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--time = 0.0</div>
<div class="line">--psi_t = psi_0</div>
<div class="line">--for k=1,10 do</div>
<div class="line">--    <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga4c3e39b671bc808b3c2c9748a5e93383">chiSolverStep</a>(phys1)</div>
<div class="line">--</div>
<div class="line">--    FRf = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;NEW&quot;) --time+dt</div>
<div class="line">--    FRi = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;OLD&quot;) --time</div>
<div class="line">--    dt = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chiLBTSGetProperty</a>(phys1, &quot;TIMESTEP&quot;)</div>
<div class="line">--    time = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chiLBTSGetProperty</a>(phys1, &quot;TIME&quot;)</div>
<div class="line">--    new_time = time+dt</div>
<div class="line">--</div>
<div class="line">--    period = dt/math.log(FRf/FRi)</div>
<div class="line">--    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0, <span class="keywordtype">string</span>.format(&quot;%s %4d time=%10.3g dt=%10.4g period=%10.3g FR=%10.3e&quot;,</div>
<div class="line">--            phys1name,k,time,dt,period,FRf/initial_FR))</div>
<div class="line">--</div>
<div class="line">--    if (not timestep_rejected) then</div>
<div class="line">--        chiLBTSAdvanceTimeValues()</div>
<div class="line">--    end</div>
<div class="line">--    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab51b4997706125b668f1c0ac9f3b79f5">chiLBTSAdvanceTimeData</a>(phys1)</div>
<div class="line">--end</div>
<div class="line"> </div>
<div class="line">--time = 0.0</div>
<div class="line">--time_stop = 1.0*100</div>
<div class="line">--k=0</div>
<div class="line">--swapped = false</div>
<div class="line">--timestep_rejected = false</div>
<div class="line">--</div>
<div class="line">--tolA = 10.0</div>
<div class="line">--while (time &lt; time_stop) do</div>
<div class="line">--    <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga4c3e39b671bc808b3c2c9748a5e93383">chiSolverStep</a>(phys1)</div>
<div class="line">--    FRf = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;NEW&quot;)</div>
<div class="line">--    FRi = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;OLD&quot;)</div>
<div class="line">--    dt = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chiLBTSGetProperty</a>(phys1, &quot;TIMESTEP&quot;)</div>
<div class="line">--    time = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chiLBTSGetProperty</a>(phys1, &quot;TIME&quot;)</div>
<div class="line">--    period = dt/math.log(FRf/FRi)</div>
<div class="line">--</div>
<div class="line">--    if (time &gt;= 0.2 and not swapped) then</div>
<div class="line">--        SwapXS(phys1, xs_weak_fuelB)</div>
<div class="line">--        swapped = true</div>
<div class="line">--    end</div>
<div class="line">--</div>
<div class="line">--    if (not timestep_rejected) then</div>
<div class="line">--        <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab51b4997706125b668f1c0ac9f3b79f5">chiLBTSAdvanceTimeData</a>(phys1)</div>
<div class="line">--        k = k + 1</div>
<div class="line">--        <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0, <span class="keywordtype">string</span>.format(&quot;%s %4d time=%10.3g dt=%10.4g period=%10.3g FR=%10.3e&quot;,</div>
<div class="line">--                phys1name,k,time,dt,period,FRf/initial_FR))</div>
<div class="line">--    else</div>
<div class="line">--        timestep_rejected = false</div>
<div class="line">--    end</div>
<div class="line">--end</div>
<div class="line">swapped=false</div>
<div class="line">function MyCallBack()</div>
<div class="line">    FRf = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;NEW&quot;)</div>
<div class="line">    FRi = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;OLD&quot;)</div>
<div class="line">    dt = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chiLBTSGetProperty</a>(phys1, &quot;TIMESTEP&quot;)</div>
<div class="line">    time = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chiLBTSGetProperty</a>(phys1, &quot;TIME&quot;)</div>
<div class="line">    period = dt/math.log(FRf/FRi)</div>
<div class="line"> </div>
<div class="line">    if (time &gt;= 0.2 and not swapped) then</div>
<div class="line">        SwapXS(phys1, xs_weak_fuelB)</div>
<div class="line">        swapped = true</div>
<div class="line">    end</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0,<span class="keywordtype">string</span>.format(&quot;%s time=%10.3g dt=%10.4g period=%10.3g FR=%10.3e&quot;,</div>
<div class="line">                phys1name,time,dt,period,FRf/initial_FR))</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chiLBTSSetProperty</a>(phys1, &quot;CALLBACK&quot;, &quot;MyCallBack&quot;)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Transient_TransientTransport2D_2_lua" name="tests_Transport_Transient_TransientTransport2D_2_lua"></a>tests/Transport_Transient/TransientTransport2D_2.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 1D Transient Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test:</div>
<div class="line">num_procs = 2</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">            <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">            <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=4</div>
<div class="line">L=100.0</div>
<div class="line">xmin_ = 0.0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line">--############################################### Add materials</div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line">-- Define microscopic cross sections</div>
<div class="line">xs_critical = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga82468060b3343581b90ceb06aa1e52c3">chiPhysicsTransportXSCreate</a>()</div>
<div class="line"><a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs_critical, CHI_XSFILE, &quot;tests/Transport_Transient/xs_inf_critical_1g.cxs&quot;)</div>
<div class="line">xs_21cent = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga82468060b3343581b90ceb06aa1e52c3">chiPhysicsTransportXSCreate</a>()</div>
<div class="line"><a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs_21cent, CHI_XSFILE, &quot;tests/Transport_Transient/xs_inf_21cent_1g.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">num_groups = 1</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        EXISTING,xs_critical)</div>
<div class="line"> </div>
<div class="line">src={0.0}</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">function SwapXS(solver_handle, new_xs)</div>
<div class="line">    <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">            EXISTING,new_xs)</div>
<div class="line">    <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gad44dcd1c761be67367c66fd3ff7cf865">chiLBSInitializeMaterials</a>(solver_handle)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a529534755839f8be78616016fa1bc711">chiLBSCreateTransientSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">fac=1</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,4*fac, 3*fac)</div>
<div class="line"><a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chiOptimizeAngularQuadratureForPolarSymmetry</a>(pqaud, 4.0*math.pi)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,8)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,1000)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line"> </div>
<div class="line">--</div>
<div class="line">----<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">--bsrc={}</div>
<div class="line">--<span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">--    bsrc[g] = 0.0</div>
<div class="line">--end</div>
<div class="line">--bsrc[1] = 1.0/2</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMIN,LBSBoundaryTypes.REFLECTING);</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,XMAX,LBSBoundaryTypes.REFLECTING);</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,YMIN,LBSBoundaryTypes.REFLECTING);</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,YMAX,LBSBoundaryTypes.REFLECTING);</div>
<div class="line">--</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#afa05f65c8e59f60b628b973204107feb">chiLBKESSetProperty</a>(phys1, &quot;MAX_ITERATIONS&quot;, 100)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#afa05f65c8e59f60b628b973204107feb">chiLBKESSetProperty</a>(phys1, &quot;TOLERANCE&quot;, 1.0e-8)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, USE_PRECURSORS, true)</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_INNER_ITERATIONS, false)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_INNER_ITERATIONS, false)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_OUTER_ITERATIONS, true)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chiLBTSSetProperty</a>(phys1, <span class="stringliteral">&quot;TIMESTEP&quot;</span>, 1e-3)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chiLBTSSetProperty</a>(phys1, &quot;VERBOSITY_LEVEL&quot;, 0)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chiLBTSSetProperty</a>(phys1, &quot;TIMESTEP_METHOD&quot;, &quot;CRANK_NICOLSON&quot;)</div>
<div class="line"> </div>
<div class="line">phys1name = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga809364d0d36788e4674f4d669364bd39">chiSolverGetName</a>(phys1);</div>
<div class="line">initial_FR = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;OLD&quot;)</div>
<div class="line"> </div>
<div class="line">--time = 0.0</div>
<div class="line">--for k=1,2 do</div>
<div class="line">--    --<a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chiLBTSSetProperty</a>(phys1, &quot;INHIBIT_ADVANCE&quot;, true)</div>
<div class="line">--    <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga4c3e39b671bc808b3c2c9748a5e93383">chiSolverStep</a>(phys1)</div>
<div class="line">--    FRf = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;NEW&quot;)</div>
<div class="line">--    FRi = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;OLD&quot;)</div>
<div class="line">--    dt = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chiLBTSGetProperty</a>(phys1, &quot;TIMESTEP&quot;)</div>
<div class="line">--    time = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chiLBTSGetProperty</a>(phys1, &quot;TIME&quot;)</div>
<div class="line">--    period = dt/math.log(FRf/FRi)</div>
<div class="line">--    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0, <span class="keywordtype">string</span>.format(&quot;%s %4d time=%10.3g dt=%10.4g period=%10.3g FR=%10.3e&quot;,</div>
<div class="line">--            phys1name,k,time,dt,period,FRf/initial_FR))</div>
<div class="line">--end</div>
<div class="line"> </div>
<div class="line">time = 0.0</div>
<div class="line">time_stop = 1.0</div>
<div class="line">k=0</div>
<div class="line">swapped = false</div>
<div class="line">while (time &lt; time_stop) do</div>
<div class="line">    k = k + 1</div>
<div class="line">    <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga4c3e39b671bc808b3c2c9748a5e93383">chiSolverStep</a>(phys1)</div>
<div class="line">    FRf = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;NEW&quot;)</div>
<div class="line">    FRi = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;OLD&quot;)</div>
<div class="line">    dt = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chiLBTSGetProperty</a>(phys1, &quot;TIMESTEP&quot;)</div>
<div class="line">    time = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chiLBTSGetProperty</a>(phys1, &quot;TIME&quot;)</div>
<div class="line">    period = dt/math.log(FRf/FRi)</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0, <span class="keywordtype">string</span>.format(&quot;%s %4d time=%10.3g dt=%10.4g period=%10.3g FR=%10.3e&quot;,</div>
<div class="line">            phys1name,k,time,dt,period,FRf/initial_FR))</div>
<div class="line">    if (time &gt;= 0.2 and not swapped) then</div>
<div class="line">        SwapXS(phys1, xs_21cent)</div>
<div class="line">        swapped = true</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab51b4997706125b668f1c0ac9f3b79f5">chiLBTSAdvanceTimeData</a>(phys1)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_Transport_Transient_TransientTransport2D_3_lua" name="tests_Transport_Transient_TransientTransport2D_3_lua"></a>tests/Transport_Transient/TransientTransport2D_3.lua</h3><div class="textblock"><div class="fragment"><div class="line">-- 1D Transient Transport test with <a class="code hl_enumvalue" href="../../d3/d65/namespacecfem__diffusion.html#a231772ce90e37a7ba9331c9194a99200a6cd4b7d03bb6843a34ee39757178fb10">Vacuum</a> BC.</div>
<div class="line">-- SDM: PWLD</div>
<div class="line">-- Test:</div>
<div class="line">num_procs = 2</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Check num_procs</div>
<div class="line"><span class="keywordflow">if</span> (check_num_procs==nil and chi_number_of_processes ~= num_procs) then</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0ERROR,<span class="stringliteral">&quot;Incorrect amount of processors. &quot;</span> ..</div>
<div class="line">            <span class="stringliteral">&quot;Expected &quot;</span>..tostring(num_procs)..</div>
<div class="line">            <span class="stringliteral">&quot;. Pass check_num_procs=false to override if possible.&quot;</span>)</div>
<div class="line">    os.exit(<span class="keyword">false</span>)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=160</div>
<div class="line">L=80.96897163</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-L/16,L/16,-L/16,L/16,-L/16,L/16)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#gae0ceeadeae53b7ac22b32f3665d1ea2a">chiMeshHandlerExportMeshToVTK</a>(&quot;TheMesh&quot;)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Add materials</span></div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Strong fuel&quot;</span>);</div>
<div class="line">materials[2] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Weak fuel&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],TRANSPORT_XSECTIONS)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],ISOTROPIC_MG_SOURCE)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[2],ISOTROPIC_MG_SOURCE)</div>
<div class="line"> </div>
<div class="line">-- Define microscopic cross sections</div>
<div class="line">xs_strong_fuel_micro = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga82468060b3343581b90ceb06aa1e52c3">chiPhysicsTransportXSCreate</a>()</div>
<div class="line"><a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs_strong_fuel_micro, CHI_XSFILE, &quot;tests/Transport_Transient/xs_inf_k1_6_1g.cxs&quot;)</div>
<div class="line">xs_weak_fuelA_micro = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga82468060b3343581b90ceb06aa1e52c3">chiPhysicsTransportXSCreate</a>()</div>
<div class="line"><a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs_weak_fuelA_micro, CHI_XSFILE, &quot;tests/Transport_Transient/xs_inf_critical_1g.cxs&quot;)</div>
<div class="line">xs_weak_fuelB_micro = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga82468060b3343581b90ceb06aa1e52c3">chiPhysicsTransportXSCreate</a>()</div>
<div class="line"><a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#ga5b6ee9dc31bfa7617f4f8e49edcc278c">chiPhysicsTransportXSSet</a>(xs_weak_fuelB_micro, CHI_XSFILE, &quot;tests/Transport_Transient/xs_inf_weak2_1g.cxs&quot;)</div>
<div class="line"> </div>
<div class="line">atom_density = 0.056559</div>
<div class="line">xs_strong_fuel = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#gaf2eaf25408e5d7cdc62b9c03a29cb502">chiPhysicsTransportXSMakeCombined</a>({{xs_strong_fuel_micro, atom_density}}) --critical</div>
<div class="line">xs_weak_fuelA  = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#gaf2eaf25408e5d7cdc62b9c03a29cb502">chiPhysicsTransportXSMakeCombined</a>({{ xs_weak_fuelA_micro, atom_density}}) --critical</div>
<div class="line">xs_weak_fuelB  = <a class="code hl_function" href="../../de/dd8/group___lua_transport_x_ss.html#gaf2eaf25408e5d7cdc62b9c03a29cb502">chiPhysicsTransportXSMakeCombined</a>({{xs_weak_fuelB_micro, atom_density}})   --critical</div>
<div class="line"> </div>
<div class="line">num_groups = 1</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],TRANSPORT_XSECTIONS,</div>
<div class="line">        EXISTING,xs_strong_fuel)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">        EXISTING,xs_weak_fuelA)</div>
<div class="line"> </div>
<div class="line">src={0.0}</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],ISOTROPIC_MG_SOURCE,FROM_ARRAY,src)</div>
<div class="line"> </div>
<div class="line">function SwapXS(solver_handle, new_xs)</div>
<div class="line">    <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[2],TRANSPORT_XSECTIONS,</div>
<div class="line">            EXISTING,new_xs)</div>
<div class="line">    <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gad44dcd1c761be67367c66fd3ff7cf865">chiLBSInitializeMaterials</a>(solver_handle)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">phys1 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a529534755839f8be78616016fa1bc711">chiLBSCreateTransientSolver</a>()</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">fac=3</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,2*fac, 2*fac)</div>
<div class="line"><a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chiOptimizeAngularQuadratureForPolarSymmetry</a>(pqaud, 4.0*math.pi)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,KRYLOV_GMRES_CYCLES)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,1000)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gab0c834b63faf291866f5db2b063897b5">chiLBSGroupsetSetWGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line">--<a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6f775fa549a000e9ef4dca648a8f0f26">chiLBSGroupsetSetTGDSA</a>(phys1,cur_gs,30,1.0e-4,false,&quot; &quot;)</div>
<div class="line"> </div>
<div class="line">--</div>
<div class="line">----<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line">--bsrc={}</div>
<div class="line">--<span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">--    bsrc[g] = 0.0</div>
<div class="line">--end</div>
<div class="line">--bsrc[1] = 1.0/2</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMIN,LBSBoundaryTypes.REFLECTING);</div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,BOUNDARY_CONDITION,ZMAX,LBSBoundaryTypes.REFLECTING);</div>
<div class="line">--</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,0)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#afa05f65c8e59f60b628b973204107feb">chiLBKESSetProperty</a>(phys1, &quot;MAX_ITERATIONS&quot;, 1000)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#afa05f65c8e59f60b628b973204107feb">chiLBKESSetProperty</a>(phys1, &quot;TOLERANCE&quot;, 1.0e-8)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, USE_PRECURSORS, true)</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_INNER_ITERATIONS, false)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_INNER_ITERATIONS, false)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1, VERBOSE_OUTER_ITERATIONS, true)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Initialize and Execute Solver</span></div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chiLBTSSetProperty</a>(phys1, <span class="stringliteral">&quot;TIMESTEP&quot;</span>, 1e-3)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chiLBTSSetProperty</a>(phys1, &quot;VERBOSITY_LEVEL&quot;, 0)</div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chiLBTSSetProperty</a>(phys1, &quot;TIMESTEP_METHOD&quot;, &quot;CRANK_NICOLSON&quot;)</div>
<div class="line"> </div>
<div class="line">phys1name = <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga809364d0d36788e4674f4d669364bd39">chiSolverGetName</a>(phys1);</div>
<div class="line">initial_FR = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;OLD&quot;)</div>
<div class="line"> </div>
<div class="line">--time = 0.0</div>
<div class="line">--for k=1,2 do</div>
<div class="line">--    --<a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#adc93d6def641a364a7d236d4e0544a80">chiLBTSSetProperty</a>(phys1, &quot;INHIBIT_ADVANCE&quot;, true)</div>
<div class="line">--    <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga4c3e39b671bc808b3c2c9748a5e93383">chiSolverStep</a>(phys1)</div>
<div class="line">--    FRf = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;NEW&quot;)</div>
<div class="line">--    FRi = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;OLD&quot;)</div>
<div class="line">--    dt = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chiLBTSGetProperty</a>(phys1, &quot;TIMESTEP&quot;)</div>
<div class="line">--    time = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chiLBTSGetProperty</a>(phys1, &quot;TIME&quot;)</div>
<div class="line">--    period = dt/math.log(FRf/FRi)</div>
<div class="line">--    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0, <span class="keywordtype">string</span>.format(&quot;%s %4d time=%10.3g dt=%10.4g period=%10.3g FR=%10.3e&quot;,</div>
<div class="line">--            phys1name,k,time,dt,period,FRf/initial_FR))</div>
<div class="line">--end</div>
<div class="line"> </div>
<div class="line">time = 0.0</div>
<div class="line">time_stop = 1.0</div>
<div class="line">k=0</div>
<div class="line">swapped = false</div>
<div class="line">while (time &lt; time_stop) do</div>
<div class="line">    k = k + 1</div>
<div class="line">    <a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga4c3e39b671bc808b3c2c9748a5e93383">chiSolverStep</a>(phys1)</div>
<div class="line">    FRf = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;NEW&quot;)</div>
<div class="line">    FRi = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab808368124d002e83f86816c20681e30">chiLBSComputeFissionRate</a>(phys1,&quot;OLD&quot;)</div>
<div class="line">    dt = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chiLBTSGetProperty</a>(phys1, &quot;TIMESTEP&quot;)</div>
<div class="line">    time = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a218a1b3c8e8c63410bca1097d3f464df">chiLBTSGetProperty</a>(phys1, &quot;TIME&quot;)</div>
<div class="line">    period = dt/math.log(FRf/FRi)</div>
<div class="line">    <a class="code hl_function" href="../../d4/d87/group___lua_logging.html#ga8139e633fb74f8d739bcfd6badd80376">chiLog</a>(LOG_0, <span class="keywordtype">string</span>.format(&quot;%s %4d time=%10.3g dt=%10.4g period=%10.3g FR=%10.3e&quot;,</div>
<div class="line">            phys1name,k,time,dt,period,FRf/initial_FR))</div>
<div class="line">    if (time &gt;= 0.2 and not swapped) then</div>
<div class="line">        SwapXS(phys1, xs_weak_fuelB)</div>
<div class="line">        swapped = true</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab51b4997706125b668f1c0ac9f3b79f5">chiLBTSAdvanceTimeData</a>(phys1)</div>
<div class="line">end</div>
</div><!-- fragment --> </div>

<h3><a id="tests_unit_test_inputs_SimTest01_FV_lua" name="tests_unit_test_inputs_SimTest01_FV_lua"></a>tests/unit_test_inputs/SimTest01_FV.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=100</div>
<div class="line">L=2</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga12dcd80ee2ab6104ba6e7142d7885221">chiMeshCreateUnpartitioned3DOrthoMesh</a>(mesh,mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line">--<a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#gabcd0e135b1081c3b9eb6661d44fb21d7">chiMeshCreateUnpartitioned1DOrthoMesh</a>(mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a80b22258d8965c8f90184237a334d405">chiSimTest01_FV</a>();</div>
<div class="ttc" id="anamespacechi__lua_html_a80b22258d8965c8f90184237a334d405"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#a80b22258d8965c8f90184237a334d405">chi_lua::chiSimTest01_FV</a></div><div class="ttdeci">void chiSimTest01_FV()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00009">lua_functions.c:9</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_unit_test_inputs_SimTest02_FV_lua" name="tests_unit_test_inputs_SimTest02_FV_lua"></a>tests/unit_test_inputs/SimTest02_FV.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=100</div>
<div class="line">L=2</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga12dcd80ee2ab6104ba6e7142d7885221">chiMeshCreateUnpartitioned3DOrthoMesh</a>(mesh,mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line">--<a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#gabcd0e135b1081c3b9eb6661d44fb21d7">chiMeshCreateUnpartitioned1DOrthoMesh</a>(mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a16cab1318a74a587402d4cdffe968309">chiSimTest02_FV</a>();</div>
<div class="ttc" id="anamespacechi__lua_html_a16cab1318a74a587402d4cdffe968309"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#a16cab1318a74a587402d4cdffe968309">chi_lua::chiSimTest02_FV</a></div><div class="ttdeci">void chiSimTest02_FV()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00035">lua_functions.c:35</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_unit_test_inputs_SimTest03_PWLC_lua" name="tests_unit_test_inputs_SimTest03_PWLC_lua"></a>tests/unit_test_inputs/SimTest03_PWLC.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=700</div>
<div class="line">L=2</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga12dcd80ee2ab6104ba6e7142d7885221">chiMeshCreateUnpartitioned3DOrthoMesh</a>(mesh,mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line">--<a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#gabcd0e135b1081c3b9eb6661d44fb21d7">chiMeshCreateUnpartitioned1DOrthoMesh</a>(mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a06679075939764a3163cecb66fd46c13">chiSimTest03_PWLC</a>();</div>
<div class="ttc" id="anamespacechi__lua_html_a06679075939764a3163cecb66fd46c13"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#a06679075939764a3163cecb66fd46c13">chi_lua::chiSimTest03_PWLC</a></div><div class="ttdeci">void chiSimTest03_PWLC()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00029">lua_functions.c:29</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_unit_test_inputs_SimTest04_PWLC_lua" name="tests_unit_test_inputs_SimTest04_PWLC_lua"></a>tests/unit_test_inputs/SimTest04_PWLC.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">if (nmesh==nil) then nmesh = 10 end</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=nmesh</div>
<div class="line">L=2</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga12dcd80ee2ab6104ba6e7142d7885221">chiMeshCreateUnpartitioned3DOrthoMesh</a>(mesh,mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line">--<a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#gabcd0e135b1081c3b9eb6661d44fb21d7">chiMeshCreateUnpartitioned1DOrthoMesh</a>(mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line">function MMS_phi(x,y,z)</div>
<div class="line">    return math.cos(math.pi*x) + math.cos(math.pi*y)</div>
<div class="line">end</div>
<div class="line">function MMS_q(x,y,z)</div>
<div class="line">    return math.pi*math.pi * (math.cos(math.pi*x)+math.cos(math.pi*y))</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#abea4e2d66757b0745f109b81735d55e9">chiSimTest04_PWLC</a>();</div>
<div class="ttc" id="anamespacechi__lua_html_abea4e2d66757b0745f109b81735d55e9"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#abea4e2d66757b0745f109b81735d55e9">chi_lua::chiSimTest04_PWLC</a></div><div class="ttdeci">void chiSimTest04_PWLC()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00047">lua_functions.c:47</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_unit_test_inputs_SimTest06_WDD_lua" name="tests_unit_test_inputs_SimTest06_WDD_lua"></a>tests/unit_test_inputs/SimTest06_WDD.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">if (nmesh==nil) then nmesh = 10 end</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=nmesh</div>
<div class="line">L=2</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga12dcd80ee2ab6104ba6e7142d7885221">chiMeshCreateUnpartitioned3DOrthoMesh</a>(mesh,mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line">--<a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#gabcd0e135b1081c3b9eb6661d44fb21d7">chiMeshCreateUnpartitioned1DOrthoMesh</a>(mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga88fb27136bed385ee1ec665d8d2e9e63">chiVolumeMesherSetMatIDToAll</a>(0)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ad6a560822424f3b3ba2d73d7f91db7d9">chiSimTest06_WDD</a>();</div>
<div class="ttc" id="anamespacechi__lua_html_ad6a560822424f3b3ba2d73d7f91db7d9"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#ad6a560822424f3b3ba2d73d7f91db7d9">chi_lua::chiSimTest06_WDD</a></div><div class="ttdeci">void chiSimTest06_WDD()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00015">lua_functions.c:15</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_unit_test_inputs_SimTest91_PWLD_lua" name="tests_unit_test_inputs_SimTest91_PWLD_lua"></a>tests/unit_test_inputs/SimTest91_PWLD.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=50</div>
<div class="line">L=2</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">--xmin_ = 0.0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">zmesh={}</div>
<div class="line">Nz=8</div>
<div class="line">Lz=1.6</div>
<div class="line">zmin_=0.0</div>
<div class="line">dz=Lz/Nz</div>
<div class="line"><span class="keywordflow">for</span> i=1,(Nz+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    zmesh[i] = zmin_ + k*dz</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga12dcd80ee2ab6104ba6e7142d7885221">chiMeshCreateUnpartitioned3DOrthoMesh</a>(mesh,mesh,zmesh)</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ae30dd6f5747f1f342bf51197e3778d75">chiSimTest91_PWLD</a>();</div>
<div class="line"> </div>
<div class="line">--[0]  Iteration     0   1.000e+00</div>
<div class="line">--[0]  Iteration     1   2.016e+02</div>
<div class="line">--[0]  Iteration     2   1.941e+00</div>
<div class="line">--[0]  Iteration     3   1.294e+00</div>
<div class="line">--[0]  Iteration     4   3.890e-01</div>
<div class="line">--[0]  Iteration     5   2.887e-02</div>
<div class="line">--[0]  Iteration     6   1.239e-03</div>
<div class="line">--[0]  Iteration     7   4.076e-05</div>
<div class="line">--[0]  Iteration     8   1.119e-06</div>
<div class="line">--[0]  Iteration     9   2.955e-08</div>
<div class="ttc" id="anamespacechi__lua_html_ae30dd6f5747f1f342bf51197e3778d75"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#ae30dd6f5747f1f342bf51197e3778d75">chi_lua::chiSimTest91_PWLD</a></div><div class="ttdeci">void chiSimTest91_PWLD()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00023">lua_functions.c:23</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_unit_test_inputs_SimTest92_DSA_lua" name="tests_unit_test_inputs_SimTest92_DSA_lua"></a>tests/unit_test_inputs/SimTest92_DSA.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">if (nmesh==nil) then nmesh = 10 end</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=nmesh</div>
<div class="line">L=2</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">--xmin_ = 0.0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">zmesh={}</div>
<div class="line">Nz=8</div>
<div class="line">Lz=1.6</div>
<div class="line">zmin_=0.0</div>
<div class="line">dz=Lz/Nz</div>
<div class="line"><span class="keywordflow">for</span> i=1,(Nz+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    zmesh[i] = zmin_ + k*dz</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga12dcd80ee2ab6104ba6e7142d7885221">chiMeshCreateUnpartitioned3DOrthoMesh</a>(mesh,mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line">--<a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#gabcd0e135b1081c3b9eb6661d44fb21d7">chiMeshCreateUnpartitioned1DOrthoMesh</a>(mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gaffef57d848300c3cb87f8ef6c4954b8d">chiVolumeMesherSetupOrthogonalBoundaries</a>()</div>
<div class="line"> </div>
<div class="line">function MMS_phi(x,y,z)</div>
<div class="line">    return math.cos(math.pi*x) + math.cos(math.pi*y)</div>
<div class="line">end</div>
<div class="line">function MMS_q(x,y,z)</div>
<div class="line">    return math.pi*math.pi * (math.cos(math.pi*x)+math.cos(math.pi*y))</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a4cec898658d8dcdb6f3dc46413fff266">chiSimTest92_DSA</a>();</div>
<div class="line"> </div>
<div class="line">--[0]  Iteration     0   1.000e+00</div>
<div class="line">--[0]  Iteration     1   2.016e+02</div>
<div class="line">--[0]  Iteration     2   1.941e+00</div>
<div class="line">--[0]  Iteration     3   1.294e+00</div>
<div class="line">--[0]  Iteration     4   3.890e-01</div>
<div class="line">--[0]  Iteration     5   2.887e-02</div>
<div class="line">--[0]  Iteration     6   1.239e-03</div>
<div class="line">--[0]  Iteration     7   4.076e-05</div>
<div class="line">--[0]  Iteration     8   1.119e-06</div>
<div class="line">--[0]  Iteration     9   2.955e-08</div>
<div class="ttc" id="anamespacechi__lua_html_a4cec898658d8dcdb6f3dc46413fff266"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#a4cec898658d8dcdb6f3dc46413fff266">chi_lua::chiSimTest92_DSA</a></div><div class="ttdeci">void chiSimTest92_DSA()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00017">lua_functions.c:17</a></div></div>
</div><!-- fragment --> </div>

<h3><a id="tests_unit_test_inputs_SimTest93_RayTracing_lua" name="tests_unit_test_inputs_SimTest93_RayTracing_lua"></a>tests/unit_test_inputs/SimTest93_RayTracing.lua</h3><div class="textblock"><div class="fragment"><div class="line">--############################################### Setup mesh</div>
<div class="line"><a class="code hl_function" href="../../da/d92/group___lua_mesh_handler.html#ga3be36a5ecf5469ad0980dd5aa4097a2a">chiMeshHandlerCreate</a>()</div>
<div class="line"> </div>
<div class="line">if (nmesh==nil) then nmesh = 11 end</div>
<div class="line"> </div>
<div class="line">mesh={}</div>
<div class="line">N=nmesh</div>
<div class="line">L=11</div>
<div class="line">xmin_ = -L/2</div>
<div class="line">--xmin_ = 0.0</div>
<div class="line">dx = L/N</div>
<div class="line"><span class="keywordflow">for</span> i=1,(N+1) <span class="keywordflow">do</span></div>
<div class="line">    k=i-1</div>
<div class="line">    mesh[i] = xmin_ + k*dx</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--<a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga12dcd80ee2ab6104ba6e7142d7885221">chiMeshCreateUnpartitioned3DOrthoMesh</a>(mesh,mesh,mesh)</div>
<div class="line"><a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#ga83d9d3e4a7ae7060391faefe17c1076a">chiMeshCreateUnpartitioned2DOrthoMesh</a>(mesh,mesh)</div>
<div class="line">--<a class="code hl_function" href="../../d9/db8/group___lua_mesh_macros.html#gabcd0e135b1081c3b9eb6661d44fb21d7">chiMeshCreateUnpartitioned1DOrthoMesh</a>(mesh)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gad031f7f22f9a1b4d7ea535f04c56ae1f">chiVolumeMesherExecute</a>();</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> Material IDs</div>
<div class="line">vol0 = <a class="code hl_function" href="../../d9/d32/group___lua_logic_volumes.html#gac362f65e2642b15efd6abf99d2224d54">chiLogicalVolumeCreate</a>(<a class="code hl_define" href="../../d9/df5/chi__mesh__logicalvolume_8h.html#ab27b91d4128c63b2fa1ff9d4c7f179a5">RPP</a>,-1000,1000,-1000,1000,-1000,1000)</div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#ga67050e80fa0bffde80b9df0ae75d222b">chiVolumeMesherSetProperty</a>(<a class="code hl_enumvalue" href="../../d0/d81/namespacechi__mesh.html#a496eecf9633f022b12704bc27a6726a5a9736e723930ad60f2829f5ef19148803">MATID_FROMLOGICAL</a>,vol0,0)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d4/d3a/group___lua_volume_mesher.html#gaffef57d848300c3cb87f8ef6c4954b8d">chiVolumeMesherSetupOrthogonalBoundaries</a>()</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#a90f1bf8db9dd03373ea54a140cd446fc">chiSimTest93_RayTracing</a>()</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">###############################################</span></div>
<div class="line">--############################################### Add materials</div>
<div class="line">materials = {}</div>
<div class="line">materials[1] = <a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gaa19753665bde67f4e125fd204848c342">chiPhysicsAddMaterial</a>(<span class="stringliteral">&quot;Test Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gad2a1538276adff6c1d723a7a26131f08">chiPhysicsMaterialAddProperty</a>(materials[1],TRANSPORT_XSECTIONS)</div>
<div class="line"> </div>
<div class="line">num_groups = 1</div>
<div class="line"><a class="code hl_function" href="../../d7/d11/group___lua_physics_materials.html#gafc1f3164b69c49a99040dab87b827ed7">chiPhysicsMaterialSetProperty</a>(materials[1],</div>
<div class="line">        TRANSPORT_XSECTIONS,</div>
<div class="line">        SIMPLEXS0,1,0.27)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">--############################################### Setup Physics</div>
<div class="line">solver_name = <span class="stringliteral">&quot;LBS&quot;</span></div>
<div class="line">phys1 = <a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#gab469beed321e0c7688d4f537b480f5a6">chiLBSCreateSolver</a>(solver_name)</div>
<div class="line"> </div>
<div class="line">--========== Groups</div>
<div class="line">grp = {}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    grp[g] = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7d16e3fc369204834a671a6ecf34b564">chiLBSCreateGroup</a>(phys1)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">--========== ProdQuad</div>
<div class="line">pquad = <a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga310caeec08395d1fa35d319489fc08f2">chiCreateProductQuadrature</a>(GAUSS_LEGENDRE_CHEBYSHEV,12*2*4, 12*4)</div>
<div class="line"><a class="code hl_function" href="../../de/d37/group___lua_quadrature.html#ga8c4e64918adaadfcd5bcfa03d515143a">chiOptimizeAngularQuadratureForPolarSymmetry</a>(pqaud, 4.0*math.pi)</div>
<div class="line"> </div>
<div class="line">--========== Groupset def</div>
<div class="line">gs0 = <a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf5d1e656f52f80b4615f022003d1b407">chiLBSCreateGroupset</a>(phys1)</div>
<div class="line">cur_gs = gs0</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga01177a474f138bc1a8b2de984c5d19ae">chiLBSGroupsetAddGroups</a>(phys1,cur_gs,0,num_groups-1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga6259f18338815b40c3dabacc85bbaa20">chiLBSGroupsetSetQuadrature</a>(phys1,cur_gs,pquad)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga80f2a61eab1d91be0b1a2fbb7eee248d">chiLBSGroupsetSetAngleAggDiv</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga90ea59396524ccbe65703b14faa7c10f">chiLBSGroupsetSetGroupSubsets</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf50e94d09febcd8a846433e007ef4fd3">chiLBSGroupsetSetIterativeMethod</a>(phys1,cur_gs,NPT_CLASSICRICHARDSON)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaa3a93090cb8354c7f2140d569497d9ca">chiLBSGroupsetSetResidualTolerance</a>(phys1,cur_gs,1.0e-6)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#ga7ea307566dd5e37892f4d3398b87dd51">chiLBSGroupsetSetMaxIterations</a>(phys1,cur_gs,1)</div>
<div class="line"><a class="code hl_function" href="../../d5/d03/group___lua_l_b_s_groupsets.html#gaf8947d86f23a21e9243035e717e5ee4d">chiLBSGroupsetSetGMRESRestartIntvl</a>(phys1,cur_gs,100)</div>
<div class="line"> </div>
<div class="line">--<span class="preprocessor">############################################### Set boundary conditions</span></div>
<div class="line"> </div>
<div class="line">--############################################### Add point source</div>
<div class="line">src={}</div>
<div class="line"><span class="keywordflow">for</span> g=1,num_groups <span class="keywordflow">do</span></div>
<div class="line">    src[g] = 0.0</div>
<div class="line">end</div>
<div class="line">src[1] = 1.0</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga925760d56a5295d53aea810939693b39">chiLBSAddPointSource</a>(phys1, 0.0, 0.0, 0.0, src)</div>
<div class="line"> </div>
<div class="line">--############################################### <a class="code hl_function" href="../../dc/d58/namespacechi__math.html#a75948cb3d263fe5216470bae075742ea">Set</a> solver properties</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,DISCRETIZATION_METHOD,PWLD)</div>
<div class="line"><a class="code hl_function" href="../../d0/daf/group___lua_l_b_s.html#ga56ba50206c4125503807c5889416b66a">chiLBSSetProperty</a>(phys1,SCATTERING_ORDER,0)</div>
<div class="line"> </div>
<div class="line">--############################################### Initialize and Execute Solver</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#gab828b1bcee57fed19f7dda9befc5846b">chiSolverInitialize</a>(phys1)</div>
<div class="line"><a class="code hl_function" href="../../dc/d4e/group___lua_solver.html#ga28fdf6aad809b089f96c1776f699ee5c">chiSolverExecute</a>(phys1)</div>
<div class="line"> </div>
<div class="line">ff_m0 = <a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#aa98bc59e0c79ae51d0a3337da4311cf2">chiGetFieldFunctionHandleByName</a>(solver_name..<span class="stringliteral">&quot;_Flux_g0_m0&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d8/dd9/namespacechi__lua.html#ab044ed9b1310ab95d5af2266a87869d3">chiExportMultiFieldFunctionToVTK</a>({ff_m0},<span class="stringliteral">&quot;ZPhi_&quot;</span>..solver_name)</div>
<div class="ttc" id="anamespacechi__lua_html_a90f1bf8db9dd03373ea54a140cd446fc"><div class="ttname"><a href="../../d8/dd9/namespacechi__lua.html#a90f1bf8db9dd03373ea54a140cd446fc">chi_lua::chiSimTest93_RayTracing</a></div><div class="ttdeci">void chiSimTest93_RayTracing()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l00038">lua_functions.c:38</a></div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
