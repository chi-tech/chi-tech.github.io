<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Chi-Tech: Simplified LDFESQ</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Logo2_Small.bmp"/></td>
  <td id="projectalign">
   <div id="projectname">Chi-Tech
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('de/d7d/group___lua_s_l_d_f_e_s_q.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Simplified LDFESQ<div class="ingroups"><a class="el" href="../../d0/d4d/group___lua_math.html">B Math</a> &raquo; <a class="el" href="../../de/d37/group___lua_quadrature.html">Quadrature rules</a></div></div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga922f086ff20a1e5d4e246b253546204c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d7d/group___lua_s_l_d_f_e_s_q.html#ga922f086ff20a1e5d4e246b253546204c">chi_lua::chiPrintToPythonSLDFESQAngularQuadrature</a> (int handle, string file_name_prefix)</td></tr>
<tr class="separator:ga922f086ff20a1e5d4e246b253546204c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2c034031bf7968f07b31b34e4ae749e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d7d/group___lua_s_l_d_f_e_s_q.html#ga2c034031bf7968f07b31b34e4ae749e1">chi_lua::chiLocallyRefineSLDFESQAngularQuadrature</a> (int. handle, vec3 reference_direction, double cone_size, bool invert_logic)</td></tr>
<tr class="separator:ga2c034031bf7968f07b31b34e4ae749e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab03ca8a4174984e0978c65e367d44e50"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d7d/group___lua_s_l_d_f_e_s_q.html#gab03ca8a4174984e0978c65e367d44e50">chi_lua::chiCreateSLDFESQAngularQuadrature</a> (int initial_refinement_level)</td></tr>
<tr class="separator:gab03ca8a4174984e0978c65e367d44e50"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p >This quadrature is a simplified implementation of the quadrature defined in the paper by Cheuk Lau and Marvin Adams: "Discrete Ordinates Quadratures Based on Linear
and Quadratic Discontinuous Finite Elements over
Spherical Quadrilaterals", Nuclear Science and Engineering, 185:1, pages 36-52, 2017.</p>
<div class="image">
<img src="../../SLDFESQn40.png" alt="" width="800px"/>
<div class="caption">
LDFE Spherical Quadrilaterals at a refinement level of n=40</div></div>
<h1>Synopsis</h1>
<ul>
<li>The initial refinement is generated for the octant where all the direction cosines are positive. We will call this the first octant.</li>
<li>A cube of side length \(a=\frac{1}{\sqrt{3}}\) is inscribed within the unit sphere and the origin planes. This cube has three faces that project onto the unit sphere in the first octant. <div class="image">
<img src="../../SLDFESQFig2.png" alt="" width="800px"/>
<div class="caption">
The inscribed cube with one of the faces subdivided</div></div>
</li>
<li>Each face of the cube can be described by a local coordinate system, \(\tilde{x}\), \( \tilde{y}\). In this reference frame each face is identically subdivided into an orthogonal grid. The generated grid-cells are called sub-squares.</li>
<li>A face and its associated sub-squares, in the local reference frame, can be rotated and translated onto the cube faces, for which we will call the reference frame the \(xyz\)-prime reference frame.</li>
<li>The sub-squares on each face project onto Spherical Quadrilaterals (SQs) on the unit sphere, a space which we shall refer to as the \(xyz\) reference frame. Or in the paper mu-eta-xi. <div class="image">
<img src="../../SLDFESQFig3.png" alt="" width="400px"/>
</div>
</li>
<li>Once the SQs are generated we have numerous choices on where to define quadrature points and associated shape functions. In the LDFE formulation we need 4 quadrature points and, for simplicity, we restrict the placement of these points in a certain manner. We form radii, in the xy-tilde reference, from the sub-square centroids to each corner of the sub-square (essentially producing sub-sub-squares) and then chose to place our quadrature points only on these points.</li>
<li>The placement of the quadrature points can then be projected to xyz after which the shape function coefficients can be determined.</li>
<li>The weight of each quadrature point is the spherical surface area integral of its shape function. This integral is done with a high order Guass-Legendre quadrature and a Jacobian \( \frac{a}{r^3} \).</li>
<li>The original Lau and Adams paper used a Multi-variate secant method to determine the placement of the quadrature points along the sub-sub-square radii.</li>
</ul>
<h1>Specific notes for the simplified version</h1>
<h2>Initial sub-division of the inscribed cube face</h2>
<p >The orthogonal grid in the xy-tilde reference frame is dependent on a a diagonal spacing of grid points. The paper by Lau and Adams did not specify exactly how to generate this spacing but only stated that their spacing minimizes the max/avg and max/min ratio of projected SQ to 1.1 and 1.3 respectively. We found that the application of a weighting function, \( \alpha (\cos \beta \frac{\pi}{2} x - \cos \beta \frac{\pi}{2})\) produces the optimal spacing. See the code for additional clarification.</p>
<h2>Placement of the quadrature points</h2>
<p >Instead of using a multi-variate secant method to place the quadrature points we found that placing the points on the 4 Gauss-Legendre points for a quadrilateral ( \([\pm \frac{1}{\sqrt{3}},\pm \frac{1}{\sqrt{3}} ]\))still produced 4th order convergence and added a lot of speed to the algorithm.</p>
<h2>Integration of basis functions</h2>
<p >The determinant of the Jacobian can be hard to derive. It can be done in the two ways: <a href="../../../../HTMLimages/SLDFESQ_JacobianA.jpg">using a cross-product</a> or in <a href="../../../../HTMLimages/SLDFESQ_JacobianB.jpg">angle-space</a>.</p>
<h2>Local refinement</h2>
<p >The data structures employed allows the SQs to easily be refined in certain regions. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="gab03ca8a4174984e0978c65e367d44e50" name="gab03ca8a4174984e0978c65e367d44e50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab03ca8a4174984e0978c65e367d44e50">&#9670;&nbsp;</a></span>chiCreateSLDFESQAngularQuadrature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void chi_lua::chiCreateSLDFESQAngularQuadrature </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>initial_refinement_level</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Creates a Simplified Linear Discontinuous Finite Element (SLDFE) quadrature based on Spherical Quadrilaterals (SQ). Hence SLDFE-SQ. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">initial_refinement_level</td><td>int Initial refinement level, \(n\) to be used. The total number of angles will be \( 8{\times}12(n+1)^2 \).</td></tr>
  </table>
  </dd>
</dl>
<h2>_</h2>
<h3>Example:</h3>
<p >Example with refinement level 2. </p><div class="fragment"><div class="line">pquad = <a class="code hl_function" href="../../de/d7d/group___lua_s_l_d_f_e_s_q.html#gab03ca8a4174984e0978c65e367d44e50">chiCreateSLDFESQAngularQuadrature</a>(2)</div>
<div class="ttc" id="agroup___lua_s_l_d_f_e_s_q_html_gab03ca8a4174984e0978c65e367d44e50"><div class="ttname"><a href="../../de/d7d/group___lua_s_l_d_f_e_s_q.html#gab03ca8a4174984e0978c65e367d44e50">chi_lua::chiCreateSLDFESQAngularQuadrature</a></div><div class="ttdeci">void chiCreateSLDFESQAngularQuadrature(int initial_refinement_level)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l03359">lua_functions.c:3359</a></div></div>
</div><!-- fragment --><div class="image">
<img src="../../SLDFESQBasen2.png" alt="" width="500px"/>
</div>
<p> With direction points: </p><div class="image">
<img src="../../SLDFESQBasen2Oct2.png" alt="" width="500px"/>
</div>
<dl class="section author"><dt>Author</dt><dd>Jan </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d47/lua__functions_8c_source.html#l03359">3359</a> of file <a class="el" href="../../d7/d47/lua__functions_8c_source.html">lua_functions.c</a>.</p>

</div>
</div>
<a id="ga2c034031bf7968f07b31b34e4ae749e1" name="ga2c034031bf7968f07b31b34e4ae749e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2c034031bf7968f07b31b34e4ae749e1">&#9670;&nbsp;</a></span>chiLocallyRefineSLDFESQAngularQuadrature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void chi_lua::chiLocallyRefineSLDFESQAngularQuadrature </td>
          <td>(</td>
          <td class="paramtype">int.&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vec3&#160;</td>
          <td class="paramname"><em>reference_direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cone_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>invert_logic</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Applies a local refinement of angles. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>int. Handle to the reference quadrature. </td></tr>
    <tr><td class="paramname">reference_direction</td><td>vec3 Reference vector. \( \vec{r} \) </td></tr>
    <tr><td class="paramname">cone_size</td><td>double Cone size in radians. \( \theta \) </td></tr>
    <tr><td class="paramname">invert_logic</td><td>bool Optional[Default:false]. If supplied, interprets SQ-splitting as when \(|\omega \cdot \vec{r}| &lt; \sin(\theta) \). Otherwise, SQs will be split if \( \omega \cdot \vec{r} &gt; \cos(\theta)\)</td></tr>
  </table>
  </dd>
</dl>
<h2>_</h2>
<h3>Example:</h3>
<p >Example with refinement level 2 and a triple directional refinement: </p><div class="fragment"><div class="line">pquad = <a class="code hl_function" href="../../de/d7d/group___lua_s_l_d_f_e_s_q.html#gab03ca8a4174984e0978c65e367d44e50">chiCreateSLDFESQAngularQuadrature</a>(2)</div>
<div class="line"><a class="code hl_function" href="../../de/d7d/group___lua_s_l_d_f_e_s_q.html#ga2c034031bf7968f07b31b34e4ae749e1">chiLocallyRefineSLDFESQAngularQuadrature</a>(pquad,{1,0,0},45.0*math.pi/180,<span class="keyword">false</span>)</div>
<div class="line"><a class="code hl_function" href="../../de/d7d/group___lua_s_l_d_f_e_s_q.html#ga2c034031bf7968f07b31b34e4ae749e1">chiLocallyRefineSLDFESQAngularQuadrature</a>(pquad,{1,0,0},23.0*math.pi/180,<span class="keyword">false</span>)</div>
<div class="line"><a class="code hl_function" href="../../de/d7d/group___lua_s_l_d_f_e_s_q.html#ga2c034031bf7968f07b31b34e4ae749e1">chiLocallyRefineSLDFESQAngularQuadrature</a>(pquad,{1,0,0},12.0*math.pi/180,<span class="keyword">false</span>)</div>
<div class="ttc" id="agroup___lua_s_l_d_f_e_s_q_html_ga2c034031bf7968f07b31b34e4ae749e1"><div class="ttname"><a href="../../de/d7d/group___lua_s_l_d_f_e_s_q.html#ga2c034031bf7968f07b31b34e4ae749e1">chi_lua::chiLocallyRefineSLDFESQAngularQuadrature</a></div><div class="ttdeci">void chiLocallyRefineSLDFESQAngularQuadrature(int. handle, vec3 reference_direction, double cone_size, bool invert_logic)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l03338">lua_functions.c:3338</a></div></div>
</div><!-- fragment --><div class="image">
<img src="../../SLDFESQr.png" alt="" width="500px"/>
</div>
<p >Example with refinement level 2 and a triple planar refinement: </p><div class="fragment"><div class="line">pquad = <a class="code hl_function" href="../../de/d7d/group___lua_s_l_d_f_e_s_q.html#gab03ca8a4174984e0978c65e367d44e50">chiCreateSLDFESQAngularQuadrature</a>(2)</div>
<div class="line"><a class="code hl_function" href="../../de/d7d/group___lua_s_l_d_f_e_s_q.html#ga2c034031bf7968f07b31b34e4ae749e1">chiLocallyRefineSLDFESQAngularQuadrature</a>(pquad,{1,0,0},22.50*math.pi/180,<span class="keyword">true</span>)</div>
<div class="line"><a class="code hl_function" href="../../de/d7d/group___lua_s_l_d_f_e_s_q.html#ga2c034031bf7968f07b31b34e4ae749e1">chiLocallyRefineSLDFESQAngularQuadrature</a>(pquad,{1,0,0},11.75*math.pi/180,<span class="keyword">true</span>)</div>
<div class="line"><a class="code hl_function" href="../../de/d7d/group___lua_s_l_d_f_e_s_q.html#ga2c034031bf7968f07b31b34e4ae749e1">chiLocallyRefineSLDFESQAngularQuadrature</a>(pquad,{1,0,0},5.000*math.pi/180,<span class="keyword">true</span>)</div>
</div><!-- fragment --><div class="image">
<img src="../../SLDFESQp.png" alt="" width="500px"/>
</div>
<dl class="section author"><dt>Author</dt><dd>Jan </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d47/lua__functions_8c_source.html#l03338">3338</a> of file <a class="el" href="../../d7/d47/lua__functions_8c_source.html">lua_functions.c</a>.</p>

</div>
</div>
<a id="ga922f086ff20a1e5d4e246b253546204c" name="ga922f086ff20a1e5d4e246b253546204c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga922f086ff20a1e5d4e246b253546204c">&#9670;&nbsp;</a></span>chiPrintToPythonSLDFESQAngularQuadrature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void chi_lua::chiPrintToPythonSLDFESQAngularQuadrature </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>file_name_prefix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Outputs the quadrature information to python format. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>int Handle to the reference quadrature. </td></tr>
    <tr><td class="paramname">file_name_prefix</td><td>string Prefix to be used in front of file.</td></tr>
  </table>
  </dd>
</dl>
<h2>_</h2>
<h3>Example:</h3>
<p >Example of printing a quadrature: Example with refinement level 2 and a triple directional refinement: </p><div class="fragment"><div class="line">pquad = <a class="code hl_function" href="../../de/d7d/group___lua_s_l_d_f_e_s_q.html#gab03ca8a4174984e0978c65e367d44e50">chiCreateSLDFESQAngularQuadrature</a>(2)</div>
<div class="line"><a class="code hl_function" href="../../de/d7d/group___lua_s_l_d_f_e_s_q.html#ga2c034031bf7968f07b31b34e4ae749e1">chiLocallyRefineSLDFESQAngularQuadrature</a>(pquad,{1,0,0},45.0*math.pi/180,<span class="keyword">false</span>)</div>
<div class="line"><a class="code hl_function" href="../../de/d7d/group___lua_s_l_d_f_e_s_q.html#ga2c034031bf7968f07b31b34e4ae749e1">chiLocallyRefineSLDFESQAngularQuadrature</a>(pquad,{1,0,0},23.0*math.pi/180,<span class="keyword">false</span>)</div>
<div class="line"><a class="code hl_function" href="../../de/d7d/group___lua_s_l_d_f_e_s_q.html#ga2c034031bf7968f07b31b34e4ae749e1">chiLocallyRefineSLDFESQAngularQuadrature</a>(pquad,{1,0,0},12.0*math.pi/180,<span class="keyword">false</span>)</div>
<div class="line"><a class="code hl_function" href="../../de/d7d/group___lua_s_l_d_f_e_s_q.html#ga922f086ff20a1e5d4e246b253546204c">chiPrintToPythonSLDFESQAngularQuadrature</a>(pquad,<span class="stringliteral">&quot;YQuad_&quot;</span>);</div>
<div class="ttc" id="agroup___lua_s_l_d_f_e_s_q_html_ga922f086ff20a1e5d4e246b253546204c"><div class="ttname"><a href="../../de/d7d/group___lua_s_l_d_f_e_s_q.html#ga922f086ff20a1e5d4e246b253546204c">chi_lua::chiPrintToPythonSLDFESQAngularQuadrature</a></div><div class="ttdeci">void chiPrintToPythonSLDFESQAngularQuadrature(int handle, string file_name_prefix)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d47/lua__functions_8c_source.html#l03303">lua_functions.c:3303</a></div></div>
</div><!-- fragment --><div class="image">
<img src="../../SLDFESQr.png" alt="" width="500px"/>
</div>
<dl class="section author"><dt>Author</dt><dd>Jan </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d47/lua__functions_8c_source.html#l03303">3303</a> of file <a class="el" href="../../d7/d47/lua__functions_8c_source.html">lua_functions.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
