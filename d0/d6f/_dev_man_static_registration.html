<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Chi-Tech: Static Registration</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Logo2_Small.bmp"/></td>
  <td id="projectalign">
   <div id="projectname">Chi-Tech
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d0/d6f/_dev_man_static_registration.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Static Registration </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#DevManParametersSec1">1 The general philosophy of Static Registration</a><ul><li class="level2"><a href="#DevManParametersSec1_1">Rigging static initialization for object factories or object makers</a></li>
</ul>
</li>
<li class="level1"><a href="#DevManParametersSec2">2 Implementation in ChiTech: ChiObject and ChiObjectFactory</a></li>
<li class="level1"><a href="#DevManParametersSec3">3 The InputParameters system</a><ul><li class="level2"><a href="#DevManParametersSecFAQ1">FAQ1 Documentation-strings (Doc-strings)</a></li>
<li class="level2"><a href="#DevManParametersSecFAQ2">FAQ2 Optional Parameters</a></li>
<li class="level2"><a href="#DevManParametersSecFAQ3">FAQ3 Inheriting parameters from parent objects</a></li>
<li class="level2"><a href="#DevManParametersSecFAQ4">FAQ4 Changing inherited options to optional/required</a></li>
<li class="level2"><a href="#DevManParametersSecFAQ5">FAQ5 Deprecated parameters</a></li>
<li class="level2"><a href="#DevManParametersSecFAQ6">FAQ6 Constrained ranges</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p >This page explains the details of the two utility classes <code>ParameterBlock</code> and <code>InputParameters</code>.</p>
<h1><a class="anchor" id="DevManParametersSec1"></a>
1 The general philosophy of Static Registration</h1>
<p >First, what is <b>Static Registration</b>? When a c++ program is executed there are a number of phases that occur in order. Once such phase, before entering the <code>main</code> function, is the phase in which all static variables are initialized. We shall call this phase the static initialization phase. In the most basic sense static registration is the process whereby we create a registry of object-constructors during this phase. This registry can then used, during the dynamic phases of the program, to construct objects. A simple example is the code below: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;DoSomethingFunctions&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> a = DoSomething();</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="../../d4/dca/chi__tech__main_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>()</div>
<div class="line">{</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;The value of a is: &quot;</span> &lt;&lt; a &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="ttc" id="achi__tech__main_8cc_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="../../d4/dca/chi__tech__main_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dca/chi__tech__main_8cc_source.html#l00010">chi_tech_main.cc:10</a></div></div>
</div><!-- fragment --><p> where the variable <code>int a</code> is initialized, before the <code>main</code> function starts, using a function call, which happens during the static initialization phase of the program.</p>
<h2><a class="anchor" id="DevManParametersSec1_1"></a>
Rigging static initialization for object factories or object makers</h2>
<p >We can use the rather odd dynamics of singleton objects to create a static registry of function creation calls during static initialization. In the code below we define an <code>ObjectMaker</code> class that is a singleton. A singleton is an object of which only a single instance can be created, which we do by declaring a static instance, a bunch of static members methods, a private constructor and deleted copy- and move constructors.</p>
<p >The <code>ObjectMaker</code> maintains a map of string keys to object construction calls. The construction calls always return a pointer to a base class <code>Object</code> but can construct any child object by using the shown template arguments. In order for us to achieve basic static registration we need two templated-methods, these are <code>CallObjectConstructor</code> and <code>RegisterObject</code> in the code below. The first method defines a function-address that we can put into our registry. The second method is the actual method we call to make a registry entry. When we then want to make a registered object we simply call the <code>MakeRegisteredObject</code> method.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;functional&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>Object</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keywordtype">int</span> member_;</div>
<div class="line">  Object() : member_(99) {}</div>
<div class="line">  Object(<span class="keywordtype">int</span> member) : member_(member) {}</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>ChildObject : <span class="keyword">public</span> Object</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  ChildObject() : Object(999) {}</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">//===============================================</span></div>
<div class="line"><span class="keyword">typedef</span> std::function&lt;Object*()&gt; CreationFunction;</div>
<div class="line"><span class="keyword">class </span>ObjectMaker <span class="comment">// Singleton</span></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  std::map&lt;std::string, CreationFunction&gt; registry_;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">static</span> ObjectMaker&amp; GetInstance() noexcept</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">static</span> ObjectMaker singleton;</div>
<div class="line">    <span class="keywordflow">return</span> singleton;</div>
<div class="line">  }</div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">  <span class="keyword">static</span> Object* CallObjectConstructor() { <span class="keywordflow">return</span> <span class="keyword">new</span> T(); }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">  <span class="keyword">static</span> <span class="keywordtype">int</span> RegisterObject(<span class="keyword">const</span> std::string&amp; register_name)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">auto</span>&amp; instance = GetInstance();</div>
<div class="line">    instance.registry_.insert(</div>
<div class="line">      std::make_pair(register_name, &amp;CallObjectConstructor&lt;T&gt;));</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> Object* MakeRegisteredObject(<span class="keyword">const</span> std::string&amp; obj_name)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">auto</span>&amp; instance = GetInstance();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> instance.registry_.at(obj_name)();</div>
<div class="line">  }</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  ObjectMaker() = <span class="keywordflow">default</span>;</div>
<div class="line">  ObjectMaker(<span class="keyword">const</span> ObjectMaker&amp;) = <span class="keyword">delete</span>;</div>
<div class="line">  ObjectMaker(<span class="keyword">const</span> ObjectMaker&amp;&amp;) = <span class="keyword">delete</span>;</div>
<div class="line">  ObjectMaker&amp; operator=(<span class="keyword">const</span> ObjectMaker&amp;) = <span class="keyword">delete</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">//===============================================</span></div>
<div class="line"><span class="comment">// This is where we statically register an object</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> abc12345 = ObjectMaker::RegisterObject&lt;Object&gt;(<span class="stringliteral">&quot;Parent&quot;</span>);</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> abc12346 = ObjectMaker::RegisterObject&lt;ChildObject&gt;(<span class="stringliteral">&quot;Child&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="../../d4/dca/chi__tech__main_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>()</div>
<div class="line">{</div>
<div class="line">  Object objectA(98); <span class="comment">// Conventional object creation</span></div>
<div class="line">  <span class="keyword">auto</span> objectB = ObjectMaker::MakeRegisteredObject(<span class="stringliteral">&quot;Parent&quot;</span>);</div>
<div class="line">  <span class="keyword">auto</span> objectC = ObjectMaker::MakeRegisteredObject(<span class="stringliteral">&quot;Child&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Object A.member_ = &quot;</span> &lt;&lt; objectA.member_ &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Object B.member_ = &quot;</span> &lt;&lt; objectB-&gt;member_ &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Object C.member_ = &quot;</span> &lt;&lt; objectC-&gt;member_ &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p> Output: </p><pre class="fragment">Object A.member_ = 98
Object B.member_ = 99
Object C.member_ = 999
</pre><p >Notice that we abuse the static initialization phase right above the <code>main</code> function. We call the static singleton <code>ObjectMaker</code> and <code>RegisterObject</code> to create registry entries for a <code>Parent</code> and a <code>Child</code>. In the main function we then construct some of these statically registered objects.</p>
<h1><a class="anchor" id="DevManParametersSec2"></a>
2 Implementation in ChiTech: ChiObject and ChiObjectFactory</h1>
<p >In ChiTech we have to, of course, enhance the functionality by a lot, to this end we have the base object, <code><a class="el" href="../../d6/d15/class_chi_object.html">ChiObject</a></code>, and the factory, <code><a class="el" href="../../d4/dbb/class_chi_object_factory.html">ChiObjectFactory</a></code>. Also, instead of using raw pointers, we use shared pointers for all objects that can be statically registered.</p>
<div class="image">
<img src="../../StaticRegistration.png" alt="" width="900px"/>
<div class="caption">
The factory pattern</div></div>
<p >We developed a separate system to control object construction parameters (more on this later). Additionally, we do not want developers to come up with unique dummy variable names for the static registration, i.e., <code>static int abc12345</code> or <code>static int abc12346</code>, just to make use of the <code><a class="el" href="../../d4/dbb/class_chi_object_factory.html">ChiObjectFactory</a></code>, therefore, we use a macro. That works as follows.</p>
<p >In order to register an object within the <code><a class="el" href="../../d4/dbb/class_chi_object_factory.html">ChiObjectFactory</a></code> we created a macro called <code><a class="el" href="../../d3/ddc/_chi_object_factory_8h.html#a3c1dee9629caa5c9c779bc7be5717228">RegisterChiObject(namespace_name, obj_name)</a></code>. The arguments to this macro, <code>namespace_name</code> and <code>obj_name</code>, then get used to construct the following </p><div class="fragment"><div class="line"><a class="code hl_define" href="../../d3/ddc/_chi_object_factory_8h.html#a3c1dee9629caa5c9c779bc7be5717228">RegisterChiObject</a>(namespace_name, ObjectName);</div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// becomes:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span> unique_var_name_object_ObjectName_0 =</div>
<div class="line">  ChiObjectFactory::AddObjectToRegistry&lt;ObjectName, ChiObject&gt;(<span class="stringliteral">&quot;namespace_name&quot;</span>,</div>
<div class="line">                                                             <span class="stringliteral">&quot;ObjectName&quot;</span>)</div>
<div class="ttc" id="a_chi_object_factory_8h_html_a3c1dee9629caa5c9c779bc7be5717228"><div class="ttname"><a href="../../d3/ddc/_chi_object_factory_8h.html#a3c1dee9629caa5c9c779bc7be5717228">RegisterChiObject</a></div><div class="ttdeci">#define RegisterChiObject(namespace_name, object_name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/ddc/_chi_object_factory_8h_source.html#l00022">ChiObjectFactory.h:22</a></div></div>
</div><!-- fragment --><p> which allows us to abuse static initialization to register the object with text-name <code>"namespace_name::ObjectName"</code>. Note that nested namespaces are allowed, e.g., <code>"space1::space1b::space1bc"</code>, is allowed.</p>
<p >We also implemented a number of "tricks". For example we created a behind-the-scenes connection to the lua console so that registered objects can be created from the lua input system. We also created a "RegistryDump" where each registered object can dump its input arguments specification so we can use it to build documentation (lessening the burden on the developer).</p>
<h1><a class="anchor" id="DevManParametersSec3"></a>
3 The InputParameters system</h1>
<p >All statically registered objects have a common input parameters interface implemented in the general class <code><a class="el" href="../../d8/d4d/classchi_1_1_input_parameters.html">chi::InputParameters</a></code>. This allows us to fully support static registration if an object has the following basic structure </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;ChiObject/chi_object.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span>zorba</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>CoolObject : <span class="keyword">public</span> <a class="code hl_class" href="../../d6/d15/class_chi_object.html">ChiObject</a></div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> a_;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> b_;</div>
<div class="line">  <span class="comment">//Misc. members</span></div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">static</span> <a class="code hl_class" href="../../d8/d4d/classchi_1_1_input_parameters.html">chi::InputParameters</a> GetInputParameters();</div>
<div class="line">  CoolObject(<span class="keyword">const</span> <a class="code hl_class" href="../../d8/d4d/classchi_1_1_input_parameters.html">chi::InputParameters</a>&amp; params);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Misc. methods</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="ttc" id="aclass_chi_object_html"><div class="ttname"><a href="../../d6/d15/class_chi_object.html">ChiObject</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/db1/_chi_object_8h_source.html#l00007">ChiObject.h:8</a></div></div>
<div class="ttc" id="aclasschi_1_1_input_parameters_html"><div class="ttname"><a href="../../d8/d4d/classchi_1_1_input_parameters.html">chi::InputParameters</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d24/input__parameters_8h_source.html#l00022">input_parameters.h:23</a></div></div>
</div><!-- fragment --><p> Here we have the static member method <code>GetInputParameters</code> which returns a <code><a class="el" href="../../d8/d4d/classchi_1_1_input_parameters.html">chi::InputParameters</a></code> object used to assign parameters from user input, and the constructor <code>CoolObject(const chi::InputParameters&amp; params);</code> which uses such an object.</p>
<p >In the definition (<code>.cc</code>) file we then have </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;CoolObject.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;ChiObject/object_maker.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span>zorba</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><a class="code hl_define" href="../../d3/ddc/_chi_object_factory_8h.html#a3c1dee9629caa5c9c779bc7be5717228">RegisterChiObject</a>(chi_unit_tests, CoolObject);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="../../d8/d4d/classchi_1_1_input_parameters.html">chi::InputParameters</a> CoolObject::GetInputParameters()</div>
<div class="line">{</div>
<div class="line">  <a class="code hl_class" href="../../d8/d4d/classchi_1_1_input_parameters.html">chi::InputParameters</a> params = <a class="code hl_function" href="../../d6/d15/class_chi_object.html#af6067bbe5248244605ed4802a2bfd1df">ChiObject::GetInputParameters</a>();</div>
<div class="line"> </div>
<div class="line">  params.<a class="code hl_function" href="../../d8/d4d/classchi_1_1_input_parameters.html#ac88f01c03520aaf64ae6ead8ea3697ae">SetGeneralDescription</a>(<span class="stringliteral">&quot;A Cool object to play with&quot;</span>);</div>
<div class="line">  params.<a class="code hl_function" href="../../d8/d4d/classchi_1_1_input_parameters.html#a0a281e4d55bf9365efa9f4aa5c85a634">SetDocGroup</a>(<span class="stringliteral">&quot;doc_Coolstuff&quot;</span>); <span class="comment">// Documentation link</span></div>
<div class="line"> </div>
<div class="line">  params.<a class="code hl_function" href="../../d8/d4d/classchi_1_1_input_parameters.html#a13f45e3b2ccc81583c2541e5713d15fd">AddRequiredParameter</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;Coolness factor a&quot;</span>);</div>
<div class="line">  params.<a class="code hl_function" href="../../d8/d4d/classchi_1_1_input_parameters.html#abc29e83c5cb6a5225144eceb13c5aae7">AddOptionalParameter</a>(<span class="stringliteral">&quot;b&quot;</span>, 1.0, <span class="stringliteral">&quot;Coolness factor b&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> params;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">CoolObject::CoolObject(<span class="keyword">const</span> <a class="code hl_class" href="../../d8/d4d/classchi_1_1_input_parameters.html">chi::InputParameters</a>&amp; params) :</div>
<div class="line">  <a class="code hl_class" href="../../d6/d15/class_chi_object.html">ChiObject</a>(params),</div>
<div class="line">  a_(params.GetParamValue&lt;int&gt;(<span class="stringliteral">&quot;a&quot;</span>)),</div>
<div class="line">  b_(params.GetParamValue&lt;double&gt;(<span class="stringliteral">&quot;b&quot;</span>))</div>
<div class="line">{</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">}<span class="comment">//namespace zorba</span></div>
<div class="ttc" id="aclass_chi_object_html_af6067bbe5248244605ed4802a2bfd1df"><div class="ttname"><a href="../../d6/d15/class_chi_object.html#af6067bbe5248244605ed4802a2bfd1df">ChiObject::GetInputParameters</a></div><div class="ttdeci">static chi::InputParameters GetInputParameters()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_chi_object_8cc_source.html#l00004">ChiObject.cc:4</a></div></div>
<div class="ttc" id="aclasschi_1_1_input_parameters_html_a0a281e4d55bf9365efa9f4aa5c85a634"><div class="ttname"><a href="../../d8/d4d/classchi_1_1_input_parameters.html#a0a281e4d55bf9365efa9f4aa5c85a634">chi::InputParameters::SetDocGroup</a></div><div class="ttdeci">void SetDocGroup(const std::string &amp;doc_group)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d24/input__parameters_8h_source.html#l00080">input_parameters.h:80</a></div></div>
<div class="ttc" id="aclasschi_1_1_input_parameters_html_a13f45e3b2ccc81583c2541e5713d15fd"><div class="ttname"><a href="../../d8/d4d/classchi_1_1_input_parameters.html#a13f45e3b2ccc81583c2541e5713d15fd">chi::InputParameters::AddRequiredParameter</a></div><div class="ttdeci">void AddRequiredParameter(const std::string &amp;name, const std::string &amp;doc_string)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d24/input__parameters_8h_source.html#l00125">input_parameters.h:125</a></div></div>
<div class="ttc" id="aclasschi_1_1_input_parameters_html_abc29e83c5cb6a5225144eceb13c5aae7"><div class="ttname"><a href="../../d8/d4d/classchi_1_1_input_parameters.html#abc29e83c5cb6a5225144eceb13c5aae7">chi::InputParameters::AddOptionalParameter</a></div><div class="ttdeci">void AddOptionalParameter(const std::string &amp;name, T value, const std::string &amp;doc_string)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d24/input__parameters_8h_source.html#l00097">input_parameters.h:97</a></div></div>
<div class="ttc" id="aclasschi_1_1_input_parameters_html_ac88f01c03520aaf64ae6ead8ea3697ae"><div class="ttname"><a href="../../d8/d4d/classchi_1_1_input_parameters.html#ac88f01c03520aaf64ae6ead8ea3697ae">chi::InputParameters::SetGeneralDescription</a></div><div class="ttdeci">void SetGeneralDescription(const std::string &amp;description)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d24/input__parameters_8h_source.html#l00072">input_parameters.h:72</a></div></div>
</div><!-- fragment --><p >Creating this object from lua is then as easy as </p><div class="fragment"><div class="line">params = {a = 98, b = 99.0}</div>
<div class="line">cool_obj = zorba.CoolObject.Create(params)</div>
</div><!-- fragment --><h2><a class="anchor" id="DevManParametersSecFAQ1"></a>
FAQ1 Documentation-strings (Doc-strings)</h2>
<p >All parameters must have a documentation string (short name "doc string"). For example: </p><div class="fragment"><div class="line">params.<a class="code hl_function" href="../../d8/d4d/classchi_1_1_input_parameters.html#a13f45e3b2ccc81583c2541e5713d15fd">AddRequiredParameter</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;Coolness factor a&quot;</span>);</div>
<div class="line">params.<a class="code hl_function" href="../../d8/d4d/classchi_1_1_input_parameters.html#abc29e83c5cb6a5225144eceb13c5aae7">AddOptionalParameter</a>(<span class="stringliteral">&quot;b&quot;</span>, 1.0, <span class="stringliteral">&quot;Coolness factor b&quot;</span>);</div>
</div><!-- fragment --><p> here "Coolness factor a" and "Coolness factor b" are the doc strings for parameters "a" and "b" respectively.</p>
<p >You can also add documentation for the entire object. When the documentation is auto-generated this description will appear at the top. </p><div class="fragment"><div class="line">params.<a class="code hl_function" href="../../d8/d4d/classchi_1_1_input_parameters.html#ac88f01c03520aaf64ae6ead8ea3697ae">SetGeneralDescription</a>(<span class="stringliteral">&quot;General test object&quot;</span>);</div>
</div><!-- fragment --><p >By default the object's documentation will be posted to a group that is reference-able via doxygen as <code>&lt;namespace_name&gt;__&lt;ObjectName&gt;</code> (note the double underscore is a replacement for the namespace scope clarifiers <code>::</code>). You can link the documentation to other groups by using the <code>SetDocGroup()</code> method. This functionality allows you to customize your documentation according to your needs.</p>
<p ><b>Note:</b> The block of text supplied to <code>SetGeneralDescription</code> is pasted into a documentation page that will be processed by doxygen so all doxygen commands will work here (including formulas, code blocks, and links).</p>
<h2><a class="anchor" id="DevManParametersSecFAQ2"></a>
FAQ2 Optional Parameters</h2>
<p >Optional parameters must always have a default value. However, you do not necessarily have to use it. In cases where you use a parameter only when supplied, the <code>InputParameters</code> object has the interface method <code>ParametersAtAssignment</code> which returns the parameters used at assignment. It is used as follows: </p><div class="fragment"><div class="line">CoolObject::CoolObject(<span class="keyword">const</span> <a class="code hl_class" href="../../d8/d4d/classchi_1_1_input_parameters.html">chi::InputParameters</a>&amp; params) :</div>
<div class="line">  <a class="code hl_class" href="../../d6/d15/class_chi_object.html">ChiObject</a>(params),</div>
<div class="line">  a_(params.GetParamValue&lt;int&gt;(<span class="stringliteral">&quot;a&quot;</span>)),</div>
<div class="line">  b_(0.0)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; user_params = params.<a class="code hl_function" href="../../d8/d4d/classchi_1_1_input_parameters.html#a59ede5a23abadce360bbba48b114b8f6">ParametersAtAssignment</a>();</div>
<div class="line">  <span class="keywordflow">if</span> (user_params.Has(<span class="stringliteral">&quot;b&quot;</span>))</div>
<div class="line">    b_ = user_params.<a class="code hl_function" href="../../d5/d1c/classchi_1_1_parameter_block.html#abf4892b036de1f189dca9731e663554a">GetParamValue</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;b&quot;</span>);</div>
<div class="line">}</div>
<div class="ttc" id="aclasschi_1_1_input_parameters_html_a59ede5a23abadce360bbba48b114b8f6"><div class="ttname"><a href="../../d8/d4d/classchi_1_1_input_parameters.html#a59ede5a23abadce360bbba48b114b8f6">chi::InputParameters::ParametersAtAssignment</a></div><div class="ttdeci">const ParameterBlock &amp; ParametersAtAssignment() const</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d24/input__parameters_8h_source.html#l00167">input_parameters.h:167</a></div></div>
<div class="ttc" id="aclasschi_1_1_parameter_block_html_abf4892b036de1f189dca9731e663554a"><div class="ttname"><a href="../../d5/d1c/classchi_1_1_parameter_block.html#abf4892b036de1f189dca9731e663554a">chi::ParameterBlock::GetParamValue</a></div><div class="ttdeci">T GetParamValue(const std::string &amp;param_name) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd2/parameter__block_8h_source.html#l00214">parameter_block.h:214</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="DevManParametersSecFAQ3"></a>
FAQ3 Inheriting parameters from parent objects</h2>
<p >Input parameters can be inherited from parents in the <code>GetInputParameters</code> method call. For example </p><div class="fragment"><div class="line"><a class="code hl_class" href="../../d8/d4d/classchi_1_1_input_parameters.html">chi::InputParameters</a> LBSSolver::GetInputParameters()</div>
<div class="line">{</div>
<div class="line">  <a class="code hl_class" href="../../d8/d4d/classchi_1_1_input_parameters.html">chi::InputParameters</a> params =</div>
<div class="line">    <a class="code hl_function" href="../../d9/d3a/classchi__physics_1_1_solver.html#a34765d2a62260c90bdb2b111d3ee9683">chi_physics::Solver::GetInputParameters</a>();</div>
<div class="line">  params += chi::SecondParent::GetInputParameters();</div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">//etc.</span></div>
<div class="ttc" id="aclasschi__physics_1_1_solver_html_a34765d2a62260c90bdb2b111d3ee9683"><div class="ttname"><a href="../../d9/d3a/classchi__physics_1_1_solver.html#a34765d2a62260c90bdb2b111d3ee9683">chi_physics::Solver::GetInputParameters</a></div><div class="ttdeci">static chi::InputParameters GetInputParameters()</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/de6/chi__solver_8cc_source.html#l00014">chi_solver.cc:14</a></div></div>
</div><!-- fragment --><p> Gets all the parameters from the parent object <code><a class="el" href="../../d9/d3a/classchi__physics_1_1_solver.html">chi_physics::Solver</a></code> and then <code>chi::SecondParent</code>, allowing us to change or add to these parameters.</p>
<p >In fact, a pretty slick move here is that we are not bound by classical inheritance. The input parameters of any statically registered object can be snatched and used by simply calling its static <code>GetInputParameters</code> method.</p>
<h2><a class="anchor" id="DevManParametersSecFAQ4"></a>
FAQ4 Changing inherited options to optional/required</h2>
<p >If a required parameter is to be changed to optional we can do this using the interface <code>ChangeExistingParamToOptional</code>, e.g., </p><div class="fragment"><div class="line"><a class="code hl_class" href="../../d8/d4d/classchi_1_1_input_parameters.html">chi::InputParameters</a> LBSSolver::GetInputParameters()</div>
<div class="line">{</div>
<div class="line">  <a class="code hl_class" href="../../d8/d4d/classchi_1_1_input_parameters.html">chi::InputParameters</a> params =</div>
<div class="line">    <a class="code hl_function" href="../../d9/d3a/classchi__physics_1_1_solver.html#a34765d2a62260c90bdb2b111d3ee9683">chi_physics::Solver::GetInputParameters</a>();</div>
<div class="line"> </div>
<div class="line">  params.<a class="code hl_function" href="../../d8/d4d/classchi_1_1_input_parameters.html#afd7f71e09009500f8b8a3f4ae001b1e0">ChangeExistingParamToOptional</a>(<span class="stringliteral">&quot;name&quot;</span>, <span class="stringliteral">&quot;LBSDatablock&quot;</span>);</div>
<div class="ttc" id="aclasschi_1_1_input_parameters_html_afd7f71e09009500f8b8a3f4ae001b1e0"><div class="ttname"><a href="../../d8/d4d/classchi_1_1_input_parameters.html#afd7f71e09009500f8b8a3f4ae001b1e0">chi::InputParameters::ChangeExistingParamToOptional</a></div><div class="ttdeci">void ChangeExistingParamToOptional(const std::string &amp;name, T value, const std::string &amp;doc_string=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d24/input__parameters_8h_source.html#l00140">input_parameters.h:140</a></div></div>
</div><!-- fragment --><p >Vice versa there is also <code>ChangeExistingParamToRequired&lt;type&gt;("name")</code>.</p>
<h2><a class="anchor" id="DevManParametersSecFAQ5"></a>
FAQ5 Deprecated parameters</h2>
<p >Parameters in an <code>InputParameters</code> block can be marked as deprecated via 3 different mechanisms:</p><ul>
<li>Marking them with a deprecation warning <code>MarkParamaterDeprecatedWarning</code>. This will generate just a warning if the parameter is supplied..</li>
<li>Marking them with a deprecation error <code>MarkParamaterDeprecatedError</code>. This will generate an error if the parameter is supplied..</li>
<li>Marking them with as renamed <code>MarkParamaterRenamed</code>. This will generate an error if the parameter is supplied if the parameter is supplied.</li>
</ul>
<h2><a class="anchor" id="DevManParametersSecFAQ6"></a>
FAQ6 Constrained ranges</h2>
<p >Parameters in an input parameters block can be constrained to the following</p><ul>
<li><code><a class="el" href="../../df/d0b/classchi__data__types_1_1_allowable_range_list.html">chi_data_types::AllowableRangeList</a></code>, created with a <code>std::vector</code> of a specific type. The parameter can then only be one of those types.</li>
<li><code><a class="el" href="../../d4/d3c/classchi__data__types_1_1_allowable_range_low_limit.html">chi_data_types::AllowableRangeLowLimit</a></code>. Parameter must be &gt;= than the value specified when the range is specified as closed or just &gt; that the value specified when the range is specified as open.</li>
<li><code><a class="el" href="../../d4/d8e/classchi__data__types_1_1_allowable_range_high_limit.html">chi_data_types::AllowableRangeHighLimit</a></code> same as the low limit but just with a smaller than comparison.</li>
<li><code><a class="el" href="../../dd/d6e/classchi__data__types_1_1_allowable_range_low_high_limit.html">chi_data_types::AllowableRangeLowHighLimit</a></code> combination of both a high and a low limit range.</li>
</ul>
<p >Example: </p><div class="fragment"><div class="line"><a class="code hl_class" href="../../d8/d4d/classchi_1_1_input_parameters.html">chi::InputParameters</a> StrangeSolver::GetInputParameters()</div>
<div class="line">{</div>
<div class="line">  <a class="code hl_class" href="../../d8/d4d/classchi_1_1_input_parameters.html">chi::InputParameters</a> params =</div>
<div class="line">    <a class="code hl_function" href="../../d9/d3a/classchi__physics_1_1_solver.html#a34765d2a62260c90bdb2b111d3ee9683">chi_physics::Solver::GetInputParameters</a>();</div>
<div class="line">  params.<a class="code hl_function" href="../../d8/d4d/classchi_1_1_input_parameters.html#a13f45e3b2ccc81583c2541e5713d15fd">AddRequiredParameter</a>&lt;std::string&gt;(</div>
<div class="line">  <span class="stringliteral">&quot;sdm_type&quot;</span>, <span class="stringliteral">&quot;The spatial discretization type to be used&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using namespace </span><a class="code hl_namespace" href="../../d5/d1b/namespacechi__data__types.html">chi_data_types</a>;</div>
<div class="line">  params.<a class="code hl_function" href="../../d8/d4d/classchi_1_1_input_parameters.html#a7ac5b1b9b56e596e25d11f37e10eb95f">ConstrainParameterRange</a>(</div>
<div class="line">    <span class="stringliteral">&quot;sdm_type&quot;</span>, AllowableRangeList::New({<span class="stringliteral">&quot;FV&quot;</span>, <span class="stringliteral">&quot;PWLC&quot;</span>, <span class="stringliteral">&quot;PWLD&quot;</span>}));</div>
<div class="line">  <span class="comment">// etc.</span></div>
<div class="ttc" id="aclasschi_1_1_input_parameters_html_a7ac5b1b9b56e596e25d11f37e10eb95f"><div class="ttname"><a href="../../d8/d4d/classchi_1_1_input_parameters.html#a7ac5b1b9b56e596e25d11f37e10eb95f">chi::InputParameters::ConstrainParameterRange</a></div><div class="ttdeci">void ConstrainParameterRange(const std::string &amp;param_name, AllowableRangePtr allowable_range)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d88/input__parameters_8cc_source.html#l00407">input_parameters.cc:407</a></div></div>
<div class="ttc" id="anamespacechi__data__types_html"><div class="ttname"><a href="../../d5/d1b/namespacechi__data__types.html">chi_data_types</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd9/allowable__range_8h_source.html#l00010">allowable_range.h:11</a></div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../index.html">Chi-Tech</a></li><li class="navelem"><a class="el" href="../../d7/db6/_programmer_manual.html">Developer&#39;s manual</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
